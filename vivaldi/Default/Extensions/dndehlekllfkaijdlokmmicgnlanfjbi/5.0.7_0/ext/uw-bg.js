!function(e){var t={};function s(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(i,o,function(t){return e[t]}.bind(null,o));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=101)}({10:function(e,t,s){"use strict";var i=s(7);t.a=class{static async sendMessage(e){i.browser.runtime.sendMessage(e)}}},101:function(e,t,s){"use strict";s.r(t);var i=s(8),o=s(7),r=s(2);var a=class{constructor(e){this.ports=[],this.commands={"announce-zoom":[e=>{try{this.popupPort.postMessage({cmd:"set-current-zoom",zoom:e.zoom})}catch(e){}}],"get-current-zoom":[e=>this.sendToActive(e)],"get-current-site":[async(e,t)=>{t.postMessage({cmd:"set-current-site",site:await this.server.getVideoTab(),tabHostname:await this.getCurrentTabHostname()})}],"popup-set-selected-tab":[e=>this.server.setSelectedTab(e.selectedMenu,e.selectedSubitem)],"has-video":[(e,t)=>this.server.registerVideo(t.sender)],noVideo:[(e,t)=>this.server.unregisterVideo(t.sender)],"inject-css":[(e,t)=>this.server.injectCss(e.cssString,t)],"eject-css":[(e,t)=>this.server.removeCss(e.cssString,t)],"replace-css":[(e,t)=>this.server.replaceCss(e.oldCssString,e.newCssString,t)],"get-config":[(e,t)=>{var s={extensionConf:JSON.stringify(this.settings.active)};this.logger.log("info","comms","%c[CommsServer.js::processMessage_nonpersistent] Returning this:","background-color: #11D; color: #aad",s),Promise.resolve(s)}],"autoar-enable":[()=>{this.settings.active.sites["@global"].autoar=r.a.Enabled,this.settings.save(),this.logger.log("info","comms","[uw-bg] autoar set to enabled (blacklist). evidenz:",this.settings.active)}],"autoar-disable":[e=>{this.settings.active.sites["@global"].autoar=r.a.Disabled,e.reason?this.settings.active.arDetect.disabledReason=e.reason:this.settings.active.arDetect.disabledReason="User disabled",this.settings.save(),this.logger.log("info","comms","[uw-bg] autoar set to disabled. evidenz:",this.settings.active)}],"autoar-set-interval":[e=>{this.logger.log("info","comms",`[uw-bg] trying to set new interval for autoAr. New interval is, ${e.timeout} ms`);var t=e.timeout<4?4:e.timeout;this.settings.active.arDetect.timers.playing=t,this.settings.save()}],"logging-stop-and-save":[(e,t)=>{var s,i,o;this.logger.log("info","comms","Received command to stop logging and export the received input"),this.logger.addToGlobalHistory(`${e.host}::${null!==(i=null===(s=null==t?void 0:t.tab)||void 0===s?void 0:s.id)&&void 0!==i?i:"×"}-${null!==(o=t.frameId)&&void 0!==o?o:"×"}`,JSON.parse(e.history)),this.logger.finish()}],"logging-save":[(e,t)=>{var s,i,o;this.logger.log("info","comms",`Received command to save log for site ${e.host} (tabId ${t.tab.id}, frameId ${t.frameId}`),this.logger.addToGlobalHistory(`${null==e?void 0:e.host}::${null!==(i=null===(s=null==t?void 0:t.tab)||void 0===s?void 0:s.id)&&void 0!==i?i:"×"}-${null!==(o=null==t?void 0:t.frameId)&&void 0!==o?o:"×"}`,JSON.parse(e.history))}]},this.server=e,this.logger=e.logger,this.settings=e.settings,o.browser.runtime.onConnect.addListener(e=>this.onConnect(e)),o.browser.runtime.onMessage.addListener((e,t)=>this.processReceivedMessage_nonpersistent(e,t))}get activeTab(){return o.browser.tabs.query({currentWindow:!0,active:!0})}subscribe(e,t){this.commands[e]?this.commands[e].push(t):this.commands[e]=[t]}async getCurrentTabHostname(){const e=await this.activeTab;(!e||e.length<1)&&this.logger.log("warn","comms","There is no active tab for some reason. activeTab:",e);const t=e[0].url;return(t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0]}sendToAll(e){for(const t of this.ports)for(const s in t)for(const i in t[s])t[s][i].postMessage(e)}async sendToFrameContentScripts(e,t,s,i){if(void 0===i)for(const i in this.ports[t][s])this.ports[t][s][i].postMessage(e);else this.ports[t][s][i].postMessage(e)}async sendToFrame(e,t,s,i){if(this.logger.log("info","comms",`%c[CommsServer::sendToFrame] attempting to send message to tab ${t}, frame ${s}`,"background: #dda; color: #11D",e),isNaN(t)){if("__playing"===s)return e.playing=!0,void this.sendToAll(e);if("__all"===s)return void this.sendToAll(e);[t,s]=s.split("-")}this.logger.log("info","comms",`%c[CommsServer::sendToFrame] attempting to send message to tab ${t}, frame ${s}`,"background: #dda; color: #11D",e);try{this.sendToFrameContentScripts(e,t,s,i)}catch(e){this.logger.log("error","comms","%c[CommsServer::sendToFrame] Sending message failed. Reason:","background: #dda; color: #11D",e)}}async sendToAllFrames(e,t,s){for(const i in this.ports[t])this.sendToFrameContentScripts(e,t,i,s)}async sendToActive(e){this.logger.log("info","comms","%c[CommsServer::sendToActive] trying to send a message to active tab. Message:","background: #dda; color: #11D",e);const t=await this.activeTab;this.logger.log("info","comms","[CommsServer::_sendToActive] currently active tab(s)?",t);for(const e in this.ports[t[0].id])this.logger.log("info","comms","key?",e,this.ports[t[0].id]);for(const s in this.ports[t[0].id])this.sendToFrameContentScripts(e,t[0].id,s)}onConnect(e){if("popup-port"===e.name)return this.popupPort=e,void this.popupPort.onMessage.addListener((e,t)=>this.processReceivedMessage(e,t));var t=e.sender.tab.id,s=e.sender.frameId;this.ports[t]||(this.ports[t]={}),this.ports[t][s]||(this.ports[t][s]={}),this.ports[t][s][e.name]=e,this.ports[t][s][e.name].onMessage.addListener((e,t)=>this.processReceivedMessage(e,t)),this.ports[t][s][e.name].onDisconnect.addListener(i=>{try{delete this.ports[i.sender.tab.id][i.sender.frameId][e.name]}catch(e){}Object.keys(0===this.ports[t][s].length)&&(delete this.ports[t][s],0===Object.keys(this.ports[i.sender.tab.id]).length&&delete this.ports[t])})}async execCmd(e,t,s){var i,o;if(this.logger.log("info","comms","[CommsServer.js::execCmd] Received message",e,". Port/sender:",t,"sendResponse:",s,"\nThere is ",null!==(o=null===(i=this.commands[e.cmd])||void 0===i?void 0:i.length)&&void 0!==o?o:0," command(s) for action",e.cmd),this.commands[e.cmd])for(const s of this.commands[e.cmd])try{await s(e,t)}catch(e){this.logger.log("error","debug","[CommsServer.js::execCmd] failed to execute command.",e)}}async handleMessage(e,t){await this.execCmd(e,t),e.forwardToSameFramePort&&this.sendToFrameContentScripts(e,t.tab.id,t.frameId,e.port),e.forwardToContentScript&&(this.logger.log("info","comms","[CommsServer.js::processReceivedMessage] Message has 'forward to content script' flag set. Forwarding message as is. Message:",e),this.sendToFrame(e,e.targetTab,e.targetFrame)),e.forwardToAll&&(this.logger.log("info","comms","[CommsServer.js::processReceivedMessage] Message has 'forward to all' flag set. Forwarding message as is. Message:",e),this.sendToAll(e)),e.forwardToActive&&(this.logger.log("info","comms","[CommsServer.js::processReceivedMessage] Message has 'forward to active' flag set. Forwarding message as is. Message:",e),this.sendToActive(e))}async processReceivedMessage(e,t){this.logger.log("info","comms","[CommsServer.js::processReceivedMessage] Received message from popup/content script!",e,"port",t),this.handleMessage(e,t)}processReceivedMessage_nonpersistent(e,t){this.logger.log("info","comms","%c[CommsServer.js::processMessage_nonpersistent] Received message from background script!","background-color: #11D; color: #aad",e,t),this.handleMessage(e,t)}sendUnmarkPlayer(e){this.logger.log("info","comms","[CommsServer.js::sendUnmarkPlayer] Chrome is a shit browser that doesn't do port.postMessage() in unload events, so we have to resort to inelegant hacks. If you see this, then the workaround method works."),this.processReceivedMessage(e,this.popupPort)}},n=s(15),l=s(12),c=s(29);var g=new class{constructor(){this.ports=[],this.currentSite="",this.videoTabs={},this.currentTabId=0,this.selectedSubitem={siteSettings:void 0,videoSettings:void 0},this.uiLoggerInitialized=!1,this.setup()}async setup(){try{const e={isBackgroundScript:!0,allowLogging:!1,useConfFromStorage:!0,logAll:!0,fileOptions:{enabled:!1},consoleOptions:{enabled:!1}};this.logger=new l.b,await this.logger.init(e),this.settings=new n.a({logger:this.logger}),await this.settings.init(),this.comms=new a(this),this.comms.subscribe("show-logger",async()=>await this.initUiAndShowLogger()),this.comms.subscribe("init-vue",async()=>await this.initUi()),this.comms.subscribe("uwui-vue-initialized",()=>this.uiLoggerInitialized=!0),this.comms.subscribe("emit-logs",()=>{}),o.browser.tabs.onActivated.addListener(e=>{this.onTabSwitched(e)})}catch(e){console.error("Ultrawidify [server]: failed to start. Reason:",e)}}async _promisifyTabsGet(e,t){return new Promise((s,i)=>{e.tabs.get(t,e=>s(e))})}async injectCss(e,t){try{i.a.firefox||i.a.edge?o.browser.tabs.insertCSS(t.tab.id,{code:e,cssOrigin:"user",frameId:t.frameId}):i.a.anyChromium&&chrome.tabs.insertCSS(t.tab.id,{code:e,cssOrigin:"user",frameId:t.frameId})}catch(s){this.logger.log("error","debug","[UwServer::injectCss] Error while injecting css:",{error:s,css:e,sender:t})}}async removeCss(e,t){try{o.browser.tabs.removeCSS(t.tab.id,{code:e,cssOrigin:"user",frameId:t.frameId})}catch(s){this.logger.log("error","debug","[UwServer::injectCss] Error while removing css:",{error:s,css:e,sender:t})}}async replaceCss(e,t,s){e!==t&&(this.injectCss(t,s),this.removeCss(e,s))}extractHostname(e){return e?(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]:"<no url>"}async onTabSwitched(e){this.hasVideos=!1;try{let t;this.currentTabId=e.tabId,i.a.firefox?t=await o.browser.tabs.get(this.currentTabId):i.a.anyChromium&&(t=await this._promisifyTabsGet(chrome,this.currentTabId)),this.currentSite=this.extractHostname(t.url),this.logger.log("info","debug","[UwServer::onTabSwitched] user switched tab. New site:",this.currentSite)}catch(e){this.logger.log("error","debug","[UwServer::onTabSwitched] there was a problem getting currnet site:",e)}this.selectedSubitem={siteSettings:void 0,videoSettings:void 0}}registerVideo(e){var t,s,i;this.logger.log("info","comms","[UWServer::registerVideo] Registering video.\nsender:",e);const o=this.extractHostname(e.tab.url),r=this.extractHostname(e.url);(null===(t=this.videoTabs[e.tab.id])||void 0===t?void 0:t.host)!=o?delete this.videoTabs[e.tab.id]:(null===(i=null===(s=this.videoTabs[e.tab.id])||void 0===s?void 0:s.frames[e.frameId])||void 0===i?void 0:i.host)!=r&&delete this.videoTabs[e.tab.id].frames[e.frameId],this.videoTabs[e.tab.id]||(this.videoTabs[e.tab.id]={id:e.tab.id,host:o,url:e.tab.url,frames:{}}),this.videoTabs[e.tab.id].frames[e.frameId]={id:e.frameId,host:r,url:e.url,registerTime:Date.now()},this.logger.log("info","comms","[UWServer::registerVideo] Video registered. current videoTabs:",this.videoTabs)}unregisterVideo(e){this.logger.log("info","comms","[UwServer::unregisterVideo] Unregistering video.\nsender:",e),this.videoTabs[e.tab.id]&&(Object.keys(this.videoTabs[e.tab.id].frames).length<=1?delete this.videoTabs[e.tab.id]:this.videoTabs[e.tab.id].frames[e.frameId]&&delete this.videoTabs[e.tab.id].frames[e.frameId]),this.logger.log("info","comms","[UwServer::unregisterVideo] Video has been unregistered. Current videoTabs:",this.videoTabs)}setSelectedTab(e,t){this.logger.log("info","comms","[UwServer::setSelectedTab] saving selected tab for",e,":",t),this.selectedSubitem[e]=t}async initUi(){try{i.a.firefox?await o.browser.tabs.executeScript({file:"/ext/uw-ui.js",allFrames:!0}):i.a.anyChromium&&await new Promise(e=>chrome.tabs.executeScript({file:"/ext/uw-ui.js",allFrames:!0},()=>e()))}catch(e){console.warn("Ultrawidify [server]: UI setup failed. While problematic, this problem shouldn't completely crash the extension."),this.logger.log("ERROR","uwbg","UI initialization failed. Reason:",e)}}async initUiAndShowLogger(){try{this.uiLoggerInitialized=!1,await this.initUi(),await new Promise(async(e,t)=>{let s=!1;for(setTimeout(async()=>{s=!0,t()},5e3);!s;){if(this.uiLoggerInitialized)return void e();await Object(c.a)(100)}})}catch(e){console.warn("Ultrawidify [server]: failed to set up logger UI. While problematic, this problem shouldn't completely crash the extension.")}}async getCurrentTab(){return(await o.browser.tabs.query({active:!0,currentWindow:!0}))[0]}async getVideoTab(){const e=await this.getCurrentTab();if(!e||!e.id)return{host:"INVALID SITE",frames:[]};if(this.videoTabs[e.id]){const t=Date.now()-this.settings.active.pageInfo.timeouts.rescan-4e3;try{for(const s in this.videoTabs[e.id].frames)this.videoTabs[e.id].frames[s].registerTime<t&&delete this.videoTabs[e.id].frames[s]}catch(t){return{host:this.extractHostname(e.url),frames:[],selected:this.selectedSubitem}}return{...this.videoTabs[e.id],host:this.extractHostname(e.url),selected:this.selectedSubitem}}return{host:this.extractHostname(e.url),frames:[],selected:this.selectedSubitem}}sendUnmarkPlayer(e){this.comms.sendUnmarkPlayer(e)}};window.sendUnmarkPlayer=e=>{g.sendUnmarkPlayer(e)}},11:function(module,exports){var isArray=function(e){return Array.isArray(e)},isObject=function(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)},validate=function(e){if(void 0===e)throw new Error("This method requires one parameter");if(!isArray(e)&&!isObject(e))throw new TypeError("This method only accepts arrays and objects")},isRef=function(e){return isObject(e)&&e.hasOwnProperty("$ref")&&1===Object.keys(e).length&&!!e.$ref&&"$"===e.$ref.charAt(0)},encycle=function(arg){validate(arg);var recurs=function(value){return isArray(value)||isObject(value)?isArray(value)?value.map((function(elem,i){return isRef(elem)?(value[i]=eval("arg"+elem.$ref.slice(1)),value):recurs(elem)})):Object.keys(value).reduce((function(accum,key){return accum[key]=isRef(value[key])?eval("arg"+value[key].$ref.slice(1)):recurs(value[key]),accum}),value):value};return recurs(arg)},findRef=function(e,t){return Object.keys(t).find((function(s){return t[s]===e}))},decycle=function(e){validate(e);var t={},s=function(e,i){void 0===i&&(i="$");var o=findRef(e,t);return o?{$ref:o}:isArray(e)||isObject(e)?(t[i]=e,isArray(e)?e.map((function(e,t){return s(e,i+"["+t+"]")})):Object.keys(e).reduce((function(t,o){return t[o]=s(e[o],i+"."+o),t}),{})):e};return s(e)};exports.encycle=encycle,exports.decycle=decycle},12:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s(11),o=s(10),r=s(7);const a={isContentScript:!0,allowLogging:!1,useConfFromStorage:!0,fileOptions:{enabled:!1},consoleOptions:{enabled:!1,debug:!0,init:!0,settings:!0,keyboard:!0,mousemove:!1,actionHandler:!0,comms:!0,playerDetect:!0,resizer:!0,scaler:!0,stretcher:!0,arDetect:!0,arDetect_verbose:!0},allowBlacklistedOrigins:{periodicPlayerCheck:!1,periodicVideoStyleChangeCheck:!1,handleMouseMove:!1}};class n{constructor(e){this.temp_disable=!1,this.onLogEndCallbacks=[],this.history=[],this.globalHistory={},this.isContentScript=!1,this.isBackgroundScript=!0,this.vuexStore=null==e?void 0:e.vuexStore,this.uwInstance=null==e?void 0:e.uwInstance}static saveConfig(e){r.browser.storage.local.set({uwLogger:JSON.stringify(e)})}static syncConfig(e){r.browser.storage.onChanged.addListener((t,s)=>{if(t.uwLogger){const s=JSON.parse(t.uwLogger.newValue);0,e(s)}})}static async getConfig(){let e;e=await r.browser.storage.local.get("uwLogger");try{return JSON.parse(e.uwLogger)}catch(e){return{consoleOptions:{},fileOptions:{}}}}async init(e){e.isContentScript?(this.isContentScript=!0,this.isBackgroundScript=!1):e.isBackgroundScript&&(this.isContentScript=!1,this.isBackgroundScript=!0),this.conf=await n.getConfig(),void 0===this.conf.consoleOptions&&(this.conf.consoleOptions={}),void 0===this.conf.fileOptions&&(this.conf.fileOptions={}),this.startTime=performance.now(),this.temp_disable=!1,this.stopTime=this.conf.timeout?performance.now()+1e3*this.conf.timeout:void 0,r.browser.storage.onChanged.addListener((e,t)=>{var s;if(e.uwLogger&&(null===(s=e.uwLogger)||void 0===s?void 0:s.newValue)){const t=JSON.parse(e.uwLogger.newValue);this.isContentScript&&this.conf.allowLogging&&!t.allowLogging&&this.saveToVuex(),this.conf=t}})}setVuexStore(e){this.vuexStore=e}clear(){this.history=[],this.startTime=performance.now(),this.stopTime=this.conf.timeout?performance.now()+1e3*this.conf.timeout:void 0}setConf(e){this.conf=e,n.saveConfig(e)}getStartTime(){return this.startTime}setStartTime(e){this.startTime=e||performance.now()}getFileLogJSONString(){return{site:window&&window.location,log:JSON.stringify(this.history)}}pause(){this.temp_disable=!0}resume(){this.temp_disable=!1}onLogEnd(e){this.onLogEndCallbacks.push(e)}addToGlobalHistory(e,t){this.globalHistory[e]=t,this.log("info","debug","Added log for",e,"to global history. Current history:",this.globalHistory)}finish(){this.isBackgroundScript||(this.conf.allowLogging=!1),this.saveViaBgScript()}parseStack(){const e=(new Error).stack,t={};t.stack={trace:e.split("\n").map(e=>e.split("@")[0])},t.periodicPlayerCheck=!1,t.periodicVideoStyleChangeCheck=!1,t.aard=!1,t.keyboard=!1,t.popup=!1,t.mousemove=!1,t.exitLogs=!1;for(const e of t.stack.trace)"doPeriodicPlayerElementChangeCheck"===e?t.periodicPlayerCheck=!0:"doPeriodicFallbackChangeDetectionCheck"===e?t.periodicVideoStyleChangeCheck=!0:"frameCheck"===e?t.aard=!0:"execAction"===e?t.keyboard=!0:"processReceivedMessage"===e?t.popup=!0:"handleMouseMove"===e&&(t.mousemove=!0);for(let e=0;e<t.stack.trace.length;e++){if("finish"===t.stack.trace[e]){t.exitLogs=!0;break}if(-1!==t.stack.trace[e].indexOf("promise callback")||-1!==t.stack.trace[e].indexOf("asyncGeneratorStep")||-1!==t.stack.trace[e].indexOf("_asyncToGenerator")||t.stack.trace[e].startsWith("_next")){t.stack.trace.splice(e);break}}return t}isBlacklistedOrigin(e){var t,s,i;return e.periodicPlayerCheck?!(null===(t=this.conf.allowBlacklistedOrigins)||void 0===t?void 0:t.periodicPlayerCheck):e.periodicVideoStyleChangeCheck?!(null===(s=this.conf.allowBlacklistedOrigins)||void 0===s?void 0:s.periodicVideoStyleChangeCheck):!!e.mousemove&&!(null===(i=this.conf.allowBlacklistedOrigins)||void 0===i?void 0:i.handleMouseMove)}isTimeUp(){return!this.isBackgroundScript&&(!!(this.stopTime&&performance.now()>this.stopTime)&&(this.conf.allowLogging&&(this.log("force","debug","-----[ alloted time has run out. logging will stop ]-----"),this.finish()),!0))}isLoggingAllowed(){return this.conf.allowLogging}isLoggingToFile(){var e;return this.conf.allowLogging&&(null===(e=this.conf.fileOptions)||void 0===e?void 0:e.enabled)}canLog(e){const t=this.parseStack();return!(!this.conf.allowLogging&&!t.exitLogs)&&(!this.isBlacklistedOrigin(t)&&(this.canLogFile(e)||this.canLogConsole(e)||t.exitLogs))}canLogFile(e){if(!this.conf.fileOptions.enabled||this.temp_disable)return!1;if(!Array.isArray(e)||!e.length)return this.conf.fileOptions[e];for(const t of e)if(this.conf.fileOptions[t])return this.conf.fileOptions[t]}canLogConsole(e,t){var s;if(!(null===(s=this.conf.consoleOptions)||void 0===s?void 0:s.enabled)||this.temp_disable)return!1;if(!Array.isArray(e)||!e.length)return void 0!==this.conf.consoleOptions[e]?this.conf.consoleOptions[e]:this.conf.logAll;for(const t of e)if(this.conf.consoleOptions[t])return this.conf.consoleOptions[t];return this.conf.logAll}logToFile(e,t){let s=performance.now();s<=this.history[this.history.length-1]&&(s=this.history[this.history.length-1]+1e-5),this.history.push({ts:s,message:e,stack:t})}logToConsole(e,t,s){try{switch(e){case"error":console.error(...t,{stack:s});break;case"warn":console.warn(...t,{stack:s});break;case"info":console.info(...t,{stack:s});break;default:console.log(...t,{stack:s})}}catch(e){console.error("Message too big to log. Error:",e,"stackinfo:",s)}}log(e,t,...s){var i,o,r,a;const n=this.parseStack();if(this.conf&&(this.conf.allowLogging||n.exitLogs))return"force"===e?((null===(i=this.conf.fileOptions)||void 0===i?void 0:i.enabled)&&this.logToFile(s,n),void((null===(o=this.conf.consoleOptions)||void 0===o?void 0:o.enabled)&&this.logToConsole(e,s,n))):void(this.isTimeUp()&&!n.exitLogs||this.isBlacklistedOrigin(n)||((null===(r=this.conf.fileOptions)||void 0===r?void 0:r.enabled)&&(this.canLogFile(t)||n.exitLogs)&&this.logToFile(s,n),(null===(a=this.conf.consoleOptions)||void 0===a?void 0:a.enabled)&&(this.canLogConsole(t)||n.exitLogs)&&this.logToConsole(e,s,n)))}cahen(){if(this.conf.logToFile){let e=performance.now(),t=e-1e3,s=e-500,i=this.history.length;for(e<=this.history[this.history.length-1]&&(e=this.history[this.history.length-1]+1e-5),this.history.push({ts:e,message:"-------------------------------------- CAHEN --------------------------------------"});this.history[i--].ts>s;);for(this.history.push({ts:s,message:"-------------------------------------- 0.5s to CAHEN --------------------------------------"});this.history[i--].ts>t;);this.history.push({ts:t,message:"-------------------------------------- 1s to CAHEN --------------------------------------"})}}appendLog(e){this.history=this.history.concat(e)}addLogFromPage(e,t,s,i){this.globalHistory[e]||(this.globalHistory[e]={}),this.globalHistory[t||"tab"]||(this.globalHistory[e][t||"tab"]={}),this.globalHistory[s||"top"]?this.globalHistory[e][t||"tab"][s||"top"].push(...i):this.globalHistory[e][t||"tab"][s||"top"]=i}saveViaBgScript(){if(console.info('[info] will attempt to save. Issuing "show-logger"'),this.isBackgroundScript)return void console.info("[info] Background script cannot display logger UI.");let e;o.a.sendMessage({cmd:"show-logger",forwardToSameFramePort:!0,port:"content-ui-port"});try{e={pageLogs:Object(i.decycle)(this.history),backgroundLogs:Object(i.decycle)(this.globalHistory),loggerFileOptions:this.conf.fileOptions}}catch(e){return void console.error("[fail] error parsing logs!",e)}try{o.a.sendMessage({cmd:"emit-logs",payload:JSON.stringify(e),forwardToSameFramePort:!0,port:"content-ui-port"})}catch(e){console.log("failed to send message")}}saveToVuex(){var e,t;if(console.info("[info] will attempt to save to vuex store."),!(null===(t=null===(e=this.conf)||void 0===e?void 0:e.fileOptions)||void 0===t?void 0:t.enabled)||this.isBackgroundScript)return void console.info("[info] Logging to file is either disabled or we're not on the content script. Not saving.");if(!this.vuexStore){if(console.error("[info] No vue store."),!this.uwInstance)return void console.error("[info] no vue instance either. Not logging.");console.info("[info] Initializing vue and vuex instance ..."),this.uwInstance.initVue()}let s;console.info("[info] vuex store present. Parsing logs.");try{s={pageLogs:Object(i.decycle)(this.history),backgroundLogs:Object(i.decycle)(this.globalHistory),loggerFileOptions:this.conf.fileOptions}}catch(e){return void console.error("[fail] error parsing logs!",e)}console.info("[info] Logs were parsed successfuly. Putting stuff to vuex ...");try{this.vuexStore.dispatch("uw-set-log",s)}catch(e){return void console.log("[fail] error saving to vuex",e)}console.info("[info] Export object saved to vuex store.")}}t.b=n},13:function(e,t,s){"use strict";var i=s(6);t.a=class{static addNew(e,t){let s=JSON.parse(JSON.stringify(t));if(!e)return i.a.debug&&console.log("[ObjectCopy::addNew] There's no existing value. Returning target value."),s;for(let t in s)e[t]&&typeof s[t]==typeof e[t]&&s[t].constructor===e[t].constructor&&(s[t]&&"object"==typeof s[t]&&s[t].constructor===Object?(i.a.debug&&i.a.settings&&console.log("[ObjectCopy::addNew] current key contains an object. Recursing!"),s[t]=this.addNew(e[t],s[t])):s[t]=e[t]);for(let t in e)s[t]||(s[t]=e[t]);return s}static overwrite(e,t){for(let s in t)void 0!==e[s]?typeof t[s]==typeof e[s]&&t[s].constructor===e[s].constructor&&e[s]&&"object"==typeof e[s]&&e[s].constructor===Object?(i.a.debug&&i.a.settings&&console.log("[ObjectCopy::addNew] current key contains an object. Recursing!"),e[s]=this.overwrite(e[s],t[s])):e[s]=t[s]:void 0!==t[s]&&(e[s]=t[s]);return e}static pruneUnused(e,t,s){}}},14:function(e,t,s){"use strict";var i;!function(e){e[e.Disabled=0]="Disabled",e[e.Lax=1]="Lax",e[e.Strict=2]="Strict"}(i||(i={})),t.a=i},15:function(e,t,s){"use strict";var i=s(6),o=s(17),r=s(2),a=s(13),n=s(3),l=s(4),c=s(8);function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){m(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var h=[{forVersion:"4.5.0",sites:{"www.wakanim.tv":{type:"community",DOM:{player:{manual:!0,querySelectors:"#jwplayer-container",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}}}},{forVersion:"4.5.1",updateFn:(e,t)=>{for(var s in e.sites)try{delete e[sites].autoarPreventConditions}catch(e){}}},{forVersion:"4.5.1.1",updateFn:(e,t)=>{e.sites["streamable.com"]||(e.sites["streamable.com"]={mode:3,autoar:3,type:"official",stretch:-1,videoAlignment:-1,keyboardShortcutsEnabled:0,css:".player {text-align: left}"}),e.sites["streamable.com"].css||(e.sites["streamable.com"].css=".player {text-align: left}")}},{forVersion:"4.5.1.3",updateFn:(e,t)=>{try{e.sites["wwww.disneyplus.com"].css=".hudson-container {\n  height: 100%;\n}"}catch(e){}}},{forVersion:"5.0.1",updateFn:(e,t)=>{try{e.mitigations={zoomLimit:{enabled:c.a.edge||c.a.isEdgeUA,limit:.997,fullscreenOnly:!0}}}catch(e){}}},{forVersion:"5.0.1.1",updateFn:(e,t)=>{try{e.mitigations={zoomLimit:{enabled:!0,limit:.997,fullscreenOnly:!0}}}catch(e){}}},{forVersion:"5.0.2",updateFn:(e,t)=>{try{e.mitigations?c.a.chrome&&(e.mitigations={zoomLimit:{enabled:!0,limit:.997,fullscreenOnly:!0}}):e.mitigations={zoomLimit:{enabled:!0,limit:.997,fullscreenOnly:!0}}}catch(e){}}},{forVersion:"5.0.4",updateFn:(e,t)=>{e.sites["www.disneyplus.com"].DOM.player=d(d({},e.sites["www.disneyplus.com"].DOM.player),{},{querySelectors:".btm-media-client-element",useRelativeAncestor:!0,videoAncestor:1})}},{forVersion:"5.0.5",sites:{"app.plex.tv":{mode:3,autoar:3,type:"community",stretch:-1,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:"body {\n  background-color: #000;\n}\n\n.application {\n  background-color: #000;\n}"}}},{forVersion:"5.0.6",sites:{"metaivi.com":{mode:0,autoar:0,type:"community",stretch:-1,videoAlignment:-1,DOM:{video:{manual:!1,querySelectors:"",additionalCss:"position: absolute !important;"},player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:""},"piped.kavin.rocks":{mode:0,autoar:0,type:"community",autoarFallback:0,stretch:0,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:".shaka-video-container {\n  flex-direction: column !important;\n}"}},updateFn:(e,t)=>{e.sites["app.plex.tv"].type="community",e.sites["piped.kavin.rocks"]={mode:0,autoar:0,type:"community",autoarFallback:0,stretch:0,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:".shaka-video-container {\n  flex-direction: column !important;\n}"}}},{forVersion:"5.0.7",updateFn:(e,t)=>{e.sites["www.youtube.com"].DOM.player={manual:!0,querySelectors:"#movie_player, #player, #c4-player",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}}],u=s(9),f=s(7);class p{constructor(e){var t;this.useSync=!1,this.logger=null==e?void 0:e.logger,this.onSettingsChanged=null==e?void 0:e.onSettingsChanged,this.afterSettingsSaved=null==e?void 0:e.afterSettingsSaved,this.active=null!==(t=null==e?void 0:e.activeSettings)&&void 0!==t?t:void 0,this.default=o.a,this.default.version=this.getExtensionVersion(),f.browser.storage.onChanged.addListener((e,t)=>{this.storageChangeListener(e,t)})}storageChangeListener(e,t){var s,i,o,r;if(!e.uwSettings)return;null===(s=this.logger)||void 0===s||s.log("info","settings","[Settings::<storage/on change>] Settings have been changed outside of here. Updating active settings. Changes:",e,"storage area:",t);const a=JSON.parse(e.uwSettings.newValue);if(this.setActive(a),null===(i=this.logger)||void 0===i||i.log("info","debug","Does parsedSettings.preventReload exist?",a.preventReload,"Does callback exist?",!!this.onSettingsChanged),!a.preventReload&&this.onSettingsChanged)try{this.onSettingsChanged(),null===(o=this.logger)||void 0===o||o.log("info","settings","[Settings] Update callback finished.")}catch(e){null===(r=this.logger)||void 0===r||r.log("error","settings","[Settings] CALLING UPDATE CALLBACK FAILED. Reason:",e)}this.afterSettingsSaved&&this.afterSettingsSaved()}static getExtensionVersion(){return f.browser.runtime.getManifest().version}getExtensionVersion(){return p.getExtensionVersion()}compareExtensionVersions(e,t){let s=e.split("."),i=t.split(".");if(+s[0]!=+i[0])return+s[0]-+i[0];if(+s[1]!=+i[1])return+s[1]-+i[1];if(+s[2]!=+i[2])return+s[2]-+i[2];{if(s[3]=void 0===s[3]?0:s[3],i[3]=void 0===i[3]?0:i[3],isNaN(+s[3])&&!isNaN(+i[3])||!isNaN(+s[3])&&isNaN(+i[3]))return isNaN(+s[3])?-1:1;if(!isNaN(+s[3]))return+s[3]-+i[3];let e=this.getPrereleaseVersionHierarchy(s[3]),t=this.getPrereleaseVersionHierarchy(i[3]);return e!==t?e-t:+s[3].replace(/\D/g,"")-+i[3].replace(/\D/g,"")}}getPrereleaseVersionHierarchy(e){return e.startsWith("dev")?0:e.startsWith("a")?1:e.startsWith("b")?2:3}sortConfPatches(e){return e.sort((e,t)=>this.compareExtensionVersions(e.forVersion,t.forVersion))}findFirstNecessaryPatch(e,t){return this.sortConfPatches(t).findIndex(t=>this.compareExtensionVersions(t.forVersion,e)>0)}applySettingsPatches(e,t){var s,i,o;let r=this.findFirstNecessaryPatch(e,t);if(-1!==r)for(null===(i=this.logger)||void 0===i||i.log("info","settings",`[Settings::applySettingsPatches] There are ${t.length-r} settings patches to apply`);r<t.length;){const e=t[r].updateFn;if(delete t[r].forVersion,delete t[r].updateFn,Object.keys(t[r]).length>0&&a.a.overwrite(this.active,t[r]),e)try{e(this.active,this.getDefaultSettings())}catch(e){null===(o=this.logger)||void 0===o||o.log("error","settings","[Settings::applySettingsPatches] Failed to execute update function. Keeping settings object as-is. Error:",e)}r++}else null===(s=this.logger)||void 0===s||s.log("info","settings","[Settings::applySettingsPatches] There are no pending conf patches.")}async init(){var e,t,s,i;const o=await this.get();this.version=this.getExtensionVersion();const r=o&&o.version||this.version;if(o&&(null===(e=this.logger)||void 0===e||e.log("info","settings","[Settings::init] Configuration fetched from storage:",o,"\nlast saved with:",o.version,"\ncurrent version:",this.version)),!o||0===Object.keys(o).length&&o.constructor===Object)return null===(t=this.logger)||void 0===t||t.log("info","settings","[Settings::init] settings don't exist. Using defaults.\n#keys:",o?Object.keys(o).length:0,"\nsettings:",o),this.active=this.getDefaultSettings(),this.active.version=this.version,await this.save(),this.active;if(this.active=o,!this.active.version)return this.active.version=this.version,await this.save(),this.active;if(this.active.version===this.version)return null===(s=this.logger)||void 0===s||s.log("info","settings","[Settings::init] extension was saved with current version of ultrawidify. Returning object as-is."),this.active;this.active.version=this.version;const n=a.a.addNew(o,this.default);return null===(i=this.logger)||void 0===i||i.log("info","settings","[Settings.init] Results from ObjectCopy.addNew()?",n,"\n\nSettings from storage",o,"\ndefault?",this.default),n&&(this.active=n),this.applySettingsPatches(r,h),this.active.whatsNewChecked=!1,this.active.version=this.version,await this.save(),this.active}async get(){var e;let t;t=await f.browser.storage.local.get("uwSettings"),null===(e=this.logger)||void 0===e||e.log("info","settings","Got settings:",t&&t.uwSettings&&JSON.parse(t.uwSettings));try{return JSON.parse(t.uwSettings)}catch(e){return}}fixSitesSettings(e){for(const t in e)"@global"!==t&&(void 0===e[t].mode&&(e[t].mode=r.a.Default),void 0===e[t].autoar&&(e[t].autoar=r.a.Default),void 0===e[t].stretch&&(e[t].stretch=n.a.Default),void 0===e[t].videoAlignment&&(e[t].videoAlignment=l.a.Default),void 0===e[t].keyboardShortcutsEnabled&&(e[t].keyboardShortcutsEnabled=r.a.Default))}async set(e,t){var s;return t&&t.forcePreserveVersion||(e.version=this.version),this.fixSitesSettings(e.sites),null===(s=this.logger)||void 0===s||s.log("info","settings","[Settings::set] setting new settings:",e),f.browser.storage.local.set({uwSettings:JSON.stringify(e)})}async setActive(e){this.active=e}async setProp(e,t){this.active[e]=t}async save(e){i.a.debug&&i.a.storage&&console.log("[Settings::save] Saving active settings:",this.active),this.active.preventReload=void 0,await this.set(this.active,e)}async saveWithoutReload(){this.active.preventReload=!0,await this.set(this.active)}async rollback(){this.active=await this.get()}getDefaultSettings(){return JSON.parse(JSON.stringify(this.default))}getActionsForSite(e){return e&&this.active.sites[e]&&this.active.sites[e].actions&&this.active.sites[e].actions.length>0?this.active.sites[e].actions:this.active.actions}getSettingsForSite(e){return e||(e=window.location.hostname),this.active.sites[e]}getExtensionMode(e){var t,s;if(!e&&!(e=window.location.hostname))return null===(t=this.logger)||void 0===t||t.log("info","settings",`[Settings::canStartExtension] window.location.hostname is null or undefined: ${window.location.hostname} \nactive settings:`,this.active),r.a.Disabled;try{return this.active.sites[e]?this.active.sites[e].mode===r.a.Enabled?r.a.Enabled:this.active.sites[e].mode===r.a.Basic?r.a.Basic:this.active.sites[e].mode===r.a.Disabled?r.a.Disabled:"@global"!==e?this.getExtensionMode("@global"):r.a.Disabled:this.getExtensionMode("@global")}catch(e){return null===(s=this.logger)||void 0===s||s.log("error","settings","[Settings.js::canStartExtension] Something went wrong — are settings defined/has init() been called?\n\nerror:",e,"\n\nSettings object:",this),r.a.Disabled}}canStartExtension(e){var t,s;if(!e&&!(e=window.location.hostname))return null===(t=this.logger)||void 0===t||t.log("info","settings",`[Settings::canStartExtension] window.location.hostname is null or undefined: ${window.location.hostname} \nactive settings:`,this.active),!1;try{return this.active.sites[e]&&this.active.sites[e].mode!==r.a.Default?this.active.sites["@global"].mode===r.a.Enabled?this.active.sites[e].mode!==r.a.Disabled:this.active.sites["@global"].mode===r.a.Whitelist&&this.active.sites[e].mode===r.a.Enabled:this.active.sites["@global"].mode===r.a.Enabled}catch(e){return null===(s=this.logger)||void 0===s||s.log("error","settings","[Settings.js::canStartExtension] Something went wrong — are settings defined/has init() been called?\nSettings object:",this),!1}}keyboardShortcutsEnabled(e){var t;if(e||(e=window.location.hostname),!e)return!1;try{return this.active.sites[e]&&void 0!==this.active.sites[e].keyboardShortcutsEnabled&&this.active.sites[e].keyboardShortcutsEnabled!==r.a.Default?this.active.sites[e].keyboardShortcutsEnabled===r.a.Enabled:this.keyboardShortcutsEnabled("@global")}catch(e){return null===(t=this.logger)||void 0===t||t.log("info","settings","[Settings.js::keyboardDisabled] something went wrong:",e),!1}}extensionEnabled(){return this.active.sites["@global"].mode!==r.a.Disabled}extensionEnabledForSite(e){return this.canStartExtension(e)}canStartAutoAr(e){var t,s,i,o,a,n;return e||(e=window.location.hostname)?(null===(s=this.logger)||void 0===s||s.log("info",["settings","init","debug"],"[Settings::canStartAutoAr] ----------------\nCAN WE START AUTOAR ON SITE",e,"?\n\nsettings.active.sites[site]=",this.active.sites[e],"settings.active.sites[@global]=",this.active.sites["@global"],"\nAutoar mode (global)?",this.active.sites["@global"].autoar,`\nAutoar mode (${e})`,this.active.sites[e]?this.active.sites[e].autoar:"<not defined>"),this.active.sites[e]?this.active.sites["@global"].autoar===r.a.Enabled?(null===(o=this.logger)||void 0===o||o.log("info",["settings","aard","init","debug"],"[Settings::canStartAutoAr] Aard is enabled by default. Extension can run unless disabled for this site.",this.active.sites[e].autoar),this.active.sites[e].autoar!==r.a.Disabled):this.active.sites["@global"].autoar===r.a.Whitelist?(null===(a=this.logger)||void 0===a||a.log("info",["settings","init","debug"],"canStartAutoAr — can(not) start aard because extension is in whitelist mode, and this site is (not) equal to",r.a.Enabled),this.active.sites[e].autoar===r.a.Enabled):(null===(n=this.logger)||void 0===n||n.log("info",["settings","init","debug"],"canStartAutoAr — cannot start aard because extension is globally disabled"),!1):(null===(i=this.logger)||void 0===i||i.log("info",["settings","aard","init","debug"],"[Settings::canStartAutoAr] Settings not defined for this site, returning defaults.",e,this.active.sites[e],this.active.sites),this.active.sites["@global"].autoar===r.a.Enabled)):(null===(t=this.logger)||void 0===t||t.log("warn",["settings","init","debug"],"[Settings::canStartAutoAr] No site — even window.location.hostname returned nothing!: "+window.location.hostname),!1)}getDefaultOption(e){const t={mode:r.a.Default,autoar:r.a.Default,autoarFallback:r.a.Default,stretch:n.a.Default,videoAlignment:l.a.Default};return e&&void 0!==t[e]?t[e]:t}getDefaultAr(e){return this.active.miscSettings.defaultAr}getDefaultStretchMode(e){var t,s;return e&&(null!==(s=null===(t=this.active.sites[e])||void 0===t?void 0:t.stretch)&&void 0!==s?s:n.a.Default)!==n.a.Default?this.active.sites[e].stretch:this.active.sites["@global"].stretch}getDefaultCropPersistenceMode(e){var t,s;return e&&(null!==(s=null===(t=this.active.sites[e])||void 0===t?void 0:t.cropModePersistence)&&void 0!==s?s:n.a.Default)!==n.a.Default?this.active.sites[e].cropModePersistence:this.active.sites["@global"].cropModePersistence||u.a.Disabled}getDefaultVideoAlignment(e){var t,s;return(null!==(s=null===(t=this.active.sites[e])||void 0===t?void 0:t.videoAlignment)&&void 0!==s?s:l.a.Default)!==l.a.Default?this.active.sites[e].videoAlignment:this.active.sites["@global"].videoAlignment}}t.a=p},16:function(e,t,s){"use strict";function i(e,t){for(var s,i=0;i<t.length;i++)(s=t[i]).enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=new(function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance||(this.loggerLevel="warning",this.levels=["verbose","debug","info","warning","error","none"],e.instance=this),e.instance}return function(e,t,s){t&&i(e.prototype,t),s&&i(e,s)}(e,[{key:"setLoggerLevel",value:function(e){this.loggerLevel=e}},{key:"shouldLog",value:function(e){return this.levels.indexOf(e)>=this.levels.indexOf(this.loggerLevel)}},{key:"verbose",value:function(e){this.printMessage("verbose",e)}},{key:"debug",value:function(e){this.printMessage("debug",e)}},{key:"info",value:function(e){this.printMessage("info",e)}},{key:"warning",value:function(e){this.printMessage("warning",e)}},{key:"error",value:function(e){this.printMessage("error",e)}},{key:"printMessage",value:function(e,t){if(this.shouldLog(e)){var s=e.charAt(0).toUpperCase()+e.slice(1),i="[".concat(s,"] Vuex WebExtensions: ").concat(t);"error"==e?console.error(i):"warning"==e?console.warn(i):"info"==e?console.info(i):console.log(i)}}}]),e}());t.default=o},17:function(e,t,s){"use strict";var i=s(6),o=s(8),r=s(4),a=s(3),n=s(2),l=s(14),c=s(5),g=s(9);i.a.debug&&console.log("Loading: ExtensionConf.js");const d={arDetect:{disabledReason:"",allowedMisaligned:.05,allowedArVariance:.075,timers:{playing:333,paused:3e3,error:3e3,minimumTimeout:5,tickrate:10},autoDisable:{maxExecutionTime:6e3,consecutiveTimeoutCount:5,consecutiveArResets:5},canvasDimensions:{blackframeCanvas:{width:16,height:9},sampleCanvas:{width:640,height:360}},blackframe:{sufficientColorVariance:.1,cumulativeThresholdLax:1600,cumulativeThresholdStrict:2560,blackPixelsCondition:.6},blackbar:{blackLevel:10,threshold:16,frameThreshold:4,imageThreshold:16,gradientThreshold:2,gradientSampleSize:16,maxGradient:6,gradientNegativeTreshold:-2,gradientMaxSD:6,antiGradientMode:l.a.Lax},variableBlackbarThresholdOptions:{enabled:!0,disableArDetectOnMax:!0,maxBlackbarThreshold:48,thresholdStep:8,increaseAfterConsecutiveResets:2},sampling:{staticCols:9,randomCols:0,staticRows:9},guardLine:{enabled:!0,ignoreEdgeMargin:.2,imageTestThreshold:.1,edgeTolerancePx:2,edgeTolerancePercent:null},fallbackMode:{enabled:!0,safetyBorderPx:5,noTriggerZonePx:8},arSwitchLimiter:{switches:2,period:2},edgeDetection:{sampleWidth:8,detectionThreshold:4,confirmationThreshold:1,singleSideConfirmationThreshold:3,logoThreshold:.15,edgeTolerancePx:1,edgeTolerancePercent:null,middleIgnoredArea:.2,minColsForSearch:.5},pillarTest:{ignoreThinPillarsPx:5,allowMisaligned:.05},textLineTest:{nonTextPulse:.1,pulsesToConfirm:10,pulsesToConfirmIfHalfBlack:5,testRowOffset:.02}},zoom:{minLogZoom:-1,maxLogZoom:3,announceDebounce:200},miscSettings:{mousePan:{enabled:!1},mousePanReverseMouse:!1},stretch:{conditionalDifferencePercent:.05},resizer:{setStyleString:{maxRetries:3,retryTimeout:200}},pageInfo:{timeouts:{urlCheck:200,rescan:1500}},actions:[{name:"Trigger automatic detection",label:"Automatic",cmd:[{action:"set-ar",arg:c.a.Automatic,persistent:!1}],scopes:{global:{show:!1},site:{show:!1},page:{show:!0,label:"Automatic",shortcut:[{key:"a",code:"KeyA",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!0,path:"crop"}},{name:"Reset to default",label:"Reset",cmd:[{action:"set-ar",arg:c.a.Reset}],scopes:{page:{show:!0,shortcut:[{key:"r",code:"KeyR",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!0,path:"crop"}},{name:"Fit to width",label:"Fit width",cmd:[{action:"set-ar",arg:c.a.FitWidth}],scopes:{page:{show:!0,shortcut:[{key:"w",code:"KeyW",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!0,path:"crop"}},{name:"Fit to height",label:"Fit height",cmd:[{action:"set-ar",arg:c.a.FitHeight}],scopes:{page:{show:!0,shortcut:[{key:"e",code:"KeyE",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!0,path:"crop"}},{userAdded:!0,name:"Set aspect ratio to 16:9",label:"16:9",cmd:[{action:"set-ar",arg:c.a.Fixed,customArg:1.78}],scopes:{page:{show:!0,shortcut:[{key:"s",code:"KeyS",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!1,onKeyDown:!0}]}},playerUi:{show:!0,path:"crop"}},{userAdded:!0,name:"Set aspect ratio to 21:9 (2.39:1)",label:"21:9",cmd:[{action:"set-ar",arg:c.a.Fixed,customArg:2.39}],scopes:{page:{show:!0,shortcut:[{key:"d",code:"KeyD",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!1,onKeyDown:!0}]}},playerUi:{show:!0,path:"crop"}},{userAdded:!0,name:"Set aspect ratio to 18:9",label:"18:9",cmd:[{action:"set-ar",arg:c.a.Fixed,customArg:2}],scopes:{page:{show:!0,shortcut:[{key:"x",code:"KeyX",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!0,path:"crop"}},{name:"Don't persist crop",label:"Never persist",cmd:[{action:"set-ar-persistence",arg:g.a.Disabled}],scopes:{site:{show:!0},global:{show:!0}},playerUi:{show:!0}},{name:"Persist crop while on page",label:"Until page load",cmd:[{action:"set-ar-persistence",arg:g.a.UntilPageReload}],scopes:{site:{show:!0},global:{show:!0}},playerUi:{show:!0}},{name:"Persist crop for current session",label:"Current session",cmd:[{action:"set-ar-persistence",arg:g.a.CurrentSession}],scopes:{site:{show:!0},global:{show:!0}},playerUi:{show:!0}},{name:"Persist until manually reset",label:"Always persist",cmd:[{action:"set-ar-persistence",arg:g.a.Forever}],scopes:{site:{show:!0},global:{show:!0}},playerUi:{show:!0}},{name:"Default crop persistence",label:"Default",cmd:[{action:"set-ar-persistence",arg:g.a.Default}],scopes:{site:{show:!0}},playerUi:{show:!0}},{name:"Zoom in",label:"Zoom",cmd:[{action:"change-zoom",arg:.1}],scopes:{page:{show:!1,shortcut:[{key:"z",code:"KeyY",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!1}},{name:"Zoom out",label:"Unzoom",cmd:[{action:"change-zoom",arg:-.1}],scopes:{page:{show:!1,shortcut:[{key:"u",code:"KeyU",ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!1,onKeyUp:!0,onKeyDown:!1}]}},playerUi:{show:!1}},{name:"Toggle panning mode",label:"Toggle pan",cmd:[{action:"toggle-pan",arg:"toggle"}],playerUi:{show:!0,path:"zoom"},scopes:{}},{name:"Hold to pan",cmd:[{action:"pan",arg:"toggle"}],scopes:{page:{show:!1,shortcut:[{ctrlKey:!1,metaKey:!1,altKey:!1,shiftKey:!0,onKeyDown:!1,onKeyUp:!1,onMouseMove:!0}]}}},{name:'Set stretch to "none"',label:"Don't stretch",cmd:[{action:"set-stretch",arg:a.a.NoStretch}],scopes:{global:{show:!0,label:"Normal"},site:{show:!0,label:"Normal"},page:{show:!0,label:"Normal"}},playerUi:{show:!0,path:"stretch"}},{name:'Set stretch to "basic"',label:"Basic stretch",cmd:[{action:"set-stretch",arg:a.a.Basic}],scopes:{global:{show:!0,label:"Basic"},site:{show:!0,label:"Basic"},page:{show:!0,label:"Basic"}},playerUi:{show:!0,path:"stretch"}},{name:'Set stretch to "hybrid"',label:"Hybrid stretch",cmd:[{action:"set-stretch",arg:a.a.Hybrid}],scopes:{global:{show:!0,label:"Hybrid"},site:{show:!0,label:"Hybrid"},page:{show:!0,label:"Hybrid"}},playerUi:{show:!0,path:"stretch"}},{name:"Stretch only to hide thin borders",label:"Thin borders only",cmd:[{action:"set-stretch",arg:a.a.Conditional}],scopes:{global:{show:!0,label:"Thin borders"},site:{show:!0,label:"Thin borders"},page:{show:!0,label:"Thin borders"}},playerUi:{show:!0,path:"stretch"}},{name:"Set stretch to default value",label:"Default",cmd:[{action:"set-stretch",arg:a.a.Default}],scopes:{site:{show:!0}}},{name:"Stretch source to 4:3",label:"4:3 stretch (src)",cmd:[{action:"set-stretch",arg:a.a.FixedSource,customArg:1.33}],scopes:{page:{show:!0}},playerUi:{show:!0,path:"crop"}},{name:"Stretch source to 16:9",label:"16:9 stretch (src)",cmd:[{action:"set-stretch",arg:a.a.FixedSource,customArg:1.77}],scopes:{page:{show:!0}},playerUi:{show:!0,path:"crop"}},{name:"Align video to the left",label:"Left",cmd:[{action:"set-alignment",arg:r.a.Left}],scopes:{global:{show:!0},site:{show:!0},page:{show:!0}},playerUi:{show:!0,path:"align"}},{name:"Align video to center",label:"Center",cmd:[{action:"set-alignment",arg:r.a.Center}],scopes:{global:{show:!0},site:{show:!0},page:{show:!0}},playerUi:{show:!0,path:"align"}},{name:"Align video to the right",label:"Right",cmd:[{action:"set-alignment",arg:r.a.Right}],scopes:{global:{show:!0},site:{show:!0},page:{show:!0}},playerUi:{show:!0,path:"align"}},{name:"Use default alignment",label:"Default",cmd:[{action:"set-alignment",arg:r.a.Default}],scopes:{site:{show:!0}}},{name:"Enable extension",label:"Enable",cmd:[{action:"set-ExtensionMode",arg:n.a.Enabled,persistent:!0}],scopes:{global:{show:!0},site:{show:!0}}},{name:"Enable extension on whitelisted sites only",label:"On whitelist only",cmd:[{action:"set-ExtensionMode",arg:n.a.Whitelist,persistent:!0}],scopes:{global:{show:!0}}},{name:"Extension mode: use default settings",label:"Default",cmd:[{action:"set-ExtensionMode",arg:n.a.Default,persistent:!0}],scopes:{site:{show:!0}}},{name:"Disable extension",label:"Disable",cmd:[{action:"set-ExtensionMode",arg:n.a.Disabled,persistent:!0}],scopes:{global:{show:!0},site:{show:!0}}},{name:"Enable automatic aspect ratio detection",label:"Enable",cmd:[{action:"set-autoar-mode",arg:n.a.Enabled,persistent:!0}],scopes:{global:{show:!0},site:{show:!0}}},{name:"Enable automatic aspect ratio detection on whitelisted sites only",label:"On whitelist only",cmd:[{action:"set-autoar-mode",arg:n.a.Whitelist,persistent:!0}],scopes:{global:{show:!0}}},{name:"Use default settings for automatic aspect ratio detection",label:"Default",cmd:[{action:"set-autoar-mode",arg:n.a.Default,persistent:!0}],scopes:{site:{show:!0}}},{name:"Disable automatic aspect ratio detection",label:"Disable",cmd:[{action:"set-autoar-mode",arg:n.a.Disabled,persistent:!0}],scopes:{global:{show:!0},site:{show:!0}}},{name:"Enable keyboard shortcuts",label:"Enable",cmd:[{action:"set-keyboard",arg:n.a.Enabled}],scopes:{global:{show:!0},site:{show:!0},page:{show:!0}}},{name:"Enable keyboard shortcuts on whitelisted sites only",label:"On whitelist only",cmd:[{action:"set-keyboard",arg:n.a.Whitelist}],scopes:{global:{show:!0}}},{name:"Keyboard shortcuts mode: use default settings",label:"Default",cmd:[{action:"set-keyboard",arg:n.a.Default}],scopes:{site:{show:!0}}},{name:"Disable keyboard shortcuts",label:"Disable",cmd:[{action:"set-keyboard",arg:n.a.Disabled}],scopes:{global:{show:!0},site:{show:!0},page:{show:!0}}}],mitigations:{zoomLimit:{enabled:!0,limit:.997,fullscreenOnly:!0}},whatsNewChecked:!0,sites:{"@global":{mode:n.a.Enabled,autoar:n.a.Enabled,autoarFallback:o.a.firefox?n.a.Enabled:n.a.Disabled,stretch:a.a.NoStretch,videoAlignment:r.a.Center,keyboardShortcutsEnabled:n.a.Enabled},"www.youtube.com":{mode:n.a.Enabled,autoar:n.a.Enabled,autoarFallback:n.a.Enabled,override:!1,type:"official",actions:null,stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,DOM:{player:{manual:!0,querySelectors:"#movie_player, #player, #c4-player",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}},"www.netflix.com":{mode:n.a.Enabled,autoar:n.a.Enabled,override:!1,type:"official",stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,arPersistence:!0,DOM:{player:{manual:!0,querySelectors:".VideoContainer",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}},"www.disneyplus.com":{mode:n.a.Enabled,autoar:n.a.Enabled,override:!1,type:"community",stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,arPersistence:!0,DOM:{player:{manual:!0,querySelectors:".btm-media-client-element",additionalCss:"",useRelativeAncestor:!1,videoAncestor:1,playerNodeCss:""}},css:".hudson-container { height: 100%; }"},"www.twitch.tv":{mode:n.a.Enabled,autoar:n.a.Enabled,override:!0,type:"official",stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}},"streamable.com":{mode:3,autoar:3,type:"official",stretch:-1,videoAlignment:-1,keyboardShortcutsEnabled:0,css:".player {text-align: left}"},"vimeo.com":{mode:3,autoar:3,type:"official",stretch:-1,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!0,querySelectors:".player_outro_area",useRelativeAncestor:!1}},css:".player_outro_area {\n  width: 100% !important;\n  display: flex !important;\n  justify-content: center !important;\n}\n\n.player_container, .player {\n  width: 100% !important; \n}"},"old.reddit.com":{mode:n.a.Enabled,autoar:n.a.Enabled,override:!1,type:"testing",stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,DOM:{player:{manual:!1,useRelativeAncestor:!1,querySelectors:".reddit-video-player-root, .media-preview-content"}},css:"video {\n  width: 100% !important;\n  height: 100% !important;\n}"},"www.reddit.com":{mode:n.a.Enabled,autoar:n.a.Enabled,override:!1,type:"testing",stretch:a.a.Default,videoAlignment:r.a.Default,keyboardShortcutsEnabled:n.a.Default,DOM:{player:{manual:!1,useRelativeAncestor:!1,querySelectors:".reddit-video-player-root, .media-preview-content"}},css:"video {\n  width: 100% !important;\n  height: 100% !important;\n}"},"imgur.com":{mode:-1,autoar:-1,autoarFallback:0,stretch:-1,videoAlignment:1,type:"official"},"gfycat.com":{mode:-1,autoar:-1,autoarFallback:0,stretch:-1,videoAlignment:1,type:"official,"},"giant.gfycat.com":{mode:-1,autoar:-1,autoarFallback:0,stretch:-1,videoAlignment:1,type:"official"},"www.wakanim.tv":{type:"community",DOM:{player:{manual:!0,querySelectors:"#jwplayer-container",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}}},"app.plex.tv":{mode:3,autoar:3,type:"community",stretch:-1,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:"body {\n  background-color: #000;\n}\n\n.application {\n  background-color: #000;\n}"},"metaivi.com":{mode:0,autoar:0,type:"community",stretch:-1,videoAlignment:-1,DOM:{video:{manual:!1,querySelectors:"",additionalCss:"position: absolute !important;"},player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:""},"piped.kavin.rocks":{mode:0,autoar:0,type:"community",autoarFallback:0,stretch:0,videoAlignment:-1,keyboardShortcutsEnabled:0,DOM:{player:{manual:!1,querySelectors:"",additionalCss:"",useRelativeAncestor:!1,playerNodeCss:""}},css:".shaka-video-container {\n  flex-direction: column !important;\n}"}}};t.a=d},2:function(e,t,s){"use strict";var i;!function(e){e[e.AutoDisabled=-2]="AutoDisabled",e[e.Disabled=-1]="Disabled",e[e.Default=0]="Default",e[e.Whitelist=1]="Whitelist",e[e.Basic=2]="Basic",e[e.Enabled=3]="Enabled"}(i||(i={})),t.a=i},20:function(e,t,s){"use strict";var i,o=(i=s(16))&&i.__esModule?i:{default:i};function r(e,t){for(var s,i=0;i<t.length;i++)(s=t[i]).enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=Object.freeze({firefox:{name:"Mozilla Firefox",namespace:"browser",type:"promise"},chrome:{name:"Google Chrome",namespace:"chrome",type:"callback"},edge:{name:"Microsoft Edge",namespace:"browser",type:"callback"}}),n=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.browser=null,this.detectBrowser()}return function(e,t,s){t&&r(e.prototype,t),s&&r(e,s)}(e,[{key:"detectBrowser",value:function(){return"undefined"==typeof chrome?void(this.browser=a.edge):"undefined"==typeof browser?void(this.browser=a.chrome):void(this.browser=a.firefox)}},{key:"isBackgroundScript",value:function(e){var t=this;return new Promise((function(s){try{t.browser==a.chrome?chrome.runtime.getBackgroundPage((function(t){return s(e===t)})):t.browser==a.firefox?browser.runtime.getBackgroundPage().then((function(t){return s(e===t)})):t.browser==a.edge&&browser.runtime.getBackgroundPage((function(t){return s(e===t)}))}catch(e){return s(!1)}return!1}))}},{key:"getPersistentStates",value:function(){var e=this;return new Promise((function(t,s){try{e.browser==a.chrome?chrome.storage.local.get("@@vwe-persistence",(function(e){return e["@@vwe-persistence"]?t(e["@@vwe-persistence"]):t(null)})):e.browser==a.firefox?browser.storage.local.get("@@vwe-persistence").then((function(e){return e["@@vwe-persistence"]?t(e["@@vwe-persistence"]):t(null)})):e.browser==a.edge&&browser.storage.local.get("@@vwe-persistence",(function(e){return e["@@vwe-persistence"]?t(e["@@vwe-persistence"]):t(null)}))}catch(e){return s(e)}return!1}))}},{key:"savePersistentStates",value:function(e){if(this.browser==a.chrome)try{chrome.storage.local.set({"@@vwe-persistence":e})}catch(e){o.default.error("Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?")}else if(this.browser==a.firefox)try{browser.storage.local.set({"@@vwe-persistence":e})}catch(e){o.default.error("Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?")}else if(this.browser==a.edge)try{browser.storage.local.set({"@@vwe-persistence":e})}catch(e){o.default.error("Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?")}}},{key:"handleConnection",value:function(e){return this.browser==a.chrome?chrome.runtime.onConnect.addListener(e):browser.runtime.onConnect.addListener(e)}},{key:"connectToBackground",value:function(e){return this.browser==a.chrome?chrome.runtime.connect({name:e}):browser.runtime.connect({name:e})}}]),e}();t.default=n},23:function(e,t,s){var i,o,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,o=[e],void 0===(r="function"==typeof(i=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const t="The message port closed before a response was received.",s="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",i=e=>{const i={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(i).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const r=(t,s)=>(...i)=>{e.runtime.lastError?t.reject(e.runtime.lastError):s.singleCallbackArg||i.length<=1&&!1!==s.singleCallbackArg?t.resolve(i[0]):t.resolve(i)},a=e=>1==e?"argument":"arguments",n=(e,t,s)=>new Proxy(t,{apply:(t,i,o)=>s.call(i,e,...o)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,t={},s={})=>{let i=Object.create(null),o={has:(t,s)=>s in e||s in i,get(o,g,d){if(g in i)return i[g];if(!(g in e))return;let m=e[g];if("function"==typeof m)if("function"==typeof t[g])m=n(e,e[g],t[g]);else if(l(s,g)){let t=((e,t)=>function(s,...i){if(i.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${i.length}`);if(i.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${i.length}`);return new Promise((o,a)=>{if(t.fallbackToNoCallback)try{s[e](...i,r({resolve:o,reject:a},t))}catch(r){console.warn(e+" API method doesn't seem to support the callback parameter, falling back to call it without a callback: ",r),s[e](...i),t.fallbackToNoCallback=!1,t.noCallback=!0,o()}else t.noCallback?(s[e](...i),o()):s[e](...i,r({resolve:o,reject:a},t))})})(g,s[g]);m=n(e,e[g],t)}else m=m.bind(e);else if("object"==typeof m&&null!==m&&(l(t,g)||l(s,g)))m=c(m,t[g],s[g]);else{if(!l(s,"*"))return Object.defineProperty(i,g,{configurable:!0,enumerable:!0,get:()=>e[g],set(t){e[g]=t}}),m;m=c(m,t[g],s["*"])}return i[g]=m,m},set:(t,s,o,r)=>(s in i?i[s]=o:e[s]=o,!0),defineProperty:(e,t,s)=>Reflect.defineProperty(i,t,s),deleteProperty:(e,t)=>Reflect.deleteProperty(i,t)},g=Object.create(e);return new Proxy(g,o)},g=e=>({addListener(t,s,...i){t.addListener(e.get(s),...i)},hasListener:(t,s)=>t.hasListener(e.get(s)),removeListener(t,s){t.removeListener(e.get(s))}});let d=!1;const m=new o(e=>"function"!=typeof e?e:function(t,i,o){let r,a,n=!1,l=new Promise(e=>{r=function(t){d||(console.warn(s,(new Error).stack),d=!0),n=!0,e(t)}});try{a=e(t,i,r)}catch(e){a=Promise.reject(e)}const c=!0!==a&&(g=a)&&"object"==typeof g&&"function"==typeof g.then;var g;if(!0!==a&&!c&&!n)return!1;const m=e=>{e.then(e=>{o(e)},e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",o({__mozWebExtensionPolyfillReject__:!0,message:t})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})};return m(c?a:l),!0}),h=({reject:s,resolve:i},o)=>{e.runtime.lastError?e.runtime.lastError.message===t?i():s(e.runtime.lastError):o&&o.__mozWebExtensionPolyfillReject__?s(new Error(o.message)):i(o)},u=(e,t,s,...i)=>{if(i.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${i.length}`);if(i.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${i.length}`);return new Promise((e,t)=>{const o=h.bind(null,{resolve:e,reject:t});i.push(o),s.sendMessage(...i)})},f={runtime:{onMessage:g(m),onMessageExternal:g(m),sendMessage:u.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:u.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return i.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},c(e,f,i)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=i(chrome)}else e.exports=browser})?i.apply(t,o):i)||(e.exports=r)},29:function(e,t,s){"use strict";async function i(e){return new Promise((t,s)=>setTimeout(()=>t(),e))}s.d(t,"a",(function(){return i}))},3:function(e,t,s){"use strict";var i;!function(e){e[e.NoStretch=0]="NoStretch",e[e.Basic=1]="Basic",e[e.Hybrid=2]="Hybrid",e[e.Conditional=3]="Conditional",e[e.Fixed=4]="Fixed",e[e.FixedSource=5]="FixedSource",e[e.Default=-1]="Default"}(i||(i={})),t.a=i},4:function(e,t,s){"use strict";var i;!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Default=-1]="Default"}(i||(i={})),t.a=i},5:function(e,t,s){"use strict";var i;!function(e){e[e.Initial=-1]="Initial",e[e.Reset=0]="Reset",e[e.Automatic=1]="Automatic",e[e.FitWidth=2]="FitWidth",e[e.FitHeight=3]="FitHeight",e[e.Fixed=4]="Fixed",e[e.Manual=5]="Manual"}(i||(i={})),t.a=i},6:function(e,t,s){"use strict";var i={debugCanvas:{}};i.debug&&console.info("Guess we're debugging ultrawidify then. Debug.js must always load first, and others must follow.\nLoading: Debug.js"),t.a=i},7:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browser=s(23)},8:function(e,t,s){"use strict";s(20);var i={firefox:!1,anyChromium:!0,chrome:!0,edge:!1,processEnvBrowser:"chrome",processEnvChannel:"stable",isEdgeUA:/Edg\/(\.?[0-9]*)*$/.test(window.navigator.userAgent),browserObj:chrome,getURL:e=>function(e){return chrome.runtime.getURL(e)}(e)};t.a=i},9:function(e,t,s){"use strict";var i;!function(e){e[e.Default=-1]="Default",e[e.Disabled=0]="Disabled",e[e.UntilPageReload=1]="UntilPageReload",e[e.CurrentSession=2]="CurrentSession",e[e.Forever=3]="Forever"}(i||(i={})),t.a=i}});
//# sourceMappingURL=uw-bg.js.map