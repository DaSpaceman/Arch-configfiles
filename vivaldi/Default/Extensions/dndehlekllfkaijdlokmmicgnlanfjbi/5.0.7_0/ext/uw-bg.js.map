{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./ext/lib/comms/Comms.ts","webpack:///./ext/lib/comms/CommsServer.ts","webpack:///./ext/uw-bg.js","webpack:///./ext/UWServer.ts","webpack:///../node_modules/json-cyclic/dist/index.js","webpack:///./ext/lib/Logger.ts","webpack:///./ext/lib/ObjectCopy.ts","webpack:///./common/enums/AntiGradientMode.enum.ts","webpack:///./ext/conf/ExtConfPatches.js","webpack:///./ext/lib/Settings.ts","webpack:///../node_modules/vuex-webextensions/dist/logger.js","webpack:///./ext/conf/ExtensionConf.ts","webpack:///./common/enums/ExtensionMode.enum.ts","webpack:///../node_modules/vuex-webextensions/dist/browser.js","webpack:///../node_modules/webextension-polyfill-ts/node_modules/webextension-polyfill/dist/browser-polyfill.js","webpack:///./common/js/utils.ts","webpack:///./common/enums/StretchType.enum.ts","webpack:///./common/enums/VideoAlignmentType.enum.ts","webpack:///./common/enums/AspectRatioType.enum.ts","webpack:///./ext/conf/Debug.js","webpack:///../node_modules/webextension-polyfill-ts/lib/index.js","webpack:///./ext/conf/BrowserDetect.js","webpack:///./common/enums/CropModePersistence.enum.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","message","runtime","sendMessage","server","this","ports","commands","popupPort","postMessage","cmd","zoom","e","sendToActive","async","port","site","getVideoTab","tabHostname","getCurrentTabHostname","setSelectedTab","selectedMenu","selectedSubitem","registerVideo","sender","unregisterVideo","injectCss","cssString","removeCss","replaceCss","oldCssString","newCssString","ret","extensionConf","JSON","stringify","settings","active","logger","log","Promise","resolve","sites","autoar","Enabled","save","Disabled","reason","arDetect","disabledReason","timeout","timers","playing","_a","_b","_c","addToGlobalHistory","host","tab","id","frameId","parse","history","finish","onConnect","addListener","onMessage","processReceivedMessage_nonpersistent","tabs","query","currentWindow","command","callback","push","activeTab","length","url","indexOf","split","frame","undefined","framePort","isNaN","sendToAll","sendToFrameContentScripts","processReceivedMessage","tabId","onDisconnect","keys","portOrSender","sendResponse","execCmd","forwardToSameFramePort","forwardToContentScript","sendToFrame","targetTab","targetFrame","forwardToAll","forwardToActive","handleMessage","currentSite","videoTabs","currentTabId","uiLoggerInitialized","setup","loggingOptions","isBackgroundScript","allowLogging","useConfFromStorage","logAll","fileOptions","enabled","consoleOptions","Logger","init","Settings","comms","subscribe","initUiAndShowLogger","initUi","onActivated","onTabSwitched","console","error","browserObj","reject","css","BrowserDetect","firefox","edge","insertCSS","code","cssOrigin","anyChromium","chrome","removeCSS","oldCss","newCss","activeInfo","hasVideos","_promisifyTabsGet","extractHostname","frameHostname","frames","registerTime","Date","now","menu","subitem","executeScript","file","allFrames","warn","isRejected","setTimeout","ctab","getCurrentTab","ageLimit","pageInfo","timeouts","rescan","selected","sendUnmarkPlayer","window","isArray","Array","isObject","toString","slice","validate","Error","TypeError","isRef","$ref","charAt","encycle","arg","recurs","map","elem","eval","reduce","accum","findRef","find","decycle","baseLoggingOptions","isContentScript","allowBlacklistedOrigins","options","temp_disable","onLogEndCallbacks","globalHistory","vuexStore","uwInstance","conf","storage","local","set","onChanged","changes","area","uwLogger","newLoggerConf","newValue","getConfig","startTime","performance","stopTime","newConf","saveToVuex","store","saveConfig","location","saveViaBgScript","trace","stack","stackInfo","a","line","startsWith","splice","periodicPlayerCheck","periodicVideoStyleChangeCheck","mousemove","handleMouseMove","component","parseStack","exitLogs","isBlacklistedOrigin","canLogFile","canLogConsole","ts","level","info","_d","logToFile","logToConsole","isTimeUp","secondMark","halfSecondMark","logs","concat","pageHistory","exportObject","pageLogs","backgroundLogs","loggerFileOptions","payload","initVue","dispatch","current","newValues","out","debug","k","constructor","addNew","overwrite","existing","target","ignoreKeys","AntiGradientMode","forVersion","type","DOM","player","manual","querySelectors","additionalCss","useRelativeAncestor","playerNodeCss","updateFn","userOptions","defaultOptions","stretch","videoAlignment","keyboardShortcutsEnabled","zoomLimit","limit","fullscreenOnly","videoAncestor","video","autoarFallback","useSync","onSettingsChanged","afterSettingsSaved","activeSettings","default","ExtensionConf","getExtensionVersion","storageChangeListener","uwSettings","parsedSettings","setActive","preventReload","getManifest","version","b","aa","bb","av","getPrereleaseVersionHierarchy","bv","replace","patchesIn","sort","compareExtensionVersions","extconfPatches","sortConfPatches","findIndex","x","oldVersion","patches","index","findFirstNecessaryPatch","ObjectCopy","getDefaultSettings","patched","applySettingsPatches","whatsNewChecked","Default","forcePreserveVersion","fixSitesSettings","prop","Debug","actions","hostname","Basic","getExtensionMode","Whitelist","canStartExtension","_e","_f","option","allDefault","miscSettings","defaultAr","cropModePersistence","_defineProperties","configurable","writable","_default","_classCallCheck","instance","loggerLevel","levels","_createClass","printMessage","shouldLog","toUpperCase","allowedMisaligned","allowedArVariance","paused","minimumTimeout","tickrate","autoDisable","maxExecutionTime","consecutiveTimeoutCount","consecutiveArResets","canvasDimensions","blackframeCanvas","width","height","sampleCanvas","blackframe","sufficientColorVariance","cumulativeThresholdLax","cumulativeThresholdStrict","blackPixelsCondition","blackbar","blackLevel","threshold","frameThreshold","imageThreshold","gradientThreshold","gradientSampleSize","maxGradient","gradientNegativeTreshold","gradientMaxSD","antiGradientMode","Lax","variableBlackbarThresholdOptions","disableArDetectOnMax","maxBlackbarThreshold","thresholdStep","increaseAfterConsecutiveResets","sampling","staticCols","randomCols","staticRows","guardLine","ignoreEdgeMargin","imageTestThreshold","edgeTolerancePx","edgeTolerancePercent","fallbackMode","safetyBorderPx","noTriggerZonePx","arSwitchLimiter","switches","period","edgeDetection","sampleWidth","detectionThreshold","confirmationThreshold","singleSideConfirmationThreshold","logoThreshold","middleIgnoredArea","minColsForSearch","pillarTest","ignoreThinPillarsPx","allowMisaligned","textLineTest","nonTextPulse","pulsesToConfirm","pulsesToConfirmIfHalfBlack","testRowOffset","minLogZoom","maxLogZoom","announceDebounce","mousePan","mousePanReverseMouse","conditionalDifferencePercent","resizer","setStyleString","maxRetries","retryTimeout","urlCheck","label","action","Automatic","persistent","scopes","global","show","page","shortcut","ctrlKey","metaKey","altKey","shiftKey","onKeyUp","onKeyDown","playerUi","path","Reset","FitWidth","FitHeight","userAdded","Fixed","customArg","UntilPageReload","CurrentSession","Forever","onMouseMove","NoStretch","Hybrid","Conditional","FixedSource","Left","Center","Right","mitigations","override","arPersistence","ExtensionMode","_logger","browsers","freeze","namespace","browser","detectBrowser","getBackgroundPage","then","connect","globalThis","self","getPrototypeOf","CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE","SEND_RESPONSE_DEPRECATION_WARNING","wrapAPIs","extensionAPIs","apiMetadata","DefaultWeakMap","WeakMap","createItem","items","super","has","makeCallback","promise","metadata","callbackArgs","lastError","singleCallbackArg","pluralizeArguments","numArgs","wrapMethod","method","wrapper","Proxy","apply","targetMethod","thisObj","args","Function","wrapObject","wrappers","cache","handlers","proxyTarget","receiver","minArgs","maxArgs","fallbackToNoCallback","cbError","noCallback","wrapAsyncFunction","desc","Reflect","deleteProperty","wrapEvent","wrapperMap","listener","hasListener","removeListener","loggedSendResponseDeprecationWarning","onMessageWrappers","wrappedSendResponse","result","didCallSendResponse","sendResponsePromise","response","err","isResultThenable","sendPromisedResult","msg","__mozWebExtensionPolyfillReject__","catch","wrappedSendMessageCallback","reply","wrappedSendMessage","apiNamespaceObj","wrappedCb","staticWrappers","onMessageExternal","settingMetadata","clear","privacy","network","services","websites","sleep","StretchType","VideoAlignmentType","AspectRatioType","debugCanvas","process","processEnvBrowser","processEnvChannel","isEdgeUA","test","getURL","CropModePersistence"],"mappings":"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","file":"ext/uw-bg.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 101);\n","import { browser } from 'webextension-polyfill-ts';\nif (process.env.CHANNEL !== 'stable') {\n    console.info(\"Loading Comms\");\n}\nclass Comms {\n    static async sendMessage(message) {\n        browser.runtime.sendMessage(message);\n    }\n}\nif (process.env.CHANNEL !== 'stable') {\n    console.info(\"Comms loaded\");\n}\nexport default Comms;\n","import { browser } from 'webextension-polyfill-ts';\nimport ExtensionMode from '../../../common/enums/ExtensionMode.enum';\nclass CommsServer {\n    //#endregion\n    constructor(server) {\n        this.ports = [];\n        /**\n         * commands  functions that handle incoming messages\n         * functions can have the following arguments, which are,\n         * in this order:\n         *       message       the message we received\n         *       port|sender   on persistent channels, second argument is port on which the server\n         *                      listens. If the message was sent in non-persistent way, this is the\n         *                      sender script/frame/whatever of the message\n         *       sendResponse  callback function on messages received via non-persistent channel\n         */\n        this.commands = {\n            'announce-zoom': [\n                (message) => {\n                    try {\n                        // forward message to the popup\n                        this.popupPort.postMessage({ cmd: 'set-current-zoom', zoom: message.zoom });\n                    }\n                    catch (e) {\n                        // if popup is closed, this will/may fail. This is okay, so we just ignore this error\n                    }\n                },\n            ],\n            'get-current-zoom': [\n                (message) => this.sendToActive(message),\n            ],\n            'get-current-site': [\n                async (message, port) => {\n                    port.postMessage({\n                        cmd: 'set-current-site',\n                        site: await this.server.getVideoTab(),\n                        tabHostname: await this.getCurrentTabHostname()\n                    });\n                },\n            ],\n            'popup-set-selected-tab': [\n                (message) => this.server.setSelectedTab(message.selectedMenu, message.selectedSubitem),\n            ],\n            'has-video': [\n                (message, port) => this.server.registerVideo(port.sender),\n            ],\n            'noVideo': [\n                (message, port) => this.server.unregisterVideo(port.sender),\n            ],\n            'inject-css': [\n                (message, sender) => this.server.injectCss(message.cssString, sender),\n            ],\n            'eject-css': [\n                (message, sender) => this.server.removeCss(message.cssString, sender),\n            ],\n            'replace-css': [\n                (message, sender) => this.server.replaceCss(message.oldCssString, message.newCssString, sender),\n            ],\n            // 'get-config': [\n            //   (message, port) => {\n            //     this.logger.log('info', 'comms', \"CommsServer: received get-config. Active settings?\", this.settings.active, \"\\n(settings:\", this.settings, \")\");\n            //     port.postMessage(\n            //       {cmd: \"set-config\", conf: this.settings.active, site: this.server.currentSite}\n            //     );\n            //   },\n            // ],\n            'get-config': [\n                (message, sender) => {\n                    var ret = { extensionConf: JSON.stringify(this.settings.active) };\n                    this.logger.log('info', 'comms', \"%c[CommsServer.js::processMessage_nonpersistent] Returning this:\", \"background-color: #11D; color: #aad\", ret);\n                    Promise.resolve(ret);\n                }\n            ],\n            'autoar-enable': [\n                () => {\n                    this.settings.active.sites['@global'].autoar = ExtensionMode.Enabled;\n                    this.settings.save();\n                    this.logger.log('info', 'comms', \"[uw-bg] autoar set to enabled (blacklist). evidenz:\", this.settings.active);\n                }\n            ],\n            'autoar-disable': [\n                (message) => {\n                    this.settings.active.sites['@global'].autoar = ExtensionMode.Disabled;\n                    if (message.reason) {\n                        this.settings.active.arDetect.disabledReason = message.reason;\n                    }\n                    else {\n                        this.settings.active.arDetect.disabledReason = 'User disabled';\n                    }\n                    this.settings.save();\n                    this.logger.log('info', 'comms', \"[uw-bg] autoar set to disabled. evidenz:\", this.settings.active);\n                }\n            ],\n            'autoar-set-interval': [\n                (message) => {\n                    this.logger.log('info', 'comms', `[uw-bg] trying to set new interval for autoAr. New interval is, ${message.timeout} ms`);\n                    // set fairly liberal limit\n                    var timeout = message.timeout < 4 ? 4 : message.timeout;\n                    this.settings.active.arDetect.timers.playing = timeout;\n                    this.settings.save();\n                }\n            ],\n            'logging-stop-and-save': [\n                (message, sender) => {\n                    var _a, _b, _c;\n                    this.logger.log('info', 'comms', \"Received command to stop logging and export the received input\");\n                    this.logger.addToGlobalHistory(`${message.host}::${(_b = (_a = sender === null || sender === void 0 ? void 0 : sender.tab) === null || _a === void 0 ? void 0 : _a.id) !== null && _b !== void 0 ? _b : ''}-${(_c = sender.frameId) !== null && _c !== void 0 ? _c : ''}`, JSON.parse(message.history));\n                    this.logger.finish();\n                }\n            ],\n            'logging-save': [\n                (message, sender) => {\n                    var _a, _b, _c;\n                    this.logger.log('info', 'comms', `Received command to save log for site ${message.host} (tabId ${sender.tab.id}, frameId ${sender.frameId}`);\n                    this.logger.addToGlobalHistory(`${message === null || message === void 0 ? void 0 : message.host}::${(_b = (_a = sender === null || sender === void 0 ? void 0 : sender.tab) === null || _a === void 0 ? void 0 : _a.id) !== null && _b !== void 0 ? _b : ''}-${(_c = sender === null || sender === void 0 ? void 0 : sender.frameId) !== null && _c !== void 0 ? _c : ''}`, JSON.parse(message.history));\n                }\n            ]\n        };\n        this.server = server;\n        this.logger = server.logger;\n        this.settings = server.settings;\n        browser.runtime.onConnect.addListener(p => this.onConnect(p));\n        browser.runtime.onMessage.addListener((m, sender) => this.processReceivedMessage_nonpersistent(m, sender));\n    }\n    //#region getters\n    get activeTab() {\n        return browser.tabs.query({ currentWindow: true, active: true });\n    }\n    subscribe(command, callback) {\n        if (!this.commands[command]) {\n            this.commands[command] = [callback];\n        }\n        else {\n            this.commands[command].push(callback);\n        }\n    }\n    async getCurrentTabHostname() {\n        const activeTab = await this.activeTab;\n        if (!activeTab || activeTab.length < 1) {\n            this.logger.log('warn', 'comms', 'There is no active tab for some reason. activeTab:', activeTab);\n        }\n        const url = activeTab[0].url;\n        var hostname;\n        if (url.indexOf(\"://\") > -1) { //find & remove protocol (http, ftp, etc.) and get hostname\n            hostname = url.split('/')[2];\n        }\n        else {\n            hostname = url.split('/')[0];\n        }\n        hostname = hostname.split(':')[0]; //find & remove port number\n        hostname = hostname.split('?')[0]; //find & remove \"?\"\n        return hostname;\n    }\n    sendToAll(message) {\n        for (const tab of this.ports) {\n            for (const frame in tab) {\n                for (const port in tab[frame]) {\n                    tab[frame][port].postMessage(message);\n                }\n            }\n        }\n    }\n    /**\n     * Sends a message to addon content scripts.\n     * @param message message\n     * @param tab the tab we want to send the message to\n     * @param frame the frame within that tab that we want to send the message to\n     * @param port if defined, message will only be sent to that specific script, otherwise it gets sent to all scripts of a given frame\n     */\n    async sendToFrameContentScripts(message, tab, frame, port) {\n        if (port !== undefined) {\n            this.ports[tab][frame][port].postMessage(message);\n            return;\n        }\n        for (const framePort in this.ports[tab][frame]) {\n            this.ports[tab][frame][framePort].postMessage(message);\n        }\n    }\n    async sendToFrame(message, tab, frame, port) {\n        this.logger.log('info', 'comms', `%c[CommsServer::sendToFrame] attempting to send message to tab ${tab}, frame ${frame}`, \"background: #dda; color: #11D\", message);\n        if (isNaN(tab)) {\n            if (frame === '__playing') {\n                message['playing'] = true;\n                this.sendToAll(message);\n                return;\n            }\n            else if (frame === '__all') {\n                this.sendToAll(message);\n                return;\n            }\n            [tab, frame] = frame.split('-');\n        }\n        this.logger.log('info', 'comms', `%c[CommsServer::sendToFrame] attempting to send message to tab ${tab}, frame ${frame}`, \"background: #dda; color: #11D\", message);\n        try {\n            this.sendToFrameContentScripts(message, tab, frame, port);\n        }\n        catch (e) {\n            this.logger.log('error', 'comms', `%c[CommsServer::sendToFrame] Sending message failed. Reason:`, \"background: #dda; color: #11D\", e);\n        }\n    }\n    async sendToAllFrames(message, tab, port) {\n        for (const frame in this.ports[tab]) {\n            this.sendToFrameContentScripts(message, tab, frame, port);\n        }\n    }\n    async sendToActive(message) {\n        this.logger.log('info', 'comms', \"%c[CommsServer::sendToActive] trying to send a message to active tab. Message:\", \"background: #dda; color: #11D\", message);\n        const tabs = await this.activeTab;\n        this.logger.log('info', 'comms', \"[CommsServer::_sendToActive] currently active tab(s)?\", tabs);\n        for (const frame in this.ports[tabs[0].id]) {\n            this.logger.log('info', 'comms', \"key?\", frame, this.ports[tabs[0].id]);\n        }\n        for (const frame in this.ports[tabs[0].id]) {\n            this.sendToFrameContentScripts(message, tabs[0].id, frame);\n        }\n    }\n    onConnect(port) {\n        // poseben primer | special case\n        if (port.name === 'popup-port') {\n            this.popupPort = port;\n            this.popupPort.onMessage.addListener((m, p) => this.processReceivedMessage(m, p));\n            return;\n        }\n        var tabId = port.sender.tab.id;\n        var frameId = port.sender.frameId;\n        if (!this.ports[tabId]) {\n            this.ports[tabId] = {};\n        }\n        if (!this.ports[tabId][frameId]) {\n            this.ports[tabId][frameId] = {};\n        }\n        this.ports[tabId][frameId][port.name] = port;\n        this.ports[tabId][frameId][port.name].onMessage.addListener((m, p) => this.processReceivedMessage(m, p));\n        this.ports[tabId][frameId][port.name].onDisconnect.addListener((p) => {\n            try {\n                delete this.ports[p.sender.tab.id][p.sender.frameId][port.name];\n            }\n            catch (e) {\n                // no biggie if the thing above doesn't exist. \n            }\n            if (Object.keys(this.ports[tabId][frameId].length === 0)) {\n                delete this.ports[tabId][frameId];\n                if (Object.keys(this.ports[p.sender.tab.id]).length === 0) {\n                    delete this.ports[tabId];\n                }\n            }\n        });\n    }\n    // TODO: sendResponse seems redundant  it used to be a callback for\n    // chrome-based browsers, but browser polyfill doesn't do callback. Just\n    // awaits.\n    async execCmd(message, portOrSender, sendResponse) {\n        var _a, _b;\n        this.logger.log('info', 'comms', '[CommsServer.js::execCmd] Received message', message, \". Port/sender:\", portOrSender, \"sendResponse:\", sendResponse, \"\\nThere is \", (_b = (_a = this.commands[message.cmd]) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0, \" command(s) for action\", message.cmd);\n        if (this.commands[message.cmd]) {\n            for (const c of this.commands[message.cmd]) {\n                try {\n                    await c(message, portOrSender);\n                }\n                catch (e) {\n                    this.logger.log('error', 'debug', \"[CommsServer.js::execCmd] failed to execute command.\", e);\n                }\n            }\n        }\n    }\n    async handleMessage(message, portOrSender) {\n        await this.execCmd(message, portOrSender);\n        if (message.forwardToSameFramePort) {\n            this.sendToFrameContentScripts(message, portOrSender.tab.id, portOrSender.frameId, message.port);\n        }\n        if (message.forwardToContentScript) {\n            this.logger.log('info', 'comms', \"[CommsServer.js::processReceivedMessage] Message has 'forward to content script' flag set. Forwarding message as is. Message:\", message);\n            this.sendToFrame(message, message.targetTab, message.targetFrame);\n        }\n        if (message.forwardToAll) {\n            this.logger.log('info', 'comms', \"[CommsServer.js::processReceivedMessage] Message has 'forward to all' flag set. Forwarding message as is. Message:\", message);\n            this.sendToAll(message);\n        }\n        if (message.forwardToActive) {\n            this.logger.log('info', 'comms', \"[CommsServer.js::processReceivedMessage] Message has 'forward to active' flag set. Forwarding message as is. Message:\", message);\n            this.sendToActive(message);\n        }\n    }\n    async processReceivedMessage(message, port) {\n        this.logger.log('info', 'comms', \"[CommsServer.js::processReceivedMessage] Received message from popup/content script!\", message, \"port\", port);\n        this.handleMessage(message, port);\n    }\n    processReceivedMessage_nonpersistent(message, sender) {\n        this.logger.log('info', 'comms', \"%c[CommsServer.js::processMessage_nonpersistent] Received message from background script!\", \"background-color: #11D; color: #aad\", message, sender);\n        this.handleMessage(message, sender);\n    }\n    // chrome shitiness mitigation\n    sendUnmarkPlayer(message) {\n        this.logger.log('info', 'comms', '[CommsServer.js::sendUnmarkPlayer] Chrome is a shit browser that doesn\\'t do port.postMessage() in unload events, so we have to resort to inelegant hacks. If you see this, then the workaround method works.');\n        this.processReceivedMessage(message, this.popupPort);\n    }\n}\nexport default CommsServer;\n","/**\n * NOTE: we cannot get rid of this js file. I tried for 30 seconds and I couldn't get \n * extension to work unless I kept this part of extension out of the ts file.\n */\n\nimport UWServer from './UWServer';\n\nvar BgVars = {\n  arIsActive: true,\n  hasVideos: false,\n  currentSite: \"\"\n}\n\nconst server = new UWServer();\n\nwindow.sendUnmarkPlayer = (message) => {\n  server.sendUnmarkPlayer(message)\n}","import BrowserDetect from './conf/BrowserDetect';\nimport CommsServer from './lib/comms/CommsServer';\nimport Settings from './lib/Settings';\nimport Logger from './lib/Logger';\nimport { sleep } from '../common/js/utils';\nimport { browser } from 'webextension-polyfill-ts';\nexport default class UWServer {\n    constructor() {\n        this.ports = [];\n        this.currentSite = '';\n        this.videoTabs = {};\n        this.currentTabId = 0;\n        this.selectedSubitem = {\n            'siteSettings': undefined,\n            'videoSettings': undefined,\n        };\n        this.uiLoggerInitialized = false;\n        this.setup();\n    }\n    async setup() {\n        try {\n            // logger is the first thing that goes up\n            const loggingOptions = {\n                isBackgroundScript: true,\n                allowLogging: false,\n                useConfFromStorage: true,\n                logAll: true,\n                fileOptions: {\n                    enabled: false,\n                },\n                consoleOptions: {\n                    enabled: false\n                }\n            };\n            this.logger = new Logger();\n            await this.logger.init(loggingOptions);\n            this.settings = new Settings({ logger: this.logger });\n            await this.settings.init();\n            this.comms = new CommsServer(this);\n            this.comms.subscribe('show-logger', async () => await this.initUiAndShowLogger());\n            this.comms.subscribe('init-vue', async () => await this.initUi());\n            this.comms.subscribe('uwui-vue-initialized', () => this.uiLoggerInitialized = true);\n            this.comms.subscribe('emit-logs', () => { }); // we don't need to do anything, this gets forwarded to UI content script as is\n            browser.tabs.onActivated.addListener((m) => { this.onTabSwitched(m); });\n        }\n        catch (e) {\n            console.error(`Ultrawidify [server]: failed to start. Reason:`, e);\n        }\n    }\n    async _promisifyTabsGet(browserObj, tabId) {\n        return new Promise((resolve, reject) => {\n            browserObj.tabs.get(tabId, (tab) => resolve(tab));\n        });\n    }\n    async injectCss(css, sender) {\n        try {\n            if (BrowserDetect.firefox || BrowserDetect.edge) {\n                browser.tabs.insertCSS(sender.tab.id, { code: css, cssOrigin: 'user', frameId: sender.frameId });\n            }\n            else if (BrowserDetect.anyChromium) {\n                chrome.tabs.insertCSS(sender.tab.id, { code: css, cssOrigin: 'user', frameId: sender.frameId });\n            }\n        }\n        catch (e) {\n            this.logger.log('error', 'debug', '[UwServer::injectCss] Error while injecting css:', { error: e, css, sender });\n        }\n    }\n    async removeCss(css, sender) {\n        try {\n            browser.tabs.removeCSS(sender.tab.id, { code: css, cssOrigin: 'user', frameId: sender.frameId });\n        }\n        catch (e) {\n            this.logger.log('error', 'debug', '[UwServer::injectCss] Error while removing css:', { error: e, css, sender });\n        }\n    }\n    async replaceCss(oldCss, newCss, sender) {\n        if (oldCss !== newCss) {\n            this.injectCss(newCss, sender);\n            this.removeCss(oldCss, sender);\n        }\n    }\n    extractHostname(url) {\n        var hostname;\n        if (!url) {\n            return \"<no url>\";\n        }\n        // extract hostname  \n        if (url.indexOf(\"://\") > -1) { //find & remove protocol (http, ftp, etc.) and get hostname\n            hostname = url.split('/')[2];\n        }\n        else {\n            hostname = url.split('/')[0];\n        }\n        hostname = hostname.split(':')[0]; //find & remove port number\n        hostname = hostname.split('?')[0]; //find & remove \"?\"\n        return hostname;\n    }\n    async onTabSwitched(activeInfo) {\n        this.hasVideos = false;\n        try {\n            this.currentTabId = activeInfo.tabId; // just for readability\n            let tab;\n            if (BrowserDetect.firefox) {\n                tab = await browser.tabs.get(this.currentTabId);\n            }\n            else if (BrowserDetect.anyChromium) {\n                tab = await this._promisifyTabsGet(chrome, this.currentTabId);\n            }\n            this.currentSite = this.extractHostname(tab.url);\n            this.logger.log('info', 'debug', '[UwServer::onTabSwitched] user switched tab. New site:', this.currentSite);\n        }\n        catch (e) {\n            this.logger.log('error', 'debug', '[UwServer::onTabSwitched] there was a problem getting currnet site:', e);\n        }\n        this.selectedSubitem = {\n            'siteSettings': undefined,\n            'videoSettings': undefined,\n        };\n        //TODO: change extension icon based on whether there's any videos on current page\n    }\n    registerVideo(sender) {\n        var _a, _b, _c;\n        this.logger.log('info', 'comms', '[UWServer::registerVideo] Registering video.\\nsender:', sender);\n        const tabHostname = this.extractHostname(sender.tab.url);\n        const frameHostname = this.extractHostname(sender.url);\n        // preveri za osirotele/zastarele vrednosti ter jih po potrebi izbrii\n        // check for orphaned/outdated values and remove them if neccessary\n        if (((_a = this.videoTabs[sender.tab.id]) === null || _a === void 0 ? void 0 : _a.host) != tabHostname) {\n            delete this.videoTabs[sender.tab.id];\n        }\n        else if (((_c = (_b = this.videoTabs[sender.tab.id]) === null || _b === void 0 ? void 0 : _b.frames[sender.frameId]) === null || _c === void 0 ? void 0 : _c.host) != frameHostname) {\n            delete this.videoTabs[sender.tab.id].frames[sender.frameId];\n        }\n        if (this.videoTabs[sender.tab.id]) {\n            this.videoTabs[sender.tab.id].frames[sender.frameId] = {\n                id: sender.frameId,\n                host: frameHostname,\n                url: sender.url,\n                registerTime: Date.now(),\n            };\n        }\n        else {\n            this.videoTabs[sender.tab.id] = {\n                id: sender.tab.id,\n                host: tabHostname,\n                url: sender.tab.url,\n                frames: {}\n            };\n            this.videoTabs[sender.tab.id].frames[sender.frameId] = {\n                id: sender.frameId,\n                host: frameHostname,\n                url: sender.url,\n                registerTime: Date.now(),\n            };\n        }\n        this.logger.log('info', 'comms', '[UWServer::registerVideo] Video registered. current videoTabs:', this.videoTabs);\n    }\n    unregisterVideo(sender) {\n        this.logger.log('info', 'comms', '[UwServer::unregisterVideo] Unregistering video.\\nsender:', sender);\n        if (this.videoTabs[sender.tab.id]) {\n            if (Object.keys(this.videoTabs[sender.tab.id].frames).length <= 1) {\n                delete this.videoTabs[sender.tab.id];\n            }\n            else {\n                if (this.videoTabs[sender.tab.id].frames[sender.frameId]) {\n                    delete this.videoTabs[sender.tab.id].frames[sender.frameId];\n                }\n            }\n        }\n        this.logger.log('info', 'comms', '[UwServer::unregisterVideo] Video has been unregistered. Current videoTabs:', this.videoTabs);\n    }\n    setSelectedTab(menu, subitem) {\n        this.logger.log('info', 'comms', '[UwServer::setSelectedTab] saving selected tab for', menu, ':', subitem);\n        this.selectedSubitem[menu] = subitem;\n    }\n    async initUi() {\n        try {\n            if (BrowserDetect.firefox) {\n                await browser.tabs.executeScript({\n                    file: '/ext/uw-ui.js',\n                    allFrames: true,\n                });\n            }\n            else if (BrowserDetect.anyChromium) {\n                await new Promise(resolve => chrome.tabs.executeScript({\n                    file: '/ext/uw-ui.js',\n                    allFrames: true,\n                }, () => resolve()));\n            }\n        }\n        catch (e) {\n            console.warn('Ultrawidify [server]: UI setup failed. While problematic, this problem shouldn\\'t completely crash the extension.');\n            this.logger.log('ERROR', 'uwbg', 'UI initialization failed. Reason:', e);\n        }\n    }\n    async initUiAndShowLogger() {\n        try {\n            // this implementation is less than optimal and very hacky, but it should work\n            // just fine for our use case.\n            this.uiLoggerInitialized = false;\n            await this.initUi();\n            await new Promise(async (resolve, reject) => {\n                // if content script doesn't give us a response within 5 seconds, something is \n                // obviously wrong and we stop waiting,\n                // oh and btw, resolve/reject do not break the loops, so we need to do that \n                // ourselves:\n                // https://stackoverflow.com/questions/55207256/will-resolve-in-promise-loop-break-loop-iteration\n                let isRejected = false;\n                setTimeout(async () => { isRejected = true; reject(); }, 5000);\n                // check whether UI has been initiated on the FE. If it was, we resolve the \n                // promise and off we go\n                while (!isRejected) {\n                    if (this.uiLoggerInitialized) {\n                        resolve();\n                        return; // remember the bit about resolve() not breaking the loop?\n                    }\n                    await sleep(100);\n                }\n            });\n        }\n        catch (e) {\n            console.warn('Ultrawidify [server]: failed to set up logger UI. While problematic, this problem shouldn\\'t completely crash the extension.');\n        }\n    }\n    async getCurrentTab() {\n        return (await browser.tabs.query({ active: true, currentWindow: true }))[0];\n    }\n    async getVideoTab() {\n        // friendly reminder: if current tab doesn't have a video, \n        // there won't be anything in this.videoTabs[this.currentTabId]\n        const ctab = await this.getCurrentTab();\n        if (!ctab || !ctab.id) {\n            return {\n                host: 'INVALID SITE',\n                frames: [],\n            };\n        }\n        if (this.videoTabs[ctab.id]) {\n            // if video is older than PageInfo's video rescan period (+ 4000ms of grace),\n            // we clean it up from videoTabs[tabId].frames array.\n            const ageLimit = Date.now() - this.settings.active.pageInfo.timeouts.rescan - 4000;\n            try {\n                for (const key in this.videoTabs[ctab.id].frames) {\n                    if (this.videoTabs[ctab.id].frames[key].registerTime < ageLimit) {\n                        delete this.videoTabs[ctab.id].frames[key];\n                    }\n                }\n            }\n            catch (e) {\n                // something went wrong. There's prolly no frames.\n                return {\n                    host: this.extractHostname(ctab.url),\n                    frames: [],\n                    selected: this.selectedSubitem\n                };\n            }\n            return {\n                ...this.videoTabs[ctab.id],\n                host: this.extractHostname(ctab.url),\n                selected: this.selectedSubitem\n            };\n        }\n        // return something more or less empty if this tab doesn't have \n        // a video registered for it\n        return {\n            host: this.extractHostname(ctab.url),\n            frames: [],\n            selected: this.selectedSubitem\n        };\n    }\n    // chrome shitiness mitigation \n    sendUnmarkPlayer(message) {\n        this.comms.sendUnmarkPlayer(message);\n    }\n}\n","var isArray=function(e){return Array.isArray(e)},isObject=function(e){return\"Object\"===Object.prototype.toString.call(e).slice(8,-1)},validate=function(e){if(void 0===e)throw new Error(\"This method requires one parameter\");if(!isArray(e)&&!isObject(e))throw new TypeError(\"This method only accepts arrays and objects\")},isRef=function(e){return isObject(e)&&e.hasOwnProperty(\"$ref\")&&1===Object.keys(e).length&&!!e.$ref&&\"$\"===e.$ref.charAt(0)},encycle=function(arg){validate(arg);var recurs=function(value){return isArray(value)||isObject(value)?isArray(value)?value.map(function(elem,i){return isRef(elem)?(value[i]=eval(\"arg\"+elem.$ref.slice(1)),value):recurs(elem)}):Object.keys(value).reduce(function(accum,key){return accum[key]=isRef(value[key])?eval(\"arg\"+value[key].$ref.slice(1)):recurs(value[key]),accum},value):value};return recurs(arg)},findRef=function(e,r){return Object.keys(r).find(function(c){return r[c]===e})},decycle=function(e){validate(e);var r={},c=function(e,t){void 0===t&&(t=\"$\");var n=findRef(e,r);return n?{$ref:n}:isArray(e)||isObject(e)?(r[t]=e,isArray(e)?e.map(function(e,r){return c(e,t+\"[\"+r+\"]\")}):Object.keys(e).reduce(function(r,n){return r[n]=c(e[n],t+\".\"+n),r},{})):e};return c(e)};exports.encycle=encycle,exports.decycle=decycle;\n//# sourceMappingURL=index.js.map\n","import { decycle } from 'json-cyclic';\nimport Comms from './comms/Comms';\nimport { browser } from 'webextension-polyfill-ts';\nif (process.env.CHANNEL !== 'stable') {\n    console.info('Loading Logger');\n}\nexport const baseLoggingOptions = {\n    isContentScript: true,\n    allowLogging: false,\n    useConfFromStorage: true,\n    fileOptions: {\n        enabled: false\n    },\n    consoleOptions: {\n        \"enabled\": false,\n        \"debug\": true,\n        \"init\": true,\n        \"settings\": true,\n        \"keyboard\": true,\n        \"mousemove\": false,\n        \"actionHandler\": true,\n        \"comms\": true,\n        \"playerDetect\": true,\n        \"resizer\": true,\n        \"scaler\": true,\n        \"stretcher\": true,\n        // \"videoRescan\": true,\n        // \"playerRescan\": true,\n        \"arDetect\": true,\n        \"arDetect_verbose\": true\n    },\n    allowBlacklistedOrigins: {\n        'periodicPlayerCheck': false,\n        'periodicVideoStyleChangeCheck': false,\n        'handleMouseMove': false\n    }\n};\nclass Logger {\n    constructor(options) {\n        this.temp_disable = false;\n        this.onLogEndCallbacks = [];\n        this.history = [];\n        this.globalHistory = {};\n        this.isContentScript = false;\n        this.isBackgroundScript = true;\n        this.vuexStore = options === null || options === void 0 ? void 0 : options.vuexStore;\n        this.uwInstance = options === null || options === void 0 ? void 0 : options.uwInstance;\n    }\n    static saveConfig(conf) {\n        if (process.env.CHANNEL === 'dev') {\n            console.info('Saving logger conf:', conf);\n        }\n        browser.storage.local.set({ 'uwLogger': JSON.stringify(conf) });\n    }\n    static syncConfig(callback) {\n        browser.storage.onChanged.addListener((changes, area) => {\n            if (changes.uwLogger) {\n                const newLoggerConf = JSON.parse(changes.uwLogger.newValue);\n                if (process.env.CHANNEL === 'dev') {\n                    console.info('Logger settings reloaded. New conf:', newLoggerConf);\n                }\n                callback(newLoggerConf);\n            }\n        });\n    }\n    static async getConfig() {\n        let ret;\n        // if (BrowserDetect.firefox) {\n        ret = await browser.storage.local.get('uwLogger');\n        // } else if (BrowserDetect.anyChromium) {\n        //   ret = await new Promise( (resolve, reject) => {\n        //     browser.storage.local.get('uwLogger', (res) => resolve(res));\n        //   });\n        // }\n        if (process.env.CHANNEL === 'dev') {\n            try {\n                console.info(\"[Logger::getSaved] Got settings:\", JSON.parse(ret.uwLogger));\n            }\n            catch (e) {\n                console.info(\"[Logger::getSaved] No settings.\");\n            }\n        }\n        try {\n            return JSON.parse(ret.uwLogger);\n        }\n        catch (e) {\n            return { consoleOptions: {}, fileOptions: {} };\n        }\n    }\n    async init(conf) {\n        // this is the only property that always gets passed via conf\n        // and doesn't get ignored even if the rest of the conf gets\n        // loaded from browser storage\n        if (conf.isContentScript) {\n            this.isContentScript = true;\n            this.isBackgroundScript = false;\n        }\n        else if (conf.isBackgroundScript) {\n            this.isContentScript = false;\n            this.isBackgroundScript = true;\n        }\n        if (conf && process.env.CHANNEL === 'dev' && !conf.useConfFromStorage) {\n            this.conf = conf;\n        }\n        else {\n            this.conf = await Logger.getConfig();\n        }\n        if (this.conf.consoleOptions === undefined) {\n            this.conf.consoleOptions = {};\n        }\n        if (this.conf.fileOptions === undefined) {\n            this.conf.fileOptions = {};\n        }\n        this.startTime = performance.now();\n        this.temp_disable = false;\n        this.stopTime = this.conf.timeout ? performance.now() + (this.conf.timeout * 1000) : undefined;\n        browser.storage.onChanged.addListener((changes, area) => {\n            var _a;\n            if (process.env.CHANNEL === 'dev') {\n                if (!changes.uwLogger) {\n                    // console.info('[Logger::<storage/on change> No new logger settings!');\n                }\n                if (changes['uwLogger'] && changes['uwLogger'].newValue) {\n                    // console.log(\"[Logger::<storage/on change>] Logger have been changed outside of here. Updating active settings. Changes:\", changes, \"storage area:\", area);\n                    // console.info(\"[Logger::<storage/on change>] new logger settings object (parsed):\", JSON.parse(changes.uwLogger.newValue));\n                }\n            }\n            if (!changes['uwLogger']) {\n                return;\n            }\n            if ((_a = changes['uwLogger']) === null || _a === void 0 ? void 0 : _a.newValue) {\n                const newConf = JSON.parse(changes.uwLogger.newValue);\n                if (this.isContentScript && this.conf.allowLogging && !newConf.allowLogging) {\n                    this.saveToVuex();\n                }\n                this.conf = newConf;\n            }\n        });\n    }\n    setVuexStore(store) {\n        this.vuexStore = store;\n    }\n    clear() {\n        this.history = [];\n        this.startTime = performance.now();\n        this.stopTime = this.conf.timeout ? performance.now() + (this.conf.timeout * 1000) : undefined;\n    }\n    setConf(conf) {\n        this.conf = conf; // effective immediately\n        // also persist settings:\n        Logger.saveConfig(conf);\n    }\n    // async getSaved() {\n    //   return Logger.getSaved();    \n    // }\n    // allow syncing of start times between bg and page scripts.\n    // may result in negative times in the log file, but that doesn't \n    // really matter\n    getStartTime() {\n        return this.startTime;\n    }\n    setStartTime(startTime) {\n        if (startTime) {\n            this.startTime = startTime;\n        }\n        else {\n            this.startTime = performance.now();\n        }\n    }\n    // getLogFileString() {\n    //   let logfileStr = '';\n    //   let logTs = '';       // number of seconds since extension started on a given page\n    //   for (let i = 0; i < this.history.length; i++) {\n    //     logTs = ((this.history[i].ts - Math.floor(this.performance.now)) / 3).toFixed(3);\n    //     logfileStr = `${logfileStr}[@${logTs}] -- ${this.history[i].message}\\n`\n    //   }\n    //   return logfileStr;\n    // }\n    getFileLogJSONString() {\n        return {\n            site: window && window.location,\n            log: JSON.stringify(this.history),\n        };\n    }\n    pause() {\n        this.temp_disable = true;\n    }\n    resume() {\n        this.temp_disable = false;\n    }\n    onLogEnd(callback) {\n        this.onLogEndCallbacks.push(callback);\n    }\n    // this should be used mostly in background page instance of logger, btw\n    // \n    addToGlobalHistory(key, log) {\n        this.globalHistory[key] = log;\n        this.log('info', 'debug', 'Added log for', key, 'to global history. Current history:', this.globalHistory);\n    }\n    finish() {\n        if (!this.isBackgroundScript) {\n            this.conf.allowLogging = false;\n            // const logJson = JSON.stringify(decycle(this.history));\n            // this.log('force', 'debugr', 'Calling all log end callbacks. There\\'s this many of them:', 1);\n            // for(const f of this.onLogEndCallbacks) {\n            //   f(logJson);\n            // }\n            // } else {\n            // this.exportLogToFile();\n        }\n        this.saveViaBgScript();\n    }\n    parseStack() {\n        const trace = (new Error()).stack;\n        const stackInfo = {};\n        // we turn our stack into array and remove the \"file::line\" part of the trace,\n        // since that is useless because minification/webpack\n        stackInfo['stack'] = { trace: trace.split('\\n').map(a => a.split('@')[0]) };\n        // here's possible sources that led to this log entry\n        stackInfo['periodicPlayerCheck'] = false;\n        stackInfo['periodicVideoStyleChangeCheck'] = false;\n        stackInfo['aard'] = false;\n        stackInfo['keyboard'] = false;\n        stackInfo['popup'] = false;\n        stackInfo['mousemove'] = false;\n        stackInfo['exitLogs'] = false;\n        // here we check which source triggered the action. There can be more\n        // than one source, too, so we don't break when we find the first one\n        for (const line of stackInfo.stack.trace) {\n            if (line === 'doPeriodicPlayerElementChangeCheck') {\n                stackInfo['periodicPlayerCheck'] = true;\n            }\n            else if (line === 'doPeriodicFallbackChangeDetectionCheck') {\n                stackInfo['periodicVideoStyleChangeCheck'] = true;\n            }\n            else if (line === 'frameCheck') {\n                stackInfo['aard'] = true;\n            }\n            else if (line === 'execAction') {\n                stackInfo['keyboard'] = true;\n            }\n            else if (line === 'processReceivedMessage') {\n                stackInfo['popup'] = true;\n            }\n            else if (line === 'handleMouseMove') {\n                stackInfo['mousemove'] = true;\n            }\n        }\n        // exitLog overrides any other exclusions, so we look for it separately.\n        // we also remove some of the unnecessary messages to reduce log file size\n        for (let i = 0; i < stackInfo.stack.trace.length; i++) {\n            if (stackInfo.stack.trace[i] === 'finish') {\n                stackInfo['exitLogs'] = true;\n                break;\n            }\n            // if we hit one of these, we remove the rest of the array and call it a\n            // day. Chances are there's nothing of value past this point.\n            if (stackInfo.stack.trace[i].indexOf('promise callback') !== -1\n                || stackInfo.stack.trace[i].indexOf('asyncGeneratorStep') !== -1\n                || stackInfo.stack.trace[i].indexOf('_asyncToGenerator') !== -1\n                || stackInfo.stack.trace[i].startsWith('_next')) {\n                stackInfo.stack.trace.splice(i);\n                break;\n            }\n        }\n        return stackInfo;\n    }\n    // test for blacklisted origin\n    isBlacklistedOrigin(stackInfo) {\n        var _a, _b, _c;\n        if (stackInfo.periodicPlayerCheck) {\n            return !((_a = this.conf.allowBlacklistedOrigins) === null || _a === void 0 ? void 0 : _a.periodicPlayerCheck);\n        }\n        if (stackInfo.periodicVideoStyleChangeCheck) {\n            return !((_b = this.conf.allowBlacklistedOrigins) === null || _b === void 0 ? void 0 : _b.periodicVideoStyleChangeCheck);\n        }\n        if (stackInfo.mousemove) {\n            return !((_c = this.conf.allowBlacklistedOrigins) === null || _c === void 0 ? void 0 : _c.handleMouseMove);\n        }\n        return false;\n    }\n    isTimeUp() {\n        // we don't do timeouts on background script\n        if (this.isBackgroundScript) {\n            return false;\n        }\n        if (this.stopTime && performance.now() > this.stopTime) {\n            if (this.conf.allowLogging) {\n                this.log('force', 'debug', '-----[ alloted time has run out. logging will stop ]-----');\n                this.finish();\n            }\n            return true;\n        }\n        return false;\n    }\n    isLoggingAllowed() {\n        return this.conf.allowLogging;\n    }\n    isLoggingToFile() {\n        var _a;\n        return this.conf.allowLogging && ((_a = this.conf.fileOptions) === null || _a === void 0 ? void 0 : _a.enabled);\n    }\n    // NOTE: THIS FUNCTION IS NEVER USED INTERNALLY!\n    canLog(component) {\n        const stackInfo = this.parseStack();\n        if (!this.conf.allowLogging && !stackInfo.exitLogs) {\n            return false;\n        }\n        if (this.isBlacklistedOrigin(stackInfo)) {\n            return false;\n        }\n        // if either of these two is true, we allow logging to happen (forbidden origins were checked above)\n        return (this.canLogFile(component) || this.canLogConsole(component) || stackInfo.exitLogs);\n    }\n    canLogFile(component) {\n        if (!this.conf.fileOptions.enabled || this.temp_disable) {\n            return false;\n        }\n        if (Array.isArray(component) && component.length) {\n            for (const c of component) {\n                if (this.conf.fileOptions[c]) {\n                    return this.conf.fileOptions[c];\n                }\n            }\n        }\n        else {\n            return this.conf.fileOptions[component];\n        }\n    }\n    canLogConsole(component, stackInfo) {\n        var _a;\n        if (!((_a = this.conf.consoleOptions) === null || _a === void 0 ? void 0 : _a.enabled) || this.temp_disable) {\n            return false;\n        }\n        if (Array.isArray(component) && component.length) {\n            for (const c of component) {\n                if (this.conf.consoleOptions[c]) {\n                    return this.conf.consoleOptions[c];\n                }\n            }\n        }\n        else {\n            return this.conf.consoleOptions[component] !== undefined ? this.conf.consoleOptions[component] : this.conf.logAll;\n        }\n        return this.conf.logAll;\n    }\n    logToFile(message, stackInfo) {\n        let ts = performance.now();\n        if (ts <= this.history[this.history.length - 1]) {\n            ts = this.history[this.history.length - 1] + 0.00001;\n        }\n        this.history.push({\n            ts: ts,\n            message: message,\n            stack: stackInfo,\n        });\n    }\n    logToConsole(level, message, stackInfo) {\n        try {\n            switch (level) {\n                case 'error':\n                    console.error(...message, { stack: stackInfo });\n                    break;\n                case 'warn':\n                    console.warn(...message, { stack: stackInfo });\n                    break;\n                case 'info':\n                    console.info(...message, { stack: stackInfo });\n                    break;\n                default:\n                    console.log(...message, { stack: stackInfo });\n            }\n        }\n        catch (e) {\n            console.error(\"Message too big to log. Error:\", e, \"stackinfo:\", stackInfo);\n        }\n    }\n    // level is unused as of now, but this may change in the future\n    // levels: 'info', 'warn', 'error'.\n    // if level is `true` (bool), logging happens regardless of any other\n    // settings\n    log(level, component, ...message) {\n        var _a, _b, _c, _d;\n        const stackInfo = this.parseStack();\n        if (!this.conf || (!this.conf.allowLogging && !stackInfo.exitLogs)) {\n            return;\n        }\n        // skip all checks if we force log\n        if (level === 'force') {\n            if ((_a = this.conf.fileOptions) === null || _a === void 0 ? void 0 : _a.enabled) {\n                this.logToFile(message, stackInfo);\n            }\n            if ((_b = this.conf.consoleOptions) === null || _b === void 0 ? void 0 : _b.enabled) {\n                this.logToConsole(level, message, stackInfo);\n            }\n            return; // don't check further  recursion-land ahead!\n        }\n        if (this.isTimeUp() && !stackInfo.exitLogs) {\n            return;\n        }\n        // don't log stuff from blacklisted origin (unless logger conf says otherwise)\n        if (this.isBlacklistedOrigin(stackInfo)) {\n            return;\n        }\n        if ((_c = this.conf.fileOptions) === null || _c === void 0 ? void 0 : _c.enabled) {\n            if (this.canLogFile(component) || stackInfo.exitLogs) {\n                this.logToFile(message, stackInfo);\n            }\n        }\n        if ((_d = this.conf.consoleOptions) === null || _d === void 0 ? void 0 : _d.enabled) {\n            if (this.canLogConsole(component) || stackInfo.exitLogs) {\n                this.logToConsole(level, message, stackInfo);\n            }\n        }\n    }\n    // leaves a noticeable mark in the file log at the time it got triggered, as well as\n    // at the intervals of 1s and .5s before the trigger moment\n    cahen() {\n        if (this.conf.logToFile) {\n            let ts = performance.now();\n            let secondMark = ts - 1000;\n            let halfSecondMark = ts - 500;\n            let i = this.history.length;\n            // correct ts _after_ secondMark and halfSecondMark were determined\n            if (ts <= this.history[this.history.length - 1]) {\n                ts = this.history[this.history.length - 1] + 0.00001;\n            }\n            this.history.push({\n                ts: ts,\n                message: \"-------------------------------------- CAHEN --------------------------------------\"\n            });\n            // find the spot for the half second mark. In this case, we don't really particularly care whether timestamps \n            // are duped due to cahen warnings\n            while (this.history[i--].ts > halfSecondMark) { }\n            this.history.push({\n                ts: halfSecondMark,\n                message: \"-------------------------------------- 0.5s to CAHEN --------------------------------------\"\n            });\n            // repeat for one second warning\n            while (this.history[i--].ts > secondMark) { }\n            this.history.push({\n                ts: secondMark,\n                message: \"-------------------------------------- 1s to CAHEN --------------------------------------\"\n            });\n        }\n    }\n    appendLog(logs) {\n        this.history = this.history.concat(logs);\n    }\n    addLogFromPage(host, tabId, frameId, pageHistory) {\n        if (!this.globalHistory[host]) {\n            this.globalHistory[host] = {};\n        }\n        if (!this.globalHistory[tabId || 'tab']) {\n            this.globalHistory[host][tabId || 'tab'] = {};\n        }\n        if (!this.globalHistory[frameId || 'top']) {\n            this.globalHistory[host][tabId || 'tab'][frameId || 'top'] = pageHistory;\n        }\n        else {\n            this.globalHistory[host][tabId || 'tab'][frameId || 'top'].push(...pageHistory);\n        }\n    }\n    saveViaBgScript() {\n        console.info('[info] will attempt to save. Issuing \"show-logger\"');\n        if (this.isBackgroundScript) {\n            console.info('[info] Background script cannot display logger UI.');\n            return;\n        }\n        // if (!this.conf?.fileOptions?.enabled) {\n        //   console.info('[info] Logging to file is disabled. Logger won\\'t get shown.');\n        //   return;\n        // }\n        Comms.sendMessage({ cmd: 'show-logger', forwardToSameFramePort: true, port: 'content-ui-port' });\n        let exportObject;\n        try {\n            exportObject = {\n                pageLogs: decycle(this.history),\n                backgroundLogs: decycle(this.globalHistory),\n                loggerFileOptions: this.conf.fileOptions,\n            };\n        }\n        catch (e) {\n            console.error(\"[fail] error parsing logs!\", e);\n            return;\n        }\n        try {\n            Comms.sendMessage({ cmd: 'emit-logs', payload: JSON.stringify(exportObject), forwardToSameFramePort: true, port: 'content-ui-port' });\n        }\n        catch (e) {\n            console.log(\"failed to send message\");\n        }\n    }\n    saveToVuex() {\n        var _a, _b;\n        console.info('[info] will attempt to save to vuex store.');\n        if (!((_b = (_a = this.conf) === null || _a === void 0 ? void 0 : _a.fileOptions) === null || _b === void 0 ? void 0 : _b.enabled) || this.isBackgroundScript) {\n            console.info('[info] Logging to file is either disabled or we\\'re not on the content script. Not saving.');\n            return;\n        }\n        if (!this.vuexStore) {\n            console.error(\"[info] No vue store.\");\n            if (!this.uwInstance) {\n                console.error('[info] no vue instance either. Not logging.');\n                return;\n            }\n            console.info(\"[info] Initializing vue and vuex instance ...\");\n            this.uwInstance.initVue();\n        }\n        console.info('[info] vuex store present. Parsing logs.');\n        let exportObject;\n        try {\n            exportObject = {\n                pageLogs: decycle(this.history),\n                backgroundLogs: decycle(this.globalHistory),\n                loggerFileOptions: this.conf.fileOptions,\n            };\n        }\n        catch (e) {\n            console.error(\"[fail] error parsing logs!\", e);\n            return;\n        }\n        console.info('[info] Logs were parsed successfuly. Putting stuff to vuex ...');\n        try {\n            this.vuexStore.dispatch('uw-set-log', exportObject);\n        }\n        catch (e) {\n            console.log(\"[fail] error saving to vuex\", e);\n            return;\n        }\n        console.info('[info] Export object saved to vuex store.');\n    }\n}\nif (process.env.CHANNEL !== 'stable') {\n    console.info('Logger loaded');\n}\nexport default Logger;\n","import Debug from '../conf/Debug';\nclass ObjectCopy {\n    static addNew(current, newValues) {\n        // clone target\n        let out = JSON.parse(JSON.stringify(newValues));\n        if (!current) {\n            if (Debug.debug) {\n                console.log(\"[ObjectCopy::addNew] There's no existing value. Returning target value.\");\n            }\n            return out;\n        }\n        for (let k in out) {\n            // if current key exist, replace it with existing value. Take no action otherwise.\n            if (current[k]) {\n                // Types and constructors of objects must match. If they don't, we always use the new value.\n                if (typeof out[k] === typeof current[k] && out[k].constructor === current[k].constructor) {\n                    // objects are special, we need to check them recursively.\n                    if (out[k] && typeof out[k] === 'object' && out[k].constructor === Object) {\n                        if (Debug.debug && Debug.settings) {\n                            console.log(\"[ObjectCopy::addNew] current key contains an object. Recursing!\");\n                        }\n                        out[k] = this.addNew(current[k], out[k]);\n                    }\n                    else {\n                        out[k] = current[k];\n                    }\n                }\n            }\n        }\n        // add the values that would otherwise be deleted back to our object. (We need that so user-defined\n        // sites don't get forgotten)\n        for (let k in current) {\n            if (!out[k]) {\n                out[k] = current[k];\n            }\n        }\n        return out;\n    }\n    static overwrite(current, newValues) {\n        for (let k in newValues) {\n            // if current key exist, replace it with existing value. Take no action otherwise.\n            if (current[k] !== undefined) {\n                // Types and constructors of objects must match. If they don't, we always use the new value.\n                if (typeof newValues[k] === typeof current[k] && newValues[k].constructor === current[k].constructor) {\n                    // objects are special, we need to check them recursively.\n                    if (current[k] && typeof current[k] === 'object' && current[k].constructor === Object) {\n                        if (Debug.debug && Debug.settings) {\n                            console.log(\"[ObjectCopy::addNew] current key contains an object. Recursing!\");\n                        }\n                        current[k] = this.overwrite(current[k], newValues[k]);\n                    }\n                    else {\n                        current[k] = newValues[k];\n                    }\n                }\n                else {\n                    current[k] = newValues[k];\n                }\n            }\n            else if (newValues[k] !== undefined) {\n                current[k] = newValues[k];\n            }\n        }\n        return current;\n    }\n    static pruneUnused(existing, target, ignoreKeys) {\n        // TODO: implement at some other date\n        // existing: object that we have.\n        // target: object that we want\n        // ignoreKeys: if key is an object, we don't recursively call this function on that key\n    }\n}\nexport default ObjectCopy;\n","var AntiGradientMode;\n(function (AntiGradientMode) {\n    AntiGradientMode[AntiGradientMode[\"Disabled\"] = 0] = \"Disabled\";\n    AntiGradientMode[AntiGradientMode[\"Lax\"] = 1] = \"Lax\";\n    AntiGradientMode[AntiGradientMode[\"Strict\"] = 2] = \"Strict\";\n})(AntiGradientMode || (AntiGradientMode = {}));\nexport default AntiGradientMode;\n","// How to use:\n// version: {ExtensionConf object, but only properties that get overwritten}\nimport StretchType from '../../common/enums/StretchType.enum';\nimport ExtensionMode from '../../common/enums/ExtensionMode.enum';\nimport VideoAlignmentType from '../../common/enums/VideoAlignmentType.enum';\nimport BrowserDetect from './BrowserDetect';\n\nconst ExtensionConfPatch = [\n  {\n    forVersion: '4.5.0',\n    sites: {\n      \"www.wakanim.tv\": {\n        type: 'community',\n        DOM: {\n          player: {\n            manual: true,\n            querySelectors: \"#jwplayer-container\",\n            additionalCss: \"\",\n            useRelativeAncestor: false,\n            playerNodeCss: \"\",\n          }\n        }\n      }\n    }\n  }, {\n    forVersion: '4.5.1',\n    updateFn: (userOptions, defaultOptions) => {\n      for (const site in userOptions.sites) {\n        try {\n          delete userOptions[sites].autoarPreventConditions\n        } catch (e) {\n          // doesn't matter if site doesn't have that option,\n          // everything is still fine\n        }\n      }\n    }\n  }, {\n    forVersion: '4.5.1.1',\n    updateFn: (userOptions, defaultOptions) => {\n      if (!userOptions.sites['streamable.com']) {\n        userOptions.sites['streamable.com'] = {\n          mode: 3,\n          autoar: 3,\n          type: 'official',\n          stretch: -1,\n          videoAlignment: -1,\n          keyboardShortcutsEnabled: 0,\n          css: \".player {text-align: left}\"\n        };\n      }\n      if (!userOptions.sites['streamable.com'].css) {\n        userOptions.sites['streamable.com'].css = '.player {text-align: left}'\n      };\n    }\n  }, {\n    forVersion: '4.5.1.3',\n    updateFn: (userOptions, defaultOptions) => {\n      try {\n        userOptions.sites['wwww.disneyplus.com']['css'] = \".hudson-container {\\n  height: 100%;\\n}\";\n      } catch (e) {\n        // do nothing if disney+ is missing\n      }\n    }\n  }, {\n    forVersion: '5.0.1',\n    updateFn: (userOptions, defaultOptions) => {\n      try {\n        userOptions.mitigations = {\n          zoomLimit: {\n            enabled: BrowserDetect.edge || BrowserDetect.isEdgeUA,\n            limit: 0.997,\n            fullscreenOnly: true\n          }\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n  }, {\n    forVersion: '5.0.1.1',\n    updateFn: (userOptions, defaultOptions) => {\n      try {\n        userOptions.mitigations = {\n          zoomLimit: {\n            enabled: true,\n            limit: 0.997,\n            fullscreenOnly: true\n          }\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n  }, {\n    forVersion: '5.0.2',\n    updateFn: (userOptions, defaultOptions) => {\n      try {\n        if (! userOptions.mitigations) {\n          userOptions.mitigations = {\n            zoomLimit: {\n              enabled: true,\n              limit: 0.997,\n              fullscreenOnly: true\n            }\n          }\n        } else if (BrowserDetect.chrome) {\n          userOptions.mitigations = {\n            zoomLimit: {\n              enabled: true,\n              limit: 0.997,\n              fullscreenOnly: true\n            }\n          }\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n  }, {\n    forVersion: '5.0.4',\n    updateFn: (userOptions, defaultOptions) => {\n      userOptions.sites['www.disneyplus.com'].DOM.player = {\n        ... userOptions.sites['www.disneyplus.com'].DOM.player,\n        querySelectors: \".btm-media-client-element\",\n        useRelativeAncestor: true,\n        videoAncestor: 1\n      }\n    }\n  }, {\n    forVersion: '5.0.5',\n    sites: {\n      \"app.plex.tv\": {\n        mode: 3,\n        autoar: 3,\n        type: \"community\",\n        stretch: -1,\n        videoAlignment: -1,\n        keyboardShortcutsEnabled: 0,\n        DOM: {\n          player: {\n            manual: false,\n            querySelectors: \"\",\n            additionalCss: \"\",\n            useRelativeAncestor: false,\n            playerNodeCss: \"\"\n          }\n        },\n        css: \"body {\\n  background-color: #000;\\n}\\n\\n.application {\\n  background-color: #000;\\n}\"\n      }\n    }\n  }, {\n    forVersion: '5.0.6',\n    sites: {\n      \"metaivi.com\": {\n        mode: 0,\n        autoar: 0,\n        type: \"community\",\n        stretch: -1,\n        videoAlignment: -1,\n        DOM: {\n          video: {\n            manual: false,\n            querySelectors: \"\",\n            additionalCss: \"position: absolute !important;\"\n          },\n          player: {\n            manual: false,\n            querySelectors: \"\",\n            additionalCss: \"\",\n            useRelativeAncestor: false,\n            playerNodeCss: \"\"\n          }\n        },\n        \"css\": \"\"\n      },\n      \"piped.kavin.rocks\": {\n        mode: 0,\n        autoar: 0,\n        type: 'community',\n        autoarFallback: 0,\n        stretch: 0,\n        videoAlignment: -1,\n        keyboardShortcutsEnabled: 0,\n        DOM: {\n          player: {\n            manual: false,\n            querySelectors: \"\",\n            additionalCss: \"\",\n            useRelativeAncestor: false,\n            playerNodeCss: \"\"\n          }\n        },\n        css: \".shaka-video-container {\\n  flex-direction: column !important;\\n}\"\n      },\n    },\n    updateFn: (userOptions, defaultOptions) => {\n      // 5.0.5 initially incorrectly had app.plex.tv marked as 'user-added'\n      // when 'user-added' is generally reserved for marking sites with user-\n      // changed configuration. Site patches submitted by community should have \n      // 'community' type. extConfPatch for 5.0.5 was also retroactively corrected.\n      userOptions.sites['app.plex.tv'].type = 'community';\n      userOptions.sites['piped.kavin.rocks'] = {\n        mode: 0,\n        autoar: 0,\n        type: 'community',\n        autoarFallback: 0,\n        stretch: 0,\n        videoAlignment: -1,\n        keyboardShortcutsEnabled: 0,\n        DOM: {\n          player: {\n            manual: false,\n            querySelectors: \"\",\n            additionalCss: \"\",\n            useRelativeAncestor: false,\n            playerNodeCss: \"\"\n          }\n        },\n        css: \".shaka-video-container {\\n  flex-direction: column !important;\\n}\"\n      };\n    }\n  }, {\n    forVersion: '5.0.7',\n    updateFn: (userOptions, defaultOptions) => {\n      // 5.0.5 initially incorrectly had app.plex.tv marked as 'user-added'\n      // when 'user-added' is generally reserved for marking sites with user-\n      // changed configuration. Site patches submitted by community should have \n      // 'community' type. extConfPatch for 5.0.5 was also retroactively corrected.\n      userOptions.sites['www.youtube.com'].DOM.player = {\n        manual: true,\n        querySelectors: \"#movie_player, #player, #c4-player\",\n        additionalCss: \"\",\n        useRelativeAncestor: false,\n        playerNodeCss: \"\",\n      }\n    }\n  }\n];\n\n\nexport default ExtensionConfPatch;","import Debug from '../conf/Debug';\nimport ExtensionConf from '../conf/ExtensionConf';\nimport ExtensionMode from '../../common/enums/ExtensionMode.enum';\nimport ObjectCopy from './ObjectCopy';\nimport StretchType from '../../common/enums/StretchType.enum';\nimport VideoAlignmentType from '../../common/enums/VideoAlignmentType.enum';\nimport ExtensionConfPatch from '../conf/ExtConfPatches';\nimport CropModePersistence from '../../common/enums/CropModePersistence.enum';\nimport { browser } from 'webextension-polyfill-ts';\nif (process.env.CHANNEL !== 'stable') {\n    console.info(\"Loading Settings\");\n}\nclass Settings {\n    //#endregion\n    constructor(options) {\n        var _a;\n        //#region flags\n        this.useSync = false;\n        // Options: activeSettings, updateCallback, logger\n        this.logger = options === null || options === void 0 ? void 0 : options.logger;\n        this.onSettingsChanged = options === null || options === void 0 ? void 0 : options.onSettingsChanged;\n        this.afterSettingsSaved = options === null || options === void 0 ? void 0 : options.afterSettingsSaved;\n        this.active = (_a = options === null || options === void 0 ? void 0 : options.activeSettings) !== null && _a !== void 0 ? _a : undefined;\n        this.default = ExtensionConf;\n        this.default['version'] = this.getExtensionVersion();\n        browser.storage.onChanged.addListener((changes, area) => { this.storageChangeListener(changes, area); });\n    }\n    storageChangeListener(changes, area) {\n        var _a, _b, _c, _d;\n        if (!changes.uwSettings) {\n            return;\n        }\n        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', \"[Settings::<storage/on change>] Settings have been changed outside of here. Updating active settings. Changes:\", changes, \"storage area:\", area);\n        // if (changes['uwSettings'] && changes['uwSettings'].newValue) {\n        //   this.logger?.log('info', 'settings',\"[Settings::<storage/on change>] new settings object:\", JSON.parse(changes.uwSettings.newValue));\n        // }\n        const parsedSettings = JSON.parse(changes.uwSettings.newValue);\n        this.setActive(parsedSettings);\n        (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('info', 'debug', 'Does parsedSettings.preventReload exist?', parsedSettings.preventReload, \"Does callback exist?\", !!this.onSettingsChanged);\n        if (!parsedSettings.preventReload && this.onSettingsChanged) {\n            try {\n                this.onSettingsChanged();\n                (_c = this.logger) === null || _c === void 0 ? void 0 : _c.log('info', 'settings', '[Settings] Update callback finished.');\n            }\n            catch (e) {\n                (_d = this.logger) === null || _d === void 0 ? void 0 : _d.log('error', 'settings', \"[Settings] CALLING UPDATE CALLBACK FAILED. Reason:\", e);\n            }\n        }\n        if (this.afterSettingsSaved) {\n            this.afterSettingsSaved();\n        }\n    }\n    static getExtensionVersion() {\n        return browser.runtime.getManifest().version;\n    }\n    getExtensionVersion() {\n        return Settings.getExtensionVersion();\n    }\n    compareExtensionVersions(a, b) {\n        let aa = a.split('.');\n        let bb = b.split('.');\n        if (+aa[0] !== +bb[0]) {\n            // difference on first digit\n            return +aa[0] - +bb[0];\n        }\n        if (+aa[1] !== +bb[1]) {\n            // first digit same, difference on second digit\n            return +aa[1] - +bb[1];\n        }\n        if (+aa[2] !== +bb[2]) {\n            return +aa[2] - +bb[2];\n            // first two digits the same, let's check the third digit\n        }\n        else {\n            // fourth digit is optional. When not specified, 0 is implied\n            // btw, ++(aa[3] || 0) - ++(bb[3] || 0) doesn't work\n            // Since some things are easier if we actually have a value for\n            // the fourth digit, we turn a possible undefined into a zero\n            aa[3] = aa[3] === undefined ? 0 : aa[3];\n            bb[3] = bb[3] === undefined ? 0 : bb[3];\n            // also, the fourth digit can start with a letter. \n            // versions that start with a letter are ranked lower than \n            // versions x.x.x.0\n            if ((isNaN(+aa[3]) && !isNaN(+bb[3]))\n                || (!isNaN(+aa[3]) && isNaN(+bb[3]))) {\n                return isNaN(+aa[3]) ? -1 : 1;\n            }\n            // at this point, either both version numbers are a NaN or \n            // both versions are a number.\n            if (!isNaN(+aa[3])) {\n                return +aa[3] - +bb[3];\n            }\n            // letters have their own hierarchy:\n            // dev < a < b < rc\n            let av = this.getPrereleaseVersionHierarchy(aa[3]);\n            let bv = this.getPrereleaseVersionHierarchy(bb[3]);\n            if (av !== bv) {\n                return av - bv;\n            }\n            else {\n                return +(aa[3].replace(/\\D/g, '')) - +(bb[3].replace(/\\D/g, ''));\n            }\n        }\n    }\n    getPrereleaseVersionHierarchy(version) {\n        if (version.startsWith('dev')) {\n            return 0;\n        }\n        if (version.startsWith('a')) {\n            return 1;\n        }\n        if (version.startsWith('b')) {\n            return 2;\n        }\n        return 3;\n    }\n    sortConfPatches(patchesIn) {\n        return patchesIn.sort((a, b) => this.compareExtensionVersions(a.forVersion, b.forVersion));\n    }\n    findFirstNecessaryPatch(version, extconfPatches) {\n        const sorted = this.sortConfPatches(extconfPatches);\n        return sorted.findIndex(x => this.compareExtensionVersions(x.forVersion, version) > 0);\n    }\n    applySettingsPatches(oldVersion, patches) {\n        var _a, _b, _c;\n        let index = this.findFirstNecessaryPatch(oldVersion, patches);\n        if (index === -1) {\n            (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', '[Settings::applySettingsPatches] There are no pending conf patches.');\n            return;\n        }\n        // apply all remaining patches\n        (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('info', 'settings', `[Settings::applySettingsPatches] There are ${patches.length - index} settings patches to apply`);\n        while (index < patches.length) {\n            const updateFn = patches[index].updateFn;\n            delete patches[index].forVersion;\n            delete patches[index].updateFn;\n            if (Object.keys(patches[index]).length > 0) {\n                ObjectCopy.overwrite(this.active, patches[index]);\n            }\n            if (updateFn) {\n                try {\n                    updateFn(this.active, this.getDefaultSettings());\n                }\n                catch (e) {\n                    (_c = this.logger) === null || _c === void 0 ? void 0 : _c.log('error', 'settings', '[Settings::applySettingsPatches] Failed to execute update function. Keeping settings object as-is. Error:', e);\n                }\n            }\n            index++;\n        }\n    }\n    async init() {\n        var _a, _b, _c, _d;\n        const settings = await this.get();\n        this.version = this.getExtensionVersion();\n        //                 |> on first setup, settings is undefined & settings.version is haram\n        //                 |   since new installs ship with updates by default, no patching is\n        //                 |   needed. In this case, we assume we're on the current version\n        const oldVersion = (settings && settings.version) || this.version;\n        if (settings) {\n            (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', \"[Settings::init] Configuration fetched from storage:\", settings, \"\\nlast saved with:\", settings.version, \"\\ncurrent version:\", this.version);\n        }\n        // if (Debug.flushStoredSettings) {\n        //   this.logger?.log('info', 'settings', \"%c[Settings::init] Debug.flushStoredSettings is true. Using default settings\", \"background: #d00; color: #ffd\");\n        //   Debug.flushStoredSettings = false; // don't do it again this session\n        //   this.active = this.getDefaultSettings();\n        //   this.active.version = this.version;\n        //   this.set(this.active);\n        //   return this.active;\n        // }\n        // if there's no settings saved, return default settings.\n        if (!settings || (Object.keys(settings).length === 0 && settings.constructor === Object)) {\n            (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('info', 'settings', '[Settings::init] settings don\\'t exist. Using defaults.\\n#keys:', settings ? Object.keys(settings).length : 0, '\\nsettings:', settings);\n            this.active = this.getDefaultSettings();\n            this.active.version = this.version;\n            await this.save();\n            return this.active;\n        }\n        // if there's settings, set saved object as active settings\n        this.active = settings;\n        // if version number is undefined, we make it defined\n        // this should only happen on first extension initialization\n        if (!this.active.version) {\n            this.active.version = this.version;\n            await this.save();\n            return this.active;\n        }\n        // check if extension has been updated. If not, return settings as they were retrieved\n        if (this.active.version === this.version) {\n            (_c = this.logger) === null || _c === void 0 ? void 0 : _c.log('info', 'settings', \"[Settings::init] extension was saved with current version of ultrawidify. Returning object as-is.\");\n            return this.active;\n        }\n        // This means extension update happened.\n        // btw fun fact  we can do version rollbacks, which might come in handy while testing\n        this.active.version = this.version;\n        // if extension has been updated, update existing settings with any options added in the\n        // new version. In addition to that, we remove old keys that are no longer used.\n        const patched = ObjectCopy.addNew(settings, this.default);\n        (_d = this.logger) === null || _d === void 0 ? void 0 : _d.log('info', 'settings', \"[Settings.init] Results from ObjectCopy.addNew()?\", patched, \"\\n\\nSettings from storage\", settings, \"\\ndefault?\", this.default);\n        if (patched) {\n            this.active = patched;\n        }\n        // in case settings in previous version contained a fucky wucky, we overwrite existing settings with a patch\n        this.applySettingsPatches(oldVersion, ExtensionConfPatch);\n        // set 'whatsNewChecked' flag to false when updating, always\n        this.active.whatsNewChecked = false;\n        // update settings version to current\n        this.active.version = this.version;\n        await this.save();\n        return this.active;\n    }\n    async get() {\n        var _a;\n        let ret;\n        ret = await browser.storage.local.get('uwSettings');\n        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', 'Got settings:', ret && ret.uwSettings && JSON.parse(ret.uwSettings));\n        try {\n            return JSON.parse(ret.uwSettings);\n        }\n        catch (e) {\n            return undefined;\n        }\n    }\n    fixSitesSettings(sites) {\n        for (const site in sites) {\n            if (site === '@global') {\n                continue;\n            }\n            if (sites[site].mode === undefined) {\n                sites[site].mode = ExtensionMode.Default;\n            }\n            if (sites[site].autoar === undefined) {\n                sites[site].autoar = ExtensionMode.Default;\n            }\n            if (sites[site].stretch === undefined) {\n                sites[site].stretch = StretchType.Default;\n            }\n            if (sites[site].videoAlignment === undefined) {\n                sites[site].videoAlignment = VideoAlignmentType.Default;\n            }\n            if (sites[site].keyboardShortcutsEnabled === undefined) {\n                sites[site].keyboardShortcutsEnabled = ExtensionMode.Default;\n            }\n        }\n    }\n    async set(extensionConf, options) {\n        var _a;\n        if (!options || !options.forcePreserveVersion) {\n            extensionConf.version = this.version;\n        }\n        this.fixSitesSettings(extensionConf.sites);\n        (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', \"[Settings::set] setting new settings:\", extensionConf);\n        return browser.storage.local.set({ 'uwSettings': JSON.stringify(extensionConf) });\n    }\n    async setActive(activeSettings) {\n        this.active = activeSettings;\n    }\n    async setProp(prop, value) {\n        this.active[prop] = value;\n    }\n    async save(options) {\n        if (Debug.debug && Debug.storage) {\n            console.log(\"[Settings::save] Saving active settings:\", this.active);\n        }\n        this.active.preventReload = undefined;\n        await this.set(this.active, options);\n    }\n    async saveWithoutReload() {\n        this.active.preventReload = true;\n        await this.set(this.active);\n    }\n    async rollback() {\n        this.active = await this.get();\n    }\n    getDefaultSettings() {\n        return JSON.parse(JSON.stringify(this.default));\n    }\n    // -----------------------------------------\n    // Nastavitve za posamezno stran\n    // Config for a given page:\n    // \n    // <hostname> : {\n    //    status: <option>              // should extension work on this site?\n    //    arStatus: <option>            // should we do autodetection on this site?\n    //    statusEmbedded: <option>      // reserved for future... maybe\n    // } \n    //  \n    // Veljavne vrednosti za monosti \n    // Valid values for options:\n    //\n    //     status, arStatus, statusEmbedded:\n    //    \n    //    * enabled      always allow\n    //    * basic        only allow fullscreen\n    //    * default      allow if default is to allow, block if default is to block\n    //    * disabled     never allow\n    getActionsForSite(site) {\n        if (!site) {\n            return this.active.actions;\n        }\n        if (this.active.sites[site] && this.active.sites[site].actions && this.active.sites[site].actions.length > 0) {\n            return this.active.sites[site].actions;\n        }\n        return this.active.actions;\n    }\n    getSettingsForSite(site) {\n        if (!site) {\n            site = window.location.hostname;\n        }\n        return this.active.sites[site];\n    }\n    getExtensionMode(site) {\n        var _a, _b;\n        if (!site) {\n            site = window.location.hostname;\n            if (!site) {\n                (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', `[Settings::canStartExtension] window.location.hostname is null or undefined: ${window.location.hostname} \\nactive settings:`, this.active);\n                return ExtensionMode.Disabled;\n            }\n        }\n        try {\n            // if site-specific settings don't exist for the site, we use default mode:\n            if (!this.active.sites[site]) {\n                return this.getExtensionMode('@global');\n            }\n            if (this.active.sites[site].mode === ExtensionMode.Enabled) {\n                return ExtensionMode.Enabled;\n            }\n            else if (this.active.sites[site].mode === ExtensionMode.Basic) {\n                return ExtensionMode.Basic;\n            }\n            else if (this.active.sites[site].mode === ExtensionMode.Disabled) {\n                return ExtensionMode.Disabled;\n            }\n            else {\n                if (site !== '@global') {\n                    return this.getExtensionMode('@global');\n                }\n                else {\n                    return ExtensionMode.Disabled;\n                }\n            }\n        }\n        catch (e) {\n            (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('error', 'settings', \"[Settings.js::canStartExtension] Something went wrong  are settings defined/has init() been called?\\n\\nerror:\", e, \"\\n\\nSettings object:\", this);\n            return ExtensionMode.Disabled;\n        }\n    }\n    canStartExtension(site) {\n        var _a, _b;\n        // returns 'true' if extension can be started on a given site. Returns false if we shouldn't run.\n        if (!site) {\n            site = window.location.hostname;\n            if (!site) {\n                (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', `[Settings::canStartExtension] window.location.hostname is null or undefined: ${window.location.hostname} \\nactive settings:`, this.active);\n                return false;\n            }\n        }\n        // if (Debug.debug) {\n        //   // let's just temporarily disable debugging while recursively calling\n        //   // this function to get extension status on current site without duplo\n        //   // console logs (and without endless recursion)\n        //   Debug.debug = false;\n        //   const cse = this.canStartExtension(site);\n        //   Debug.debug = true;\n        // }\n        try {\n            // if site is not defined, we use default mode:\n            if (!this.active.sites[site] || this.active.sites[site].mode === ExtensionMode.Default) {\n                return this.active.sites['@global'].mode === ExtensionMode.Enabled;\n            }\n            if (this.active.sites['@global'].mode === ExtensionMode.Enabled) {\n                return this.active.sites[site].mode !== ExtensionMode.Disabled;\n            }\n            else if (this.active.sites['@global'].mode === ExtensionMode.Whitelist) {\n                return this.active.sites[site].mode === ExtensionMode.Enabled;\n            }\n            else {\n                return false;\n            }\n        }\n        catch (e) {\n            (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('error', 'settings', \"[Settings.js::canStartExtension] Something went wrong  are settings defined/has init() been called?\\nSettings object:\", this);\n            return false;\n        }\n    }\n    keyboardShortcutsEnabled(site) {\n        var _a;\n        if (!site) {\n            site = window.location.hostname;\n        }\n        if (!site) {\n            return false;\n        }\n        try {\n            if (!this.active.sites[site]\n                || this.active.sites[site].keyboardShortcutsEnabled === undefined\n                || this.active.sites[site].keyboardShortcutsEnabled === ExtensionMode.Default) {\n                return this.keyboardShortcutsEnabled('@global');\n            }\n            else {\n                return this.active.sites[site].keyboardShortcutsEnabled === ExtensionMode.Enabled;\n            }\n        }\n        catch (e) {\n            (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('info', 'settings', \"[Settings.js::keyboardDisabled] something went wrong:\", e);\n            return false;\n        }\n    }\n    extensionEnabled() {\n        return this.active.sites['@global'].mode !== ExtensionMode.Disabled;\n    }\n    extensionEnabledForSite(site) {\n        return this.canStartExtension(site);\n    }\n    canStartAutoAr(site) {\n        var _a, _b, _c, _d, _e, _f;\n        // 'site' argument is only ever used when calling this function recursively for debugging\n        if (!site) {\n            site = window.location.hostname;\n            if (!site) {\n                (_a = this.logger) === null || _a === void 0 ? void 0 : _a.log('warn', ['settings', 'init', 'debug'], `[Settings::canStartAutoAr] No site  even window.location.hostname returned nothing!: ${window.location.hostname}`);\n                return false;\n            }\n        }\n        // if (Debug.debug) {\n        // let's just temporarily disable debugging while recursively calling\n        // this function to get extension status on current site without duplo\n        // console logs (and without endless recursion)\n        // Debug.debug = false;\n        // const csar = this.canStartAutoAr(site);\n        // Debug.debug = true;\n        (_b = this.logger) === null || _b === void 0 ? void 0 : _b.log('info', ['settings', 'init', 'debug'], \"[Settings::canStartAutoAr] ----------------\\nCAN WE START AUTOAR ON SITE\", site, \"?\\n\\nsettings.active.sites[site]=\", this.active.sites[site], \"settings.active.sites[@global]=\", this.active.sites['@global'], \"\\nAutoar mode (global)?\", this.active.sites['@global'].autoar, `\\nAutoar mode (${site})`, this.active.sites[site] ? this.active.sites[site].autoar : '<not defined>');\n        // }\n        // if site is not defined, we use default mode:    \n        if (!this.active.sites[site]) {\n            (_c = this.logger) === null || _c === void 0 ? void 0 : _c.log('info', ['settings', 'aard', 'init', 'debug'], \"[Settings::canStartAutoAr] Settings not defined for this site, returning defaults.\", site, this.active.sites[site], this.active.sites);\n            return this.active.sites['@global'].autoar === ExtensionMode.Enabled;\n        }\n        if (this.active.sites['@global'].autoar === ExtensionMode.Enabled) {\n            (_d = this.logger) === null || _d === void 0 ? void 0 : _d.log('info', ['settings', 'aard', 'init', 'debug'], `[Settings::canStartAutoAr] Aard is enabled by default. Extension can run unless disabled for this site.`, this.active.sites[site].autoar);\n            return this.active.sites[site].autoar !== ExtensionMode.Disabled;\n        }\n        else if (this.active.sites['@global'].autoar === ExtensionMode.Whitelist) {\n            (_e = this.logger) === null || _e === void 0 ? void 0 : _e.log('info', ['settings', 'init', 'debug'], \"canStartAutoAr  can(not) start aard because extension is in whitelist mode, and this site is (not) equal to\", ExtensionMode.Enabled);\n            return this.active.sites[site].autoar === ExtensionMode.Enabled;\n        }\n        else {\n            (_f = this.logger) === null || _f === void 0 ? void 0 : _f.log('info', ['settings', 'init', 'debug'], \"canStartAutoAr  cannot start aard because extension is globally disabled\");\n            return false;\n        }\n    }\n    getDefaultOption(option) {\n        const allDefault = {\n            mode: ExtensionMode.Default,\n            autoar: ExtensionMode.Default,\n            autoarFallback: ExtensionMode.Default,\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n        };\n        if (!option || allDefault[option] === undefined) {\n            return allDefault;\n        }\n        return allDefault[option];\n    }\n    getDefaultAr(site) {\n        // site = this.getSiteSettings(site);\n        // if (site.defaultAr) {\n        //   return site.defaultAr;\n        // }\n        return this.active.miscSettings.defaultAr;\n    }\n    getDefaultStretchMode(site) {\n        var _a, _b;\n        if (site && ((_b = (_a = this.active.sites[site]) === null || _a === void 0 ? void 0 : _a.stretch) !== null && _b !== void 0 ? _b : StretchType.Default) !== StretchType.Default) {\n            return this.active.sites[site].stretch;\n        }\n        return this.active.sites['@global'].stretch;\n    }\n    getDefaultCropPersistenceMode(site) {\n        var _a, _b;\n        if (site && ((_b = (_a = this.active.sites[site]) === null || _a === void 0 ? void 0 : _a.cropModePersistence) !== null && _b !== void 0 ? _b : StretchType.Default) !== StretchType.Default) {\n            return this.active.sites[site].cropModePersistence;\n        }\n        // persistence mode thing is missing from settings by default\n        return this.active.sites['@global'].cropModePersistence || CropModePersistence.Disabled;\n    }\n    getDefaultVideoAlignment(site) {\n        var _a, _b;\n        if (((_b = (_a = this.active.sites[site]) === null || _a === void 0 ? void 0 : _a.videoAlignment) !== null && _b !== void 0 ? _b : VideoAlignmentType.Default) !== VideoAlignmentType.Default) {\n            return this.active.sites[site].videoAlignment;\n        }\n        return this.active.sites['@global'].videoAlignment;\n    }\n}\nexport default Settings;\nif (process.env.CHANNEL !== 'stable') {\n    console.info(\"Settings loaded\");\n}\n","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports[\"default\"]=void 0;function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError(\"Cannot call a class as a function\")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,\"value\"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var Logger=function(){function a(){return _classCallCheck(this,a),a.instance||(this.loggerLevel=\"warning\",this.levels=[\"verbose\",\"debug\",\"info\",\"warning\",\"error\",\"none\"],a.instance=this),a.instance}return _createClass(a,[{key:\"setLoggerLevel\",value:function setLoggerLevel(a){this.loggerLevel=a}},{key:\"shouldLog\",value:function shouldLog(a){return this.levels.indexOf(a)>=this.levels.indexOf(this.loggerLevel)}},{key:\"verbose\",value:function verbose(a){this.printMessage(\"verbose\",a)}},{key:\"debug\",value:function debug(a){this.printMessage(\"debug\",a)}},{key:\"info\",value:function info(a){this.printMessage(\"info\",a)}},{key:\"warning\",value:function warning(a){this.printMessage(\"warning\",a)}},{key:\"error\",value:function error(a){this.printMessage(\"error\",a)}},{key:\"printMessage\",value:function printMessage(a,b){if(this.shouldLog(a)){var c=a.charAt(0).toUpperCase()+a.slice(1),d=\"[\".concat(c,\"] Vuex WebExtensions: \").concat(b);\"error\"==a?console.error(d):\"warning\"==a?console.warn(d):\"info\"==a?console.info(d):console.log(d)}}}]),a}(),instance=new Logger,_default=instance;exports[\"default\"]=_default;","import Debug from './Debug';\nimport currentBrowser from './BrowserDetect';\nimport VideoAlignmentType from '../../common/enums/VideoAlignmentType.enum';\nimport StretchType from '../../common/enums/StretchType.enum';\nimport ExtensionMode from '../../common/enums/ExtensionMode.enum';\nimport AntiGradientMode from '../../common/enums/AntiGradientMode.enum';\nimport AspectRatioType from '../../common/enums/AspectRatioType.enum';\nimport CropModePersistence from '../../common/enums/CropModePersistence.enum';\nif (Debug.debug)\n    console.log(\"Loading: ExtensionConf.js\");\nconst ExtensionConf = {\n    arDetect: {\n        disabledReason: \"\",\n        allowedMisaligned: 0.05,\n        // Any more and we don't adjust ar.\n        allowedArVariance: 0.075,\n        timers: {\n            playing: 333,\n            paused: 3000,\n            error: 3000,\n            minimumTimeout: 5,\n            tickrate: 10, // 1 tick every this many milliseconds\n        },\n        autoDisable: {\n            maxExecutionTime: 6000,\n            // we disable it.\n            consecutiveTimeoutCount: 5,\n            // FOR FUTURE USE\n            consecutiveArResets: 5 // if aspect ratio reverts immediately after AR change is applied, we disable everything\n        },\n        canvasDimensions: {\n            blackframeCanvas: {\n                // it's not used to detect aspect ratio by itself, so it can be tiny af\n                width: 16,\n                height: 9,\n            },\n            sampleCanvas: {\n                // at the expense of performance\n                width: 640,\n                height: 360,\n            },\n        },\n        // samplingInterval: 10,     // we sample at columns at (width/this) * [ 1 .. this - 1]\n        blackframe: {\n            sufficientColorVariance: 0.10,\n            // component. Average intensity is normalized to where 0 is black and 1 is biggest value for\n            // that component. If sum of differences between normalized average intensity and normalized\n            // component varies more than this % between color components, we can afford to use less strict\n            // cumulative threshold.\n            cumulativeThresholdLax: 1600,\n            cumulativeThresholdStrict: 2560,\n            // (note: blackframe is 16x9 px -> 144px total. cumulative threshold can be reached fast)\n            blackPixelsCondition: 0.6, // How much pixels must be black (1 all, 0 none) before we consider frame as black. Takes\n            // precedence over cumulative threshold: if blackPixelsCondition is met, the frame is dark\n            // regardless of whether cumulative threshold has been reached.\n        },\n        blackbar: {\n            blackLevel: 10,\n            // default. blackLevel can decrease if we detect darker black.\n            threshold: 16,\n            // on 0-255. Needs to be fairly high (8 might not cut it) due to compression\n            // artifacts in the video itself\n            frameThreshold: 4,\n            imageThreshold: 16,\n            // the sum of black level, threshold and this value.\n            gradientThreshold: 2,\n            // the last pixel that's darker than our threshold, and position of the first pixel that's\n            // brighter than our image threshold. If positions are more than this many pixels apart,\n            // we assume we aren't looking at letterbox and thus don't correct the aspect ratio.\n            gradientSampleSize: 16,\n            maxGradient: 6,\n            // looking at a gradient\n            gradientNegativeTreshold: -2,\n            gradientMaxSD: 6,\n            antiGradientMode: AntiGradientMode.Lax,\n        },\n        variableBlackbarThresholdOptions: {\n            // FOR FUTURE USE\n            enabled: true,\n            disableArDetectOnMax: true,\n            maxBlackbarThreshold: 48,\n            thresholdStep: 8,\n            increaseAfterConsecutiveResets: 2 // increase if AR resets this many times in a row\n        },\n        sampling: {\n            staticCols: 9,\n            randomCols: 0,\n            staticRows: 9, // forms grid with staticSampleCols. Determined in the same way. For black frame checks\n        },\n        guardLine: {\n            // (if AR fails to be recalculated, we reset AR)\n            enabled: true,\n            ignoreEdgeMargin: 0.20,\n            // (relative to width of the sample)\n            imageTestThreshold: 0.1,\n            edgeTolerancePx: 2,\n            edgeTolerancePercent: null // unused. same as above, except use % of canvas height instead of pixels\n        },\n        fallbackMode: {\n            enabled: true,\n            safetyBorderPx: 5,\n            noTriggerZonePx: 8 // if we detect edge less than this many pixels thick, we don't correct.\n        },\n        arSwitchLimiter: {\n            switches: 2,\n            period: 2.0 // per this period\n        },\n        edgeDetection: {\n            sampleWidth: 8,\n            detectionThreshold: 4,\n            confirmationThreshold: 1,\n            singleSideConfirmationThreshold: 3,\n            // to confirm an edge in case there's no edges on top or bottom (other\n            // than logo, of course)\n            logoThreshold: 0.15,\n            // or watermark.\n            edgeTolerancePx: 1,\n            edgeTolerancePercent: null,\n            middleIgnoredArea: 0.2,\n            minColsForSearch: 0.5, // if we hit the edge of blackbars for all but this many columns (%-wise), we don't\n            // continue with search. It's pointless, because black edge is higher/lower than we\n            // are now. (NOTE: keep this less than 1 in case we implement logo detection)\n        },\n        pillarTest: {\n            ignoreThinPillarsPx: 5,\n            allowMisaligned: 0.05 // left and right edge can vary this much (%)\n        },\n        textLineTest: {\n            nonTextPulse: 0.10,\n            // with text. This value is relative to canvas width (%)\n            pulsesToConfirm: 10,\n            pulsesToConfirmIfHalfBlack: 5,\n            // is over 50% of the canvas width\n            testRowOffset: 0.02 // we test this % of height from detected edge\n        }\n    },\n    zoom: {\n        minLogZoom: -1,\n        maxLogZoom: 3,\n        announceDebounce: 200 // we wait this long before announcing new zoom\n    },\n    miscSettings: {\n        mousePan: {\n            enabled: false\n        },\n        mousePanReverseMouse: false,\n    },\n    stretch: {\n        conditionalDifferencePercent: 0.05 // black bars less than this wide will trigger stretch\n        // if mode is set to '1'. 1.0=100%\n    },\n    resizer: {\n        setStyleString: {\n            maxRetries: 3,\n            retryTimeout: 200\n        }\n    },\n    pageInfo: {\n        timeouts: {\n            urlCheck: 200,\n            rescan: 1500\n        }\n    },\n    // -----------------------------------------\n    //             ::: ACTIONS :::\n    // -----------------------------------------\n    // Nastavitve za ukaze. Zamenja stare nastavitve za blinine tipke.\n    //\n    // Polje 'shortcut' je tabela, e se sluajno lotimo kdaj delati choordov.\n    actions: [{\n            name: 'Trigger automatic detection',\n            label: 'Automatic',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.Automatic,\n                    persistent: false, // optional, false by default. If true, change doesn't take effect immediately.\n                    // Instead, this action saves stuff to settings\n                }],\n            scopes: {\n                global: {\n                    show: false,\n                },\n                site: {\n                    show: false,\n                },\n                page: {\n                    show: true,\n                    label: 'Automatic',\n                    shortcut: [{\n                            key: 'a',\n                            code: 'KeyA',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }],\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop',\n            },\n        }, {\n            name: 'Reset to default',\n            label: 'Reset',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.Reset,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 'r',\n                            code: 'KeyR',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }],\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            },\n        }, {\n            name: 'Fit to width',\n            label: 'Fit width',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.FitWidth,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 'w',\n                            code: 'KeyW',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }],\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        }, {\n            name: 'Fit to height',\n            label: 'Fit height',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.FitHeight\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 'e',\n                            code: 'KeyE',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }]\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        }, {\n            userAdded: true,\n            name: 'Set aspect ratio to 16:9',\n            label: '16:9',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.Fixed,\n                    customArg: 1.78,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 's',\n                            code: 'KeyS',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: false,\n                            onKeyDown: true,\n                        }],\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        }, {\n            userAdded: true,\n            name: 'Set aspect ratio to 21:9 (2.39:1)',\n            label: '21:9',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.Fixed,\n                    customArg: 2.39\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 'd',\n                            code: 'KeyD',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: false,\n                            onKeyDown: true,\n                        }]\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        }, {\n            userAdded: true,\n            name: 'Set aspect ratio to 18:9',\n            label: '18:9',\n            cmd: [{\n                    action: 'set-ar',\n                    arg: AspectRatioType.Fixed,\n                    customArg: 2.0,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                    shortcut: [{\n                            key: 'x',\n                            code: 'KeyX',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }]\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop',\n            }\n        }, {\n            name: 'Don\\'t persist crop',\n            label: 'Never persist',\n            cmd: [{\n                    action: 'set-ar-persistence',\n                    arg: CropModePersistence.Disabled,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                },\n                global: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n            }\n        }, {\n            name: 'Persist crop while on page',\n            label: 'Until page load',\n            cmd: [{\n                    action: 'set-ar-persistence',\n                    arg: CropModePersistence.UntilPageReload,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                },\n                global: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n            }\n        }, {\n            name: 'Persist crop for current session',\n            label: 'Current session',\n            cmd: [{\n                    action: 'set-ar-persistence',\n                    arg: CropModePersistence.CurrentSession,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                },\n                global: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n            }\n        }, {\n            name: 'Persist until manually reset',\n            label: 'Always persist',\n            cmd: [{\n                    action: 'set-ar-persistence',\n                    arg: CropModePersistence.Forever,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                },\n                global: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n            }\n        }, {\n            name: 'Default crop persistence',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-ar-persistence',\n                    arg: CropModePersistence.Default,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                },\n            },\n            playerUi: {\n                show: true,\n            }\n        }, {\n            name: 'Zoom in',\n            label: 'Zoom',\n            cmd: [{\n                    action: 'change-zoom',\n                    arg: 0.1\n                }],\n            scopes: {\n                page: {\n                    show: false,\n                    shortcut: [{\n                            key: 'z',\n                            code: 'KeyY',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }],\n                }\n            },\n            playerUi: {\n                show: false,\n            }\n        }, {\n            name: 'Zoom out',\n            label: 'Unzoom',\n            cmd: [{\n                    action: 'change-zoom',\n                    arg: -0.1\n                }],\n            scopes: {\n                page: {\n                    show: false,\n                    shortcut: [{\n                            key: 'u',\n                            code: 'KeyU',\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: false,\n                            onKeyUp: true,\n                            onKeyDown: false,\n                        }],\n                }\n            },\n            playerUi: {\n                show: false\n            }\n        }, {\n            name: 'Toggle panning mode',\n            label: 'Toggle pan',\n            cmd: [{\n                    action: 'toggle-pan',\n                    arg: 'toggle'\n                }],\n            playerUi: {\n                show: true,\n                path: 'zoom'\n            },\n            scopes: {}\n        }, {\n            name: 'Hold to pan',\n            cmd: [{\n                    action: 'pan',\n                    arg: 'toggle',\n                }],\n            scopes: {\n                page: {\n                    show: false,\n                    shortcut: [{\n                            ctrlKey: false,\n                            metaKey: false,\n                            altKey: false,\n                            shiftKey: true,\n                            onKeyDown: false,\n                            onKeyUp: false,\n                            onMouseMove: true,\n                        }],\n                }\n            }\n        },\n        //\n        //   S T R E T C H I N G\n        //\n        {\n            name: 'Set stretch to \"none\"',\n            label: 'Don\\'t stretch',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.NoStretch,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                    label: 'Normal'\n                },\n                site: {\n                    show: true,\n                    label: 'Normal'\n                },\n                page: {\n                    show: true,\n                    label: 'Normal'\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'stretch'\n            }\n        }, {\n            name: 'Set stretch to \"basic\"',\n            label: 'Basic stretch',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.Basic,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                    label: 'Basic'\n                },\n                site: {\n                    show: true,\n                    label: 'Basic'\n                },\n                page: {\n                    show: true,\n                    label: 'Basic'\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'stretch'\n            }\n        }, {\n            name: 'Set stretch to \"hybrid\"',\n            label: 'Hybrid stretch',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.Hybrid,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                    label: 'Hybrid'\n                },\n                site: {\n                    show: true,\n                    label: 'Hybrid'\n                },\n                page: {\n                    show: true,\n                    label: 'Hybrid'\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'stretch'\n            }\n        }, {\n            name: 'Stretch only to hide thin borders',\n            label: 'Thin borders only',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.Conditional,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                    label: 'Thin borders'\n                },\n                site: {\n                    show: true,\n                    label: 'Thin borders'\n                },\n                page: {\n                    show: true,\n                    label: 'Thin borders'\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'stretch'\n            }\n        }, {\n            name: 'Set stretch to default value',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.Default,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                }\n            }\n        },\n        {\n            name: 'Stretch source to 4:3',\n            label: '4:3 stretch (src)',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.FixedSource,\n                    customArg: 1.33,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        }, {\n            name: 'Stretch source to 16:9',\n            label: '16:9 stretch (src)',\n            cmd: [{\n                    action: 'set-stretch',\n                    arg: StretchType.FixedSource,\n                    customArg: 1.77,\n                }],\n            scopes: {\n                page: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'crop'\n            }\n        },\n        //\n        //    A L I G N M E N T\n        //\n        {\n            name: 'Align video to the left',\n            label: 'Left',\n            cmd: [{\n                    action: 'set-alignment',\n                    arg: VideoAlignmentType.Left,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                },\n                page: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'align'\n            }\n        }, {\n            name: 'Align video to center',\n            label: 'Center',\n            cmd: [{\n                    action: 'set-alignment',\n                    arg: VideoAlignmentType.Center,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                },\n                page: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'align'\n            }\n        }, {\n            name: 'Align video to the right',\n            label: 'Right',\n            cmd: [{\n                    action: 'set-alignment',\n                    arg: VideoAlignmentType.Right\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                },\n                page: {\n                    show: true,\n                }\n            },\n            playerUi: {\n                show: true,\n                path: 'align'\n            }\n        }, {\n            name: 'Use default alignment',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-alignment',\n                    arg: VideoAlignmentType.Default\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                }\n            }\n        },\n        //\n        //    E N A B L E   E X T E N S I O N / A U T O A R\n        //    (for sites/extension tab in the popup)\n        //\n        {\n            name: 'Enable extension',\n            label: 'Enable',\n            cmd: [{\n                    action: 'set-ExtensionMode',\n                    arg: ExtensionMode.Enabled,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                }\n            }\n        }, {\n            name: 'Enable extension on whitelisted sites only',\n            label: 'On whitelist only',\n            cmd: [{\n                    action: 'set-ExtensionMode',\n                    arg: ExtensionMode.Whitelist,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true\n                }\n            }\n        }, {\n            name: 'Extension mode: use default settings',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-ExtensionMode',\n                    arg: ExtensionMode.Default,\n                    persistent: true,\n                }],\n            scopes: {\n                site: {\n                    show: true\n                }\n            }\n        }, {\n            name: 'Disable extension',\n            label: 'Disable',\n            cmd: [{\n                    action: 'set-ExtensionMode',\n                    arg: ExtensionMode.Disabled,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                }\n            }\n        }, {\n            name: 'Enable automatic aspect ratio detection',\n            label: 'Enable',\n            cmd: [{\n                    action: 'set-autoar-mode',\n                    arg: ExtensionMode.Enabled,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true\n                },\n                site: {\n                    show: true\n                }\n            }\n        }, {\n            name: 'Enable automatic aspect ratio detection on whitelisted sites only',\n            label: 'On whitelist only',\n            cmd: [{\n                    action: 'set-autoar-mode',\n                    arg: ExtensionMode.Whitelist,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                }\n            }\n        }, {\n            name: 'Use default settings for automatic aspect ratio detection',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-autoar-mode',\n                    arg: ExtensionMode.Default,\n                    persistent: true,\n                }],\n            scopes: {\n                site: {\n                    show: true,\n                }\n            }\n        }, {\n            name: 'Disable automatic aspect ratio detection',\n            label: 'Disable',\n            cmd: [{\n                    action: 'set-autoar-mode',\n                    arg: ExtensionMode.Disabled,\n                    persistent: true,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                }\n            }\n        },\n        //\n        //\n        // Enable/disable keyboard shortcuts\n        //\n        {\n            name: 'Enable keyboard shortcuts',\n            label: 'Enable',\n            cmd: [{\n                    action: 'set-keyboard',\n                    arg: ExtensionMode.Enabled,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                },\n                page: {\n                    show: true,\n                }\n            }\n        }, {\n            name: 'Enable keyboard shortcuts on whitelisted sites only',\n            label: 'On whitelist only',\n            cmd: [{\n                    action: 'set-keyboard',\n                    arg: ExtensionMode.Whitelist,\n                }],\n            scopes: {\n                global: {\n                    show: true\n                },\n            }\n        }, {\n            name: 'Keyboard shortcuts mode: use default settings',\n            label: 'Default',\n            cmd: [{\n                    action: 'set-keyboard',\n                    arg: ExtensionMode.Default,\n                }],\n            scopes: {\n                site: {\n                    show: true\n                }\n            }\n        }, {\n            name: 'Disable keyboard shortcuts',\n            label: 'Disable',\n            cmd: [{\n                    action: 'set-keyboard',\n                    arg: ExtensionMode.Disabled,\n                }],\n            scopes: {\n                global: {\n                    show: true,\n                },\n                site: {\n                    show: true,\n                },\n                page: {\n                    show: true,\n                }\n            }\n        },\n    ],\n    mitigations: {\n        zoomLimit: {\n            enabled: true,\n            limit: 0.997,\n            fullscreenOnly: true\n        }\n    },\n    whatsNewChecked: true,\n    // -----------------------------------------\n    //       ::: SITE CONFIGURATION :::\n    // -----------------------------------------\n    // Nastavitve za posamezno stran\n    // Config for a given page:\n    //\n    // <hostname> : {\n    //    status: <option>              // should extension work on this site?\n    //    arStatus: <option>            // should we do autodetection on this site?\n    //\n    //    defaultAr?: <ratio>          // automatically apply this aspect ratio on this side. Use extension defaults if undefined.\n    //    stretch? <stretch mode>       // automatically stretch video on this site in this manner\n    //    videoAlignment? <left|center|right>\n    //\n    //    type: <official|community|user>  // 'official'  blessed by Tam.\n    //                                     // 'community'  blessed by reddit.\n    //                                     // 'user'  user-defined (not here)\n    //    override: <true|false>           // override user settings for this site on update\n    // }\n    //\n    // Veljavne vrednosti za monosti\n    // Valid values for options:\n    //\n    //     status, arStatus, statusEmbedded:\n    //\n    //    * enabled      always allow, full\n    //    * basic        allow, but only the basic version without playerData\n    //    * default      allow if default is to allow, block if default is to block\n    //    * disabled     never allow\n    //\n    sites: {\n        \"@global\": {\n            // to avoid writing this multiple times. Tags:\n            //      #g  only available in @global\n            //      #s    only available for specific site\n            mode: ExtensionMode.Enabled,\n            //       'enabled'   - work everywhere except blacklist\n            //       'whitelist' - only work on whitelisted sites (#g)\n            //       'disabled'  - work nowhere\n            //       'basic'     - (Possible future use)\n            //       'default'   - follow global rules (#s)\n            autoar: ExtensionMode.Enabled,\n            //  Options: 'enabled', 'whitelist' (#g), 'default' (#s), 'disabled'\n            autoarFallback: currentBrowser.firefox ? // if autoAr fails, try fallback mode?\n                ExtensionMode.Enabled : // Options same as in autoar.\n                ExtensionMode.Disabled,\n            stretch: StretchType.NoStretch,\n            videoAlignment: VideoAlignmentType.Center,\n            keyboardShortcutsEnabled: ExtensionMode.Enabled,\n        },\n        \"www.youtube.com\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            autoarFallback: ExtensionMode.Enabled,\n            override: false,\n            type: 'official',\n            actions: null,\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            DOM: {\n                player: {\n                    manual: true,\n                    querySelectors: \"#movie_player, #player, #c4-player\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\",\n                }\n            }\n        },\n        \"www.netflix.com\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            override: false,\n            type: 'official',\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            arPersistence: true,\n            \"DOM\": {\n                \"player\": {\n                    \"manual\": true,\n                    \"querySelectors\": \".VideoContainer\",\n                    \"additionalCss\": \"\",\n                    \"useRelativeAncestor\": false,\n                    \"playerNodeCss\": \"\"\n                }\n            }\n        },\n        \"www.disneyplus.com\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            override: false,\n            type: 'community',\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            arPersistence: true,\n            DOM: {\n                \"player\": {\n                    \"manual\": true,\n                    \"querySelectors\": \".btm-media-client-element\",\n                    \"additionalCss\": \"\",\n                    \"useRelativeAncestor\": false,\n                    \"videoAncestor\": 1,\n                    \"playerNodeCss\": \"\"\n                }\n            },\n            css: \".hudson-container { height: 100%; }\",\n        },\n        \"www.twitch.tv\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            override: true,\n            type: 'official',\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            DOM: {\n                player: {\n                    manual: false,\n                    querySelectors: \"\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\"\n                }\n            }\n        },\n        \"streamable.com\": {\n            mode: 3,\n            autoar: 3,\n            type: 'official',\n            stretch: -1,\n            videoAlignment: -1,\n            keyboardShortcutsEnabled: 0,\n            css: \".player {text-align: left}\"\n        },\n        \"vimeo.com\": {\n            mode: 3,\n            autoar: 3,\n            type: 'official',\n            stretch: -1,\n            videoAlignment: -1,\n            keyboardShortcutsEnabled: 0,\n            DOM: {\n                player: {\n                    manual: true,\n                    querySelectors: \".player_outro_area\",\n                    useRelativeAncestor: false,\n                },\n            },\n            css: \".player_outro_area {\\n  width: 100% !important;\\n  display: flex !important;\\n  justify-content: center !important;\\n}\\n\\n.player_container, .player {\\n  width: 100% !important; \\n}\"\n        },\n        \"old.reddit.com\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            override: false,\n            type: 'testing',\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            DOM: {\n                player: {\n                    manual: false,\n                    useRelativeAncestor: false,\n                    querySelectors: '.reddit-video-player-root, .media-preview-content'\n                }\n            },\n            css: 'video {\\n  width: 100% !important;\\n  height: 100% !important;\\n}',\n        },\n        \"www.reddit.com\": {\n            mode: ExtensionMode.Enabled,\n            autoar: ExtensionMode.Enabled,\n            override: false,\n            type: 'testing',\n            stretch: StretchType.Default,\n            videoAlignment: VideoAlignmentType.Default,\n            keyboardShortcutsEnabled: ExtensionMode.Default,\n            DOM: {\n                player: {\n                    manual: false,\n                    useRelativeAncestor: false,\n                    querySelectors: '.reddit-video-player-root, .media-preview-content'\n                }\n            },\n            css: 'video {\\n  width: 100% !important;\\n  height: 100% !important;\\n}',\n        },\n        \"imgur.com\": {\n            mode: -1,\n            autoar: -1,\n            autoarFallback: 0,\n            stretch: -1,\n            videoAlignment: 1,\n            type: 'official',\n        },\n        \"gfycat.com\": {\n            mode: -1,\n            autoar: -1,\n            autoarFallback: 0,\n            stretch: -1,\n            videoAlignment: 1,\n            type: 'official,'\n        },\n        \"giant.gfycat.com\": {\n            mode: -1,\n            autoar: -1,\n            autoarFallback: 0,\n            stretch: -1,\n            videoAlignment: 1,\n            type: 'official',\n        },\n        \"www.wakanim.tv\": {\n            type: 'community',\n            DOM: {\n                player: {\n                    manual: true,\n                    querySelectors: \"#jwplayer-container\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\",\n                }\n            }\n        },\n        \"app.plex.tv\": {\n            mode: 3,\n            autoar: 3,\n            type: \"community\",\n            stretch: -1,\n            videoAlignment: -1,\n            keyboardShortcutsEnabled: 0,\n            DOM: {\n                player: {\n                    manual: false,\n                    querySelectors: \"\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\"\n                }\n            },\n            css: \"body {\\n  background-color: #000;\\n}\\n\\n.application {\\n  background-color: #000;\\n}\"\n        },\n        \"metaivi.com\": {\n            mode: 0,\n            autoar: 0,\n            type: \"community\",\n            stretch: -1,\n            videoAlignment: -1,\n            DOM: {\n                video: {\n                    manual: false,\n                    querySelectors: \"\",\n                    additionalCss: \"position: absolute !important;\"\n                },\n                player: {\n                    manual: false,\n                    querySelectors: \"\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\"\n                }\n            },\n            \"css\": \"\"\n        },\n        \"piped.kavin.rocks\": {\n            mode: 0,\n            autoar: 0,\n            type: 'community',\n            autoarFallback: 0,\n            stretch: 0,\n            videoAlignment: -1,\n            keyboardShortcutsEnabled: 0,\n            DOM: {\n                player: {\n                    manual: false,\n                    querySelectors: \"\",\n                    additionalCss: \"\",\n                    useRelativeAncestor: false,\n                    playerNodeCss: \"\"\n                }\n            },\n            css: \".shaka-video-container {\\n  flex-direction: column !important;\\n}\"\n        },\n    }\n};\nexport default ExtensionConf;\n","var ExtensionMode;\n(function (ExtensionMode) {\n    ExtensionMode[ExtensionMode[\"AutoDisabled\"] = -2] = \"AutoDisabled\";\n    ExtensionMode[ExtensionMode[\"Disabled\"] = -1] = \"Disabled\";\n    ExtensionMode[ExtensionMode[\"Default\"] = 0] = \"Default\";\n    ExtensionMode[ExtensionMode[\"Whitelist\"] = 1] = \"Whitelist\";\n    ExtensionMode[ExtensionMode[\"Basic\"] = 2] = \"Basic\";\n    ExtensionMode[ExtensionMode[\"Enabled\"] = 3] = \"Enabled\";\n})(ExtensionMode || (ExtensionMode = {}));\n;\nexport default ExtensionMode;\n","\"use strict\";var _logger=_interopRequireDefault(require(\"./logger\"));Object.defineProperty(exports,\"__esModule\",{value:!0}),exports[\"default\"]=void 0;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError(\"Cannot call a class as a function\")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,\"value\"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var browsers=Object.freeze({firefox:{name:\"Mozilla Firefox\",namespace:\"browser\",type:\"promise\"},chrome:{name:\"Google Chrome\",namespace:\"chrome\",type:\"callback\"},edge:{name:\"Microsoft Edge\",namespace:\"browser\",type:\"callback\"}}),Browser=function(){function a(){_classCallCheck(this,a),this.browser=null,this.detectBrowser()}return _createClass(a,[{key:\"detectBrowser\",value:function detectBrowser(){return\"undefined\"==typeof chrome?void(this.browser=browsers.edge):\"undefined\"==typeof browser?void(this.browser=browsers.chrome):void(this.browser=browsers.firefox)}},{key:\"isBackgroundScript\",value:function isBackgroundScript(a){var b=this;return new Promise(function(c){try{b.browser==browsers.chrome?chrome.runtime.getBackgroundPage(function(b){return c(a===b)}):b.browser==browsers.firefox?browser.runtime.getBackgroundPage().then(function(b){return c(a===b)}):b.browser==browsers.edge&&browser.runtime.getBackgroundPage(function(b){return c(a===b)})}catch(a){return c(!1)}return!1})}},{key:\"getPersistentStates\",value:function getPersistentStates(){var a=this;return new Promise(function(b,c){try{a.browser==browsers.chrome?chrome.storage.local.get(\"@@vwe-persistence\",function(a){return a[\"@@vwe-persistence\"]?b(a[\"@@vwe-persistence\"]):b(null)}):a.browser==browsers.firefox?browser.storage.local.get(\"@@vwe-persistence\").then(function(a){return a[\"@@vwe-persistence\"]?b(a[\"@@vwe-persistence\"]):b(null)}):a.browser==browsers.edge&&browser.storage.local.get(\"@@vwe-persistence\",function(a){return a[\"@@vwe-persistence\"]?b(a[\"@@vwe-persistence\"]):b(null)})}catch(a){return c(a)}return!1})}},{key:\"savePersistentStates\",value:function savePersistentStates(a){if(this.browser==browsers.chrome)try{chrome.storage.local.set({\"@@vwe-persistence\":a})}catch(a){_logger[\"default\"].error(\"Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?\")}else if(this.browser==browsers.firefox)try{browser.storage.local.set({\"@@vwe-persistence\":a})}catch(a){_logger[\"default\"].error(\"Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?\")}else if(this.browser==browsers.edge)try{browser.storage.local.set({\"@@vwe-persistence\":a})}catch(a){_logger[\"default\"].error(\"Can't write persistent states to local storage. Did you grant storage permission to your WebExtension?\")}}},{key:\"handleConnection\",value:function handleConnection(a){return this.browser==browsers.chrome?chrome.runtime.onConnect.addListener(a):browser.runtime.onConnect.addListener(a)}},{key:\"connectToBackground\",value:function connectToBackground(a){return this.browser==browsers.chrome?chrome.runtime.connect({name:a}):browser.runtime.connect({name:a})}}]),a}(),_default=Browser;exports[\"default\"]=_default;","(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(\"webextension-polyfill\", [\"module\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod);\n    global.browser = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (module) {\n  /* webextension-polyfill - v0.7.0 - Tue Nov 10 2020 20:24:04 */\n\n  /* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n\n  /* vim: set sts=2 sw=2 et tw=80: */\n\n  /* This Source Code Form is subject to the terms of the Mozilla Public\n   * License, v. 2.0. If a copy of the MPL was not distributed with this\n   * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n  \"use strict\";\n\n  if (typeof browser === \"undefined\" || Object.getPrototypeOf(browser) !== Object.prototype) {\n    const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n    const SEND_RESPONSE_DEPRECATION_WARNING = \"Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)\"; // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n    // optimization for Firefox. Since Spidermonkey does not fully parse the\n    // contents of a function until the first time it's called, and since it will\n    // never actually need to be called, this allows the polyfill to be included\n    // in Firefox nearly for free.\n\n    const wrapAPIs = extensionAPIs => {\n      // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n      // at build time by replacing the following \"include\" with the content of the\n      // JSON file.\n      const apiMetadata = {\n        \"alarms\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"clearAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"bookmarks\": {\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getChildren\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getRecent\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getSubTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTree\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"browserAction\": {\n          \"disable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"enable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"getBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"openPopup\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"browsingData\": {\n          \"remove\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"removeCache\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCookies\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeDownloads\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFormData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeHistory\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeLocalStorage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePasswords\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePluginData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"settings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"commands\": {\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"contextMenus\": {\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"cookies\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAllCookieStores\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"devtools\": {\n          \"inspectedWindow\": {\n            \"eval\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 2,\n              \"singleCallbackArg\": false\n            }\n          },\n          \"panels\": {\n            \"create\": {\n              \"minArgs\": 3,\n              \"maxArgs\": 3,\n              \"singleCallbackArg\": true\n            },\n            \"elements\": {\n              \"createSidebarPane\": {\n                \"minArgs\": 1,\n                \"maxArgs\": 1\n              }\n            }\n          }\n        },\n        \"downloads\": {\n          \"cancel\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"download\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"erase\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFileIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"open\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"pause\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFile\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"resume\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"extension\": {\n          \"isAllowedFileSchemeAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"isAllowedIncognitoAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"history\": {\n          \"addUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"deleteRange\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getVisits\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"i18n\": {\n          \"detectLanguage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAcceptLanguages\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"identity\": {\n          \"launchWebAuthFlow\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"idle\": {\n          \"queryState\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"management\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setEnabled\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"uninstallSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"notifications\": {\n          \"clear\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPermissionLevel\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"pageAction\": {\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"hide\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"permissions\": {\n          \"contains\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"request\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"runtime\": {\n          \"getBackgroundPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPlatformInfo\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"openOptionsPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"requestUpdateCheck\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"sendMessage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 3\n          },\n          \"sendNativeMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"setUninstallURL\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"sessions\": {\n          \"getDevices\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getRecentlyClosed\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"restore\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"storage\": {\n          \"local\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          },\n          \"managed\": {\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            }\n          },\n          \"sync\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        },\n        \"tabs\": {\n          \"captureVisibleTab\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"detectLanguage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"discard\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"duplicate\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"executeScript\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getZoom\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getZoomSettings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"goBack\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"goForward\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"highlight\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"insertCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"query\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"reload\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"sendMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 3\n          },\n          \"setZoom\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"setZoomSettings\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"update\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          }\n        },\n        \"topSites\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"webNavigation\": {\n          \"getAllFrames\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFrame\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"webRequest\": {\n          \"handlerBehaviorChanged\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"windows\": {\n          \"create\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getLastFocused\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        }\n      };\n\n      if (Object.keys(apiMetadata).length === 0) {\n        throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n      }\n      /**\n       * A WeakMap subclass which creates and stores a value for any key which does\n       * not exist when accessed, but behaves exactly as an ordinary WeakMap\n       * otherwise.\n       *\n       * @param {function} createItem\n       *        A function which will be called in order to create the value for any\n       *        key which does not exist, the first time it is accessed. The\n       *        function receives, as its only argument, the key being created.\n       */\n\n\n      class DefaultWeakMap extends WeakMap {\n        constructor(createItem, items = undefined) {\n          super(items);\n          this.createItem = createItem;\n        }\n\n        get(key) {\n          if (!this.has(key)) {\n            this.set(key, this.createItem(key));\n          }\n\n          return super.get(key);\n        }\n\n      }\n      /**\n       * Returns true if the given object is an object with a `then` method, and can\n       * therefore be assumed to behave as a Promise.\n       *\n       * @param {*} value The value to test.\n       * @returns {boolean} True if the value is thenable.\n       */\n\n\n      const isThenable = value => {\n        return value && typeof value === \"object\" && typeof value.then === \"function\";\n      };\n      /**\n       * Creates and returns a function which, when called, will resolve or reject\n       * the given promise based on how it is called:\n       *\n       * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n       *   the promise is rejected with that value.\n       * - If the function is called with exactly one argument, the promise is\n       *   resolved to that value.\n       * - Otherwise, the promise is resolved to an array containing all of the\n       *   function's arguments.\n       *\n       * @param {object} promise\n       *        An object containing the resolution and rejection functions of a\n       *        promise.\n       * @param {function} promise.resolve\n       *        The promise's resolution function.\n       * @param {function} promise.rejection\n       *        The promise's rejection function.\n       * @param {object} metadata\n       *        Metadata about the wrapped method which has created the callback.\n       * @param {integer} metadata.maxResolvedArgs\n       *        The maximum number of arguments which may be passed to the\n       *        callback created by the wrapped async function.\n       *\n       * @returns {function}\n       *        The generated callback function.\n       */\n\n\n      const makeCallback = (promise, metadata) => {\n        return (...callbackArgs) => {\n          if (extensionAPIs.runtime.lastError) {\n            promise.reject(extensionAPIs.runtime.lastError);\n          } else if (metadata.singleCallbackArg || callbackArgs.length <= 1 && metadata.singleCallbackArg !== false) {\n            promise.resolve(callbackArgs[0]);\n          } else {\n            promise.resolve(callbackArgs);\n          }\n        };\n      };\n\n      const pluralizeArguments = numArgs => numArgs == 1 ? \"argument\" : \"arguments\";\n      /**\n       * Creates a wrapper function for a method with the given name and metadata.\n       *\n       * @param {string} name\n       *        The name of the method which is being wrapped.\n       * @param {object} metadata\n       *        Metadata about the method being wrapped.\n       * @param {integer} metadata.minArgs\n       *        The minimum number of arguments which must be passed to the\n       *        function. If called with fewer than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {integer} metadata.maxArgs\n       *        The maximum number of arguments which may be passed to the\n       *        function. If called with more than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {integer} metadata.maxResolvedArgs\n       *        The maximum number of arguments which may be passed to the\n       *        callback created by the wrapped async function.\n       *\n       * @returns {function(object, ...*)}\n       *       The generated wrapper function.\n       */\n\n\n      const wrapAsyncFunction = (name, metadata) => {\n        return function asyncFunctionWrapper(target, ...args) {\n          if (args.length < metadata.minArgs) {\n            throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          if (args.length > metadata.maxArgs) {\n            throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          return new Promise((resolve, reject) => {\n            if (metadata.fallbackToNoCallback) {\n              // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n              // and so the polyfill will try to call it with a callback first, and it will fallback\n              // to not passing the callback if the first call fails.\n              try {\n                target[name](...args, makeCallback({\n                  resolve,\n                  reject\n                }, metadata));\n              } catch (cbError) {\n                console.warn(`${name} API method doesn't seem to support the callback parameter, ` + \"falling back to call it without a callback: \", cbError);\n                target[name](...args); // Update the API method metadata, so that the next API calls will not try to\n                // use the unsupported callback anymore.\n\n                metadata.fallbackToNoCallback = false;\n                metadata.noCallback = true;\n                resolve();\n              }\n            } else if (metadata.noCallback) {\n              target[name](...args);\n              resolve();\n            } else {\n              target[name](...args, makeCallback({\n                resolve,\n                reject\n              }, metadata));\n            }\n          });\n        };\n      };\n      /**\n       * Wraps an existing method of the target object, so that calls to it are\n       * intercepted by the given wrapper function. The wrapper function receives,\n       * as its first argument, the original `target` object, followed by each of\n       * the arguments passed to the original method.\n       *\n       * @param {object} target\n       *        The original target object that the wrapped method belongs to.\n       * @param {function} method\n       *        The method being wrapped. This is used as the target of the Proxy\n       *        object which is created to wrap the method.\n       * @param {function} wrapper\n       *        The wrapper function which is called in place of a direct invocation\n       *        of the wrapped method.\n       *\n       * @returns {Proxy<function>}\n       *        A Proxy object for the given method, which invokes the given wrapper\n       *        method in its place.\n       */\n\n\n      const wrapMethod = (target, method, wrapper) => {\n        return new Proxy(method, {\n          apply(targetMethod, thisObj, args) {\n            return wrapper.call(thisObj, target, ...args);\n          }\n\n        });\n      };\n\n      let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n      /**\n       * Wraps an object in a Proxy which intercepts and wraps certain methods\n       * based on the given `wrappers` and `metadata` objects.\n       *\n       * @param {object} target\n       *        The target object to wrap.\n       *\n       * @param {object} [wrappers = {}]\n       *        An object tree containing wrapper functions for special cases. Any\n       *        function present in this object tree is called in place of the\n       *        method in the same location in the `target` object tree. These\n       *        wrapper methods are invoked as described in {@see wrapMethod}.\n       *\n       * @param {object} [metadata = {}]\n       *        An object tree containing metadata used to automatically generate\n       *        Promise-based wrapper functions for asynchronous. Any function in\n       *        the `target` object tree which has a corresponding metadata object\n       *        in the same location in the `metadata` tree is replaced with an\n       *        automatically-generated wrapper function, as described in\n       *        {@see wrapAsyncFunction}\n       *\n       * @returns {Proxy<object>}\n       */\n\n      const wrapObject = (target, wrappers = {}, metadata = {}) => {\n        let cache = Object.create(null);\n        let handlers = {\n          has(proxyTarget, prop) {\n            return prop in target || prop in cache;\n          },\n\n          get(proxyTarget, prop, receiver) {\n            if (prop in cache) {\n              return cache[prop];\n            }\n\n            if (!(prop in target)) {\n              return undefined;\n            }\n\n            let value = target[prop];\n\n            if (typeof value === \"function\") {\n              // This is a method on the underlying object. Check if we need to do\n              // any wrapping.\n              if (typeof wrappers[prop] === \"function\") {\n                // We have a special-case wrapper for this method.\n                value = wrapMethod(target, target[prop], wrappers[prop]);\n              } else if (hasOwnProperty(metadata, prop)) {\n                // This is an async method that we have metadata for. Create a\n                // Promise wrapper for it.\n                let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n                value = wrapMethod(target, target[prop], wrapper);\n              } else {\n                // This is a method that we don't know or care about. Return the\n                // original method, bound to the underlying object.\n                value = value.bind(target);\n              }\n            } else if (typeof value === \"object\" && value !== null && (hasOwnProperty(wrappers, prop) || hasOwnProperty(metadata, prop))) {\n              // This is an object that we need to do some wrapping for the children\n              // of. Create a sub-object wrapper for it with the appropriate child\n              // metadata.\n              value = wrapObject(value, wrappers[prop], metadata[prop]);\n            } else if (hasOwnProperty(metadata, \"*\")) {\n              // Wrap all properties in * namespace.\n              value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n            } else {\n              // We don't need to do any wrapping for this property,\n              // so just forward all access to the underlying object.\n              Object.defineProperty(cache, prop, {\n                configurable: true,\n                enumerable: true,\n\n                get() {\n                  return target[prop];\n                },\n\n                set(value) {\n                  target[prop] = value;\n                }\n\n              });\n              return value;\n            }\n\n            cache[prop] = value;\n            return value;\n          },\n\n          set(proxyTarget, prop, value, receiver) {\n            if (prop in cache) {\n              cache[prop] = value;\n            } else {\n              target[prop] = value;\n            }\n\n            return true;\n          },\n\n          defineProperty(proxyTarget, prop, desc) {\n            return Reflect.defineProperty(cache, prop, desc);\n          },\n\n          deleteProperty(proxyTarget, prop) {\n            return Reflect.deleteProperty(cache, prop);\n          }\n\n        }; // Per contract of the Proxy API, the \"get\" proxy handler must return the\n        // original value of the target if that value is declared read-only and\n        // non-configurable. For this reason, we create an object with the\n        // prototype set to `target` instead of using `target` directly.\n        // Otherwise we cannot return a custom object for APIs that\n        // are declared read-only and non-configurable, such as `chrome.devtools`.\n        //\n        // The proxy handlers themselves will still use the original `target`\n        // instead of the `proxyTarget`, so that the methods and properties are\n        // dereferenced via the original targets.\n\n        let proxyTarget = Object.create(target);\n        return new Proxy(proxyTarget, handlers);\n      };\n      /**\n       * Creates a set of wrapper functions for an event object, which handles\n       * wrapping of listener functions that those messages are passed.\n       *\n       * A single wrapper is created for each listener function, and stored in a\n       * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n       * retrieve the original wrapper, so that  attempts to remove a\n       * previously-added listener work as expected.\n       *\n       * @param {DefaultWeakMap<function, function>} wrapperMap\n       *        A DefaultWeakMap object which will create the appropriate wrapper\n       *        for a given listener function when one does not exist, and retrieve\n       *        an existing one when it does.\n       *\n       * @returns {object}\n       */\n\n\n      const wrapEvent = wrapperMap => ({\n        addListener(target, listener, ...args) {\n          target.addListener(wrapperMap.get(listener), ...args);\n        },\n\n        hasListener(target, listener) {\n          return target.hasListener(wrapperMap.get(listener));\n        },\n\n        removeListener(target, listener) {\n          target.removeListener(wrapperMap.get(listener));\n        }\n\n      }); // Keep track if the deprecation warning has been logged at least once.\n\n\n      let loggedSendResponseDeprecationWarning = false;\n      const onMessageWrappers = new DefaultWeakMap(listener => {\n        if (typeof listener !== \"function\") {\n          return listener;\n        }\n        /**\n         * Wraps a message listener function so that it may send responses based on\n         * its return value, rather than by returning a sentinel value and calling a\n         * callback. If the listener function returns a Promise, the response is\n         * sent when the promise either resolves or rejects.\n         *\n         * @param {*} message\n         *        The message sent by the other end of the channel.\n         * @param {object} sender\n         *        Details about the sender of the message.\n         * @param {function(*)} sendResponse\n         *        A callback which, when called with an arbitrary argument, sends\n         *        that value as a response.\n         * @returns {boolean}\n         *        True if the wrapped listener returned a Promise, which will later\n         *        yield a response. False otherwise.\n         */\n\n\n        return function onMessage(message, sender, sendResponse) {\n          let didCallSendResponse = false;\n          let wrappedSendResponse;\n          let sendResponsePromise = new Promise(resolve => {\n            wrappedSendResponse = function (response) {\n              if (!loggedSendResponseDeprecationWarning) {\n                console.warn(SEND_RESPONSE_DEPRECATION_WARNING, new Error().stack);\n                loggedSendResponseDeprecationWarning = true;\n              }\n\n              didCallSendResponse = true;\n              resolve(response);\n            };\n          });\n          let result;\n\n          try {\n            result = listener(message, sender, wrappedSendResponse);\n          } catch (err) {\n            result = Promise.reject(err);\n          }\n\n          const isResultThenable = result !== true && isThenable(result); // If the listener didn't returned true or a Promise, or called\n          // wrappedSendResponse synchronously, we can exit earlier\n          // because there will be no response sent from this listener.\n\n          if (result !== true && !isResultThenable && !didCallSendResponse) {\n            return false;\n          } // A small helper to send the message if the promise resolves\n          // and an error if the promise rejects (a wrapped sendMessage has\n          // to translate the message into a resolved promise or a rejected\n          // promise).\n\n\n          const sendPromisedResult = promise => {\n            promise.then(msg => {\n              // send the message value.\n              sendResponse(msg);\n            }, error => {\n              // Send a JSON representation of the error if the rejected value\n              // is an instance of error, or the object itself otherwise.\n              let message;\n\n              if (error && (error instanceof Error || typeof error.message === \"string\")) {\n                message = error.message;\n              } else {\n                message = \"An unexpected error occurred\";\n              }\n\n              sendResponse({\n                __mozWebExtensionPolyfillReject__: true,\n                message\n              });\n            }).catch(err => {\n              // Print an error on the console if unable to send the response.\n              console.error(\"Failed to send onMessage rejected reply\", err);\n            });\n          }; // If the listener returned a Promise, send the resolved value as a\n          // result, otherwise wait the promise related to the wrappedSendResponse\n          // callback to resolve and send it as a response.\n\n\n          if (isResultThenable) {\n            sendPromisedResult(result);\n          } else {\n            sendPromisedResult(sendResponsePromise);\n          } // Let Chrome know that the listener is replying.\n\n\n          return true;\n        };\n      });\n\n      const wrappedSendMessageCallback = ({\n        reject,\n        resolve\n      }, reply) => {\n        if (extensionAPIs.runtime.lastError) {\n          // Detect when none of the listeners replied to the sendMessage call and resolve\n          // the promise to undefined as in Firefox.\n          // See https://github.com/mozilla/webextension-polyfill/issues/130\n          if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n            resolve();\n          } else {\n            reject(extensionAPIs.runtime.lastError);\n          }\n        } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n          // Convert back the JSON representation of the error into\n          // an Error instance.\n          reject(new Error(reply.message));\n        } else {\n          resolve(reply);\n        }\n      };\n\n      const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          const wrappedCb = wrappedSendMessageCallback.bind(null, {\n            resolve,\n            reject\n          });\n          args.push(wrappedCb);\n          apiNamespaceObj.sendMessage(...args);\n        });\n      };\n\n      const staticWrappers = {\n        runtime: {\n          onMessage: wrapEvent(onMessageWrappers),\n          onMessageExternal: wrapEvent(onMessageWrappers),\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 1,\n            maxArgs: 3\n          })\n        },\n        tabs: {\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 2,\n            maxArgs: 3\n          })\n        }\n      };\n      const settingMetadata = {\n        clear: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        get: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        set: {\n          minArgs: 1,\n          maxArgs: 1\n        }\n      };\n      apiMetadata.privacy = {\n        network: {\n          \"*\": settingMetadata\n        },\n        services: {\n          \"*\": settingMetadata\n        },\n        websites: {\n          \"*\": settingMetadata\n        }\n      };\n      return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n    };\n\n    if (typeof chrome != \"object\" || !chrome || !chrome.runtime || !chrome.runtime.id) {\n      throw new Error(\"This script should only be loaded in a browser extension.\");\n    } // The build process adds a UMD wrapper around this file, which makes the\n    // `module` variable available.\n\n\n    module.exports = wrapAPIs(chrome);\n  } else {\n    module.exports = browser;\n  }\n});\n//# sourceMappingURL=browser-polyfill.js.map\n","export async function sleep(timeout) {\n    return new Promise((resolve, reject) => setTimeout(() => resolve(), timeout));\n}\n","var StretchType;\n(function (StretchType) {\n    StretchType[StretchType[\"NoStretch\"] = 0] = \"NoStretch\";\n    StretchType[StretchType[\"Basic\"] = 1] = \"Basic\";\n    StretchType[StretchType[\"Hybrid\"] = 2] = \"Hybrid\";\n    StretchType[StretchType[\"Conditional\"] = 3] = \"Conditional\";\n    StretchType[StretchType[\"Fixed\"] = 4] = \"Fixed\";\n    StretchType[StretchType[\"FixedSource\"] = 5] = \"FixedSource\";\n    StretchType[StretchType[\"Default\"] = -1] = \"Default\";\n})(StretchType || (StretchType = {}));\n;\nexport default StretchType;\n","var VideoAlignmentType;\n(function (VideoAlignmentType) {\n    VideoAlignmentType[VideoAlignmentType[\"Left\"] = 0] = \"Left\";\n    VideoAlignmentType[VideoAlignmentType[\"Center\"] = 1] = \"Center\";\n    VideoAlignmentType[VideoAlignmentType[\"Right\"] = 2] = \"Right\";\n    VideoAlignmentType[VideoAlignmentType[\"Default\"] = -1] = \"Default\";\n})(VideoAlignmentType || (VideoAlignmentType = {}));\n;\nexport default VideoAlignmentType;\n","var AspectRatioType;\n(function (AspectRatioType) {\n    AspectRatioType[AspectRatioType[\"Initial\"] = -1] = \"Initial\";\n    AspectRatioType[AspectRatioType[\"Reset\"] = 0] = \"Reset\";\n    AspectRatioType[AspectRatioType[\"Automatic\"] = 1] = \"Automatic\";\n    AspectRatioType[AspectRatioType[\"FitWidth\"] = 2] = \"FitWidth\";\n    AspectRatioType[AspectRatioType[\"FitHeight\"] = 3] = \"FitHeight\";\n    AspectRatioType[AspectRatioType[\"Fixed\"] = 4] = \"Fixed\";\n    AspectRatioType[AspectRatioType[\"Manual\"] = 5] = \"Manual\";\n})(AspectRatioType || (AspectRatioType = {}));\nexport default AspectRatioType;\n","if (process.env.CHANNEL !== 'stable') {\n  console.info('We are not on stable channel. File init will be printed to console.');\n  console.info('Loading Debug.js');\n}\n\n// Set prod to true when releasing\n// const _prod = true; \nconst _prod = false; \n\nvar Debug = {\n  // performanceMetrics: true, // should not be affected by debug.debug in order to allow benchmarking of the impact logging in console has\n  // init: true,\n  // debug: true,\n  // keyboard: true,\n  // resizer: true,\n  // debugArDetect: true,\n  // scaler: true,\n  // debugStorage: true,\n  // comms: true,\n  // showArDetectCanvas: true,\n  // flushStoredSettings: true,\n  // playerDetect: true,\n  // periodic: true,\n  // videoRescan: true,\n  // mousemove: true,\n  // arDetect: {\n    // edgeDetect: true\n  // },\n  // canvas: {\n    // debugDetection: true\n  // },\n  debugCanvas: {\n    // enabled: true,\n    // guardLine: true\n    // enabled: false,\n    // guardLine: false\n  }\n}\n\nif(_prod){\n  __disableAllDebug(Debug);\n}\n\nfunction __disableAllDebug(obj) {\n  for(let key in obj) {\n    if (obj.hasOwnProperty(key) ){\n      if(obj[key] instanceof Object) {\n        __disableAllDebug(obj[key]);\n      }\n      else {\n        obj[key] = false;\n      }\n    }\n  }\n}\n\nif (Debug.debug) {\n  console.info(\"Guess we're debugging ultrawidify then. Debug.js must always load first, and others must follow.\\nLoading: Debug.js\");\n}\n\nif (process.env.CHANNEL !== 'stable') {\n  console.info('Loaded Debug.js');\n}\n\n\nexport default Debug;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n\nexports.browser = require(\"webextension-polyfill\");\n","import browser from \"vuex-webextensions/dist/browser\";\n\nif (process.env.CHANNEL !== 'stable') {\n  console.info('Loaded BrowserDetect');\n}\n\nfunction detectEdgeUA() {\n  return /Edg\\/(\\.?[0-9]*)*$/.test(window.navigator.userAgent);\n}\n\nfunction getBrowserObj() {\n  return process.env.BROWSER === 'firefox' ? browser : chrome;\n}\n\nfunction getURL(url) {\n  return process.env.BROWSER === 'firefox' ? browser.runtime.getURL(url) : chrome.runtime.getURL(url);\n}\n\nconst BrowserDetect = {\n  firefox: process.env.BROWSER === 'firefox',\n  anyChromium: process.env.BROWSER !== 'firefox',\n  chrome: process.env.BROWSER === 'chrome',\n  edge: process.env.BROWSER === 'edge',\n  processEnvBrowser: process.env.BROWSER,\n  processEnvChannel: process.env.CHANNEL,\n  isEdgeUA: detectEdgeUA(),\n  browserObj: getBrowserObj(),\n  getURL: (url) => getURL(url),\n} \n\nif (process.env.CHANNEL !== 'stable') {\n  console.info(\"BrowserDetect loaded:\\n\\nprocess.env.BROWSER:\", process.env.BROWSER, \"\\nExporting BrowserDetect:\", BrowserDetect);\n}\n\nexport default BrowserDetect;","var CropModePersistence;\n(function (CropModePersistence) {\n    CropModePersistence[CropModePersistence[\"Default\"] = -1] = \"Default\";\n    CropModePersistence[CropModePersistence[\"Disabled\"] = 0] = \"Disabled\";\n    CropModePersistence[CropModePersistence[\"UntilPageReload\"] = 1] = \"UntilPageReload\";\n    CropModePersistence[CropModePersistence[\"CurrentSession\"] = 2] = \"CurrentSession\";\n    CropModePersistence[CropModePersistence[\"Forever\"] = 3] = \"Forever\";\n})(CropModePersistence || (CropModePersistence = {}));\nexport default CropModePersistence;\n"],"sourceRoot":""}